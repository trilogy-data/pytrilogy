query_id = 20
parse_time = 21.092239
exec_time = 0.994162
comp_time = 0.277631
gen_length = 12039
generated_sql = """

WITH 
juicy as (
SELECT
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    items.\"I_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.item as items
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
gullible as (
SELECT
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_SOLD_DATE_SK\" as \"cs_sold_date_id\"
FROM
    memory.catalog_sales as catalog_sales
GROUP BY 
    catalog_sales.\"CS_SOLD_DATE_SK\",
    catalog_sales.\"CS_ITEM_SK\"),
wooden as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price_filter_3197596984767774\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN juicy on catalog_sales.\"CS_ITEM_SK\" = juicy.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    juicy.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
tanager as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price\",
    juicy.\"cs_item_category\" as \"cs_item_category\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\",
    juicy.\"cs_item_class\" as \"cs_item_class\",
    juicy.\"cs_item_current_price\" as \"cs_item_current_price\",
    juicy.\"cs_item_desc\" as \"cs_item_desc\",
    juicy.\"cs_item_name\" as \"cs_item_name\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN juicy on catalog_sales.\"CS_ITEM_SK\" = juicy.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    juicy.\"cs_item_category\" in ( 'Sports','Books','Home' )
),
sloppy as (
SELECT
    items.\"I_ITEM_SK\" as \"cs_item_id\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    gullible.\"cs_sold_date_id\" as \"cs_sold_date_id\"
FROM
    gullible
    INNER JOIN memory.item as items on gullible.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
sparkling as (
SELECT
    wooden.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    wooden.\"cs_order_number\" as \"cs_order_number\",
    wooden.\"cs_item_id\" as \"cs_item_id\"
FROM
    wooden
    INNER JOIN memory.item as items on wooden.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
jackal as (
SELECT
    CASE WHEN tanager.\"cs_item_category\" in ( 'Sports','Books','Home' ) and tanager.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and tanager.\"cs_sold_date_date\" <= cast('1999-03-24' as date) THEN tanager.\"cs_extra_sales_price\" ELSE NULL END as \"cs_extra_sales_price_filter_3197596984767774\",
    tanager.\"cs_order_number\" as \"cs_order_number\",
    tanager.\"cs_item_id\" as \"cs_item_id\"
FROM
    tanager),
heron as (
SELECT
    sloppy.\"cs_item_category\" as \"cs_item_category\",
    sloppy.\"cs_item_class\" as \"cs_item_class\",
    sloppy.\"cs_item_current_price\" as \"cs_item_current_price\",
    sloppy.\"cs_item_desc\" as \"cs_item_desc\",
    sloppy.\"cs_item_name\" as \"cs_item_name\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\"
FROM
    memory.date_dim as date
    INNER JOIN sloppy on date.\"D_DATE_SK\" = sloppy.\"cs_sold_date_id\"
WHERE
    sloppy.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
ocelot as (
SELECT
    sum(sparkling.\"cs_extra_sales_price_filter_3197596984767774\") as \"revenue\",
    sparkling.\"cs_item_category\" as \"cs_item_category\",
    sparkling.\"cs_item_class\" as \"cs_item_class\",
    sparkling.\"cs_item_current_price\" as \"cs_item_current_price\",
    sparkling.\"cs_item_desc\" as \"cs_item_desc\",
    sparkling.\"cs_item_name\" as \"cs_item_name\"
FROM
    sparkling
GROUP BY 
    sparkling.\"cs_item_class\",
    sparkling.\"cs_item_desc\",
    sparkling.\"cs_item_name\",
    sparkling.\"cs_item_current_price\",
    sparkling.\"cs_item_category\"),
salamander as (
SELECT
    jackal.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    jackal.\"cs_order_number\" as \"cs_order_number\",
    jackal.\"cs_item_id\" as \"cs_item_id\"
FROM
    jackal
    INNER JOIN memory.item as items on jackal.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
ceaseless as (
SELECT
    sum(salamander.\"cs_extra_sales_price_filter_3197596984767774\") as \"_virtual_364582426434762\",
    salamander.\"cs_item_category\" as \"cs_item_category\",
    salamander.\"cs_item_class\" as \"cs_item_class\",
    salamander.\"cs_item_current_price\" as \"cs_item_current_price\",
    salamander.\"cs_item_desc\" as \"cs_item_desc\",
    salamander.\"cs_item_name\" as \"cs_item_name\",
    sum(salamander.\"cs_extra_sales_price_filter_3197596984767774\") as \"_agg_sum_364582426434762\"
FROM
    salamander
GROUP BY 
    salamander.\"cs_item_class\",
    salamander.\"cs_item_name\",
    salamander.\"cs_item_desc\",
    salamander.\"cs_item_category\",
    salamander.\"cs_item_current_price\"),
civet as (
SELECT
    sum(ceaseless.\"_agg_sum_364582426434762\") over (partition by ceaseless.\"cs_item_class\") as \"_virtual_503034876863510\",
    ceaseless.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    ceaseless.\"cs_item_class\" as \"cs_item_class\"
FROM
    ceaseless),
cloudy as (
SELECT
    heron.\"cs_item_category\" as \"cs_item_category\",
    heron.\"cs_item_class\" as \"cs_item_class\",
    heron.\"cs_item_current_price\" as \"cs_item_current_price\",
    heron.\"cs_item_desc\" as \"cs_item_desc\",
    heron.\"cs_item_name\" as \"cs_item_name\",
    heron.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    ceaseless.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\"
FROM
    ceaseless
    INNER JOIN heron on (ceaseless.\"cs_item_category\" = heron.\"cs_item_category\" or (ceaseless.\"cs_item_category\" is null and heron.\"cs_item_category\" is null)) AND (ceaseless.\"cs_item_class\" = heron.\"cs_item_class\" or (ceaseless.\"cs_item_class\" is null and heron.\"cs_item_class\" is null)) AND (ceaseless.\"cs_item_current_price\" = heron.\"cs_item_current_price\" or (ceaseless.\"cs_item_current_price\" is null and heron.\"cs_item_current_price\" is null)) AND (ceaseless.\"cs_item_desc\" = heron.\"cs_item_desc\" or (ceaseless.\"cs_item_desc\" is null and heron.\"cs_item_desc\" is null)) AND ceaseless.\"cs_item_name\" = heron.\"cs_item_name\"
WHERE
    heron.\"cs_item_category\" in ( 'Sports','Books','Home' ) and heron.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and heron.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
quizzical as (
SELECT
    cloudy.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    cloudy.\"cs_item_class\" as \"cs_item_class\",
    cloudy.\"cs_item_category\" as \"cs_item_category\",
    cloudy.\"cs_item_current_price\" as \"cs_item_current_price\",
    cloudy.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    cloudy.\"cs_item_desc\" as \"cs_item_desc\",
    cloudy.\"cs_item_name\" as \"cs_item_name\",
    civet.\"_virtual_503034876863510\" as \"_virtual_503034876863510\"
FROM
    cloudy
    LEFT OUTER JOIN civet on (cloudy.\"cs_item_class\" = civet.\"cs_item_class\" or (cloudy.\"cs_item_class\" is null and civet.\"cs_item_class\" is null)) AND cloudy.\"_agg_sum_364582426434762\" = civet.\"_agg_sum_364582426434762\"
WHERE
    cloudy.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cloudy.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and cloudy.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
protective as (
SELECT
    quizzical.\"cs_item_category\" as \"cs_item_category\",
    quizzical.\"cs_item_class\" as \"cs_item_class\",
    quizzical.\"cs_item_current_price\" as \"cs_item_current_price\",
    quizzical.\"cs_item_desc\" as \"cs_item_desc\",
    quizzical.\"cs_item_name\" as \"cs_item_name\",
    quizzical.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    ceaseless.\"_virtual_364582426434762\" * 100.0 / quizzical.\"_virtual_503034876863510\" as \"revenue_ratio\"
FROM
    ceaseless
    INNER JOIN quizzical on (ceaseless.\"cs_item_category\" = quizzical.\"cs_item_category\" or (ceaseless.\"cs_item_category\" is null and quizzical.\"cs_item_category\" is null)) AND (ceaseless.\"cs_item_class\" = quizzical.\"cs_item_class\" or (ceaseless.\"cs_item_class\" is null and quizzical.\"cs_item_class\" is null)) AND (ceaseless.\"cs_item_current_price\" = quizzical.\"cs_item_current_price\" or (ceaseless.\"cs_item_current_price\" is null and quizzical.\"cs_item_current_price\" is null)) AND (ceaseless.\"cs_item_desc\" = quizzical.\"cs_item_desc\" or (ceaseless.\"cs_item_desc\" is null and quizzical.\"cs_item_desc\" is null)) AND ceaseless.\"cs_item_name\" = quizzical.\"cs_item_name\"
WHERE
    quizzical.\"cs_item_category\" in ( 'Sports','Books','Home' ) and quizzical.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and quizzical.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
mamba as (
SELECT
    protective.\"cs_item_category\" as \"cs_item_category\",
    protective.\"cs_item_class\" as \"cs_item_class\",
    protective.\"cs_item_current_price\" as \"cs_item_current_price\",
    protective.\"cs_item_desc\" as \"cs_item_desc\",
    protective.\"cs_item_name\" as \"cs_item_name\",
    protective.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    protective.\"revenue_ratio\" as \"revenue_ratio\",
    ocelot.\"revenue\" as \"revenue\"
FROM
    ocelot
    INNER JOIN protective on (ocelot.\"cs_item_category\" = protective.\"cs_item_category\" or (ocelot.\"cs_item_category\" is null and protective.\"cs_item_category\" is null)) AND (ocelot.\"cs_item_class\" = protective.\"cs_item_class\" or (ocelot.\"cs_item_class\" is null and protective.\"cs_item_class\" is null)) AND (ocelot.\"cs_item_current_price\" = protective.\"cs_item_current_price\" or (ocelot.\"cs_item_current_price\" is null and protective.\"cs_item_current_price\" is null)) AND (ocelot.\"cs_item_desc\" = protective.\"cs_item_desc\" or (ocelot.\"cs_item_desc\" is null and protective.\"cs_item_desc\" is null)) AND ocelot.\"cs_item_name\" = protective.\"cs_item_name\"
WHERE
    protective.\"cs_item_category\" in ( 'Sports','Books','Home' ) and protective.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and protective.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
)
SELECT
    mamba.\"cs_item_name\" as \"cs_item_name\",
    mamba.\"cs_item_desc\" as \"cs_item_desc\",
    mamba.\"cs_item_category\" as \"cs_item_category\",
    mamba.\"cs_item_class\" as \"cs_item_class\",
    mamba.\"cs_item_current_price\" as \"cs_item_current_price\",
    mamba.\"revenue\" as \"revenue\",
    mamba.\"revenue_ratio\" as \"revenue_ratio\"
FROM
    mamba
WHERE
    mamba.\"cs_item_category\" in ( 'Sports','Books','Home' ) and mamba.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and mamba.\"cs_sold_date_date\" <= cast('1999-03-24' as date)

GROUP BY 
    mamba.\"cs_item_name\",
    mamba.\"cs_item_desc\",
    mamba.\"revenue\",
    mamba.\"cs_item_category\",
    mamba.\"revenue_ratio\",
    mamba.\"cs_item_current_price\",
    mamba.\"cs_item_class\"
ORDER BY 
    mamba.\"cs_item_category\" asc nulls first,
    mamba.\"cs_item_class\" asc nulls first,
    mamba.\"cs_item_name\" asc nulls first,
    mamba.\"cs_item_desc\" asc nulls first,
    mamba.\"revenue_ratio\" asc nulls first
LIMIT (100)"""
