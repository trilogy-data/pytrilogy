query_id = 20
parse_time = 48.764779
exec_time = 4.904819
comp_time = 0.886484
gen_length = 11664
generated_sql = """

WITH 
osprey as (
SELECT
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    items.\"I_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.item as items
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
chicken as (
SELECT
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_SOLD_DATE_SK\" as \"cs_sold_date_id\"
FROM
    memory.catalog_sales as catalog_sales
GROUP BY 
    catalog_sales.\"CS_SOLD_DATE_SK\",
    catalog_sales.\"CS_ITEM_SK\"),
juicy as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price_filter_3197596984767774\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN osprey on catalog_sales.\"CS_ITEM_SK\" = osprey.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    osprey.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
jackdaw as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price\",
    osprey.\"cs_item_category\" as \"cs_item_category\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\",
    osprey.\"cs_item_class\" as \"cs_item_class\",
    osprey.\"cs_item_current_price\" as \"cs_item_current_price\",
    osprey.\"cs_item_desc\" as \"cs_item_desc\",
    osprey.\"cs_item_name\" as \"cs_item_name\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN osprey on catalog_sales.\"CS_ITEM_SK\" = osprey.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    osprey.\"cs_item_category\" in ( 'Sports','Books','Home' )
),
premium as (
SELECT
    items.\"I_ITEM_SK\" as \"cs_item_id\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    chicken.\"cs_sold_date_id\" as \"cs_sold_date_id\"
FROM
    chicken
    INNER JOIN memory.item as items on chicken.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
ugly as (
SELECT
    juicy.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    juicy.\"cs_order_number\" as \"cs_order_number\",
    juicy.\"cs_item_id\" as \"cs_item_id\"
FROM
    juicy
    INNER JOIN memory.item as items on juicy.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
loon as (
SELECT
    CASE WHEN jackdaw.\"cs_item_category\" in ( 'Sports','Books','Home' ) and jackdaw.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and jackdaw.\"cs_sold_date_date\" <= cast('1999-03-24' as date) THEN jackdaw.\"cs_extra_sales_price\" ELSE NULL END as \"cs_extra_sales_price_filter_3197596984767774\",
    jackdaw.\"cs_order_number\" as \"cs_order_number\",
    jackdaw.\"cs_item_id\" as \"cs_item_id\"
FROM
    jackdaw),
civet as (
SELECT
    premium.\"cs_item_category\" as \"cs_item_category\",
    premium.\"cs_item_class\" as \"cs_item_class\",
    premium.\"cs_item_current_price\" as \"cs_item_current_price\",
    premium.\"cs_item_desc\" as \"cs_item_desc\",
    premium.\"cs_item_name\" as \"cs_item_name\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\"
FROM
    memory.date_dim as date
    INNER JOIN premium on date.\"D_DATE_SK\" = premium.\"cs_sold_date_id\"
WHERE
    premium.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
martin as (
SELECT
    sum(ugly.\"cs_extra_sales_price_filter_3197596984767774\") as \"revenue\",
    ugly.\"cs_item_category\" as \"cs_item_category\",
    ugly.\"cs_item_class\" as \"cs_item_class\",
    ugly.\"cs_item_current_price\" as \"cs_item_current_price\",
    ugly.\"cs_item_desc\" as \"cs_item_desc\",
    ugly.\"cs_item_name\" as \"cs_item_name\"
FROM
    ugly
GROUP BY 
    ugly.\"cs_item_class\",
    ugly.\"cs_item_category\",
    ugly.\"cs_item_current_price\",
    ugly.\"cs_item_name\",
    ugly.\"cs_item_desc\"),
tanager as (
SELECT
    loon.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    loon.\"cs_order_number\" as \"cs_order_number\",
    loon.\"cs_item_id\" as \"cs_item_id\"
FROM
    loon
    INNER JOIN memory.item as items on loon.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
odd as (
SELECT
    sum(tanager.\"cs_extra_sales_price_filter_3197596984767774\") as \"_virtual_364582426434762\",
    tanager.\"cs_item_category\" as \"cs_item_category\",
    tanager.\"cs_item_class\" as \"cs_item_class\",
    tanager.\"cs_item_current_price\" as \"cs_item_current_price\",
    tanager.\"cs_item_desc\" as \"cs_item_desc\",
    tanager.\"cs_item_name\" as \"cs_item_name\",
    sum(tanager.\"cs_extra_sales_price_filter_3197596984767774\") as \"_agg_sum_364582426434762\"
FROM
    tanager
GROUP BY 
    tanager.\"cs_item_name\",
    tanager.\"cs_item_class\",
    tanager.\"cs_item_desc\",
    tanager.\"cs_item_current_price\",
    tanager.\"cs_item_category\"),
wooden as (
SELECT
    sum(odd.\"_agg_sum_364582426434762\") over (partition by odd.\"cs_item_class\") as \"_virtual_503034876863510\",
    odd.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    odd.\"cs_item_class\" as \"cs_item_class\"
FROM
    odd),
cheetah as (
SELECT
    civet.\"cs_item_category\" as \"cs_item_category\",
    civet.\"cs_item_class\" as \"cs_item_class\",
    civet.\"cs_item_current_price\" as \"cs_item_current_price\",
    civet.\"cs_item_desc\" as \"cs_item_desc\",
    civet.\"cs_item_name\" as \"cs_item_name\",
    civet.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    odd.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\"
FROM
    odd
    INNER JOIN civet on (odd.\"cs_item_category\" = civet.\"cs_item_category\" or (odd.\"cs_item_category\" is null and civet.\"cs_item_category\" is null)) AND (odd.\"cs_item_class\" = civet.\"cs_item_class\" or (odd.\"cs_item_class\" is null and civet.\"cs_item_class\" is null)) AND (odd.\"cs_item_current_price\" = civet.\"cs_item_current_price\" or (odd.\"cs_item_current_price\" is null and civet.\"cs_item_current_price\" is null)) AND (odd.\"cs_item_desc\" = civet.\"cs_item_desc\" or (odd.\"cs_item_desc\" is null and civet.\"cs_item_desc\" is null)) AND odd.\"cs_item_name\" = civet.\"cs_item_name\"
WHERE
    civet.\"cs_item_category\" in ( 'Sports','Books','Home' ) and civet.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and civet.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
shark as (
SELECT
    cheetah.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    cheetah.\"cs_item_class\" as \"cs_item_class\",
    cheetah.\"cs_item_category\" as \"cs_item_category\",
    cheetah.\"cs_item_current_price\" as \"cs_item_current_price\",
    cheetah.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    cheetah.\"cs_item_desc\" as \"cs_item_desc\",
    cheetah.\"cs_item_name\" as \"cs_item_name\",
    wooden.\"_virtual_503034876863510\" as \"_virtual_503034876863510\"
FROM
    cheetah
    LEFT OUTER JOIN wooden on (cheetah.\"cs_item_class\" = wooden.\"cs_item_class\" or (cheetah.\"cs_item_class\" is null and wooden.\"cs_item_class\" is null)) AND cheetah.\"_agg_sum_364582426434762\" = wooden.\"_agg_sum_364582426434762\"
WHERE
    cheetah.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cheetah.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and cheetah.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
uneven as (
SELECT
    shark.\"cs_item_category\" as \"cs_item_category\",
    shark.\"cs_item_class\" as \"cs_item_class\",
    shark.\"cs_item_current_price\" as \"cs_item_current_price\",
    shark.\"cs_item_desc\" as \"cs_item_desc\",
    shark.\"cs_item_name\" as \"cs_item_name\",
    shark.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    odd.\"_virtual_364582426434762\" * 100.0 / shark.\"_virtual_503034876863510\" as \"revenue_ratio\"
FROM
    odd
    INNER JOIN shark on (odd.\"cs_item_category\" = shark.\"cs_item_category\" or (odd.\"cs_item_category\" is null and shark.\"cs_item_category\" is null)) AND (odd.\"cs_item_class\" = shark.\"cs_item_class\" or (odd.\"cs_item_class\" is null and shark.\"cs_item_class\" is null)) AND (odd.\"cs_item_current_price\" = shark.\"cs_item_current_price\" or (odd.\"cs_item_current_price\" is null and shark.\"cs_item_current_price\" is null)) AND (odd.\"cs_item_desc\" = shark.\"cs_item_desc\" or (odd.\"cs_item_desc\" is null and shark.\"cs_item_desc\" is null)) AND odd.\"cs_item_name\" = shark.\"cs_item_name\"
WHERE
    shark.\"cs_item_category\" in ( 'Sports','Books','Home' ) and shark.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and shark.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
scrawny as (
SELECT
    uneven.\"cs_item_category\" as \"cs_item_category\",
    uneven.\"cs_item_class\" as \"cs_item_class\",
    uneven.\"cs_item_current_price\" as \"cs_item_current_price\",
    uneven.\"cs_item_desc\" as \"cs_item_desc\",
    uneven.\"cs_item_name\" as \"cs_item_name\",
    uneven.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    uneven.\"revenue_ratio\" as \"revenue_ratio\",
    martin.\"revenue\" as \"revenue\"
FROM
    martin
    INNER JOIN uneven on (martin.\"cs_item_category\" = uneven.\"cs_item_category\" or (martin.\"cs_item_category\" is null and uneven.\"cs_item_category\" is null)) AND (martin.\"cs_item_class\" = uneven.\"cs_item_class\" or (martin.\"cs_item_class\" is null and uneven.\"cs_item_class\" is null)) AND (martin.\"cs_item_current_price\" = uneven.\"cs_item_current_price\" or (martin.\"cs_item_current_price\" is null and uneven.\"cs_item_current_price\" is null)) AND (martin.\"cs_item_desc\" = uneven.\"cs_item_desc\" or (martin.\"cs_item_desc\" is null and uneven.\"cs_item_desc\" is null)) AND martin.\"cs_item_name\" = uneven.\"cs_item_name\"
WHERE
    uneven.\"cs_item_category\" in ( 'Sports','Books','Home' ) and uneven.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and uneven.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
)
SELECT
    scrawny.\"cs_item_name\" as \"cs_item_name\",
    scrawny.\"cs_item_desc\" as \"cs_item_desc\",
    scrawny.\"cs_item_category\" as \"cs_item_category\",
    scrawny.\"cs_item_class\" as \"cs_item_class\",
    scrawny.\"cs_item_current_price\" as \"cs_item_current_price\",
    scrawny.\"revenue\" as \"revenue\",
    scrawny.\"revenue_ratio\" as \"revenue_ratio\"
FROM
    scrawny
WHERE
    scrawny.\"cs_item_category\" in ( 'Sports','Books','Home' ) and scrawny.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and scrawny.\"cs_sold_date_date\" <= cast('1999-03-24' as date)

GROUP BY 
    scrawny.\"cs_item_name\",
    scrawny.\"cs_item_category\",
    scrawny.\"revenue\",
    scrawny.\"revenue_ratio\",
    scrawny.\"cs_item_desc\",
    scrawny.\"cs_item_class\",
    scrawny.\"cs_item_current_price\"
ORDER BY 
    scrawny.\"cs_item_category\" asc nulls first,
    scrawny.\"cs_item_class\" asc nulls first,
    scrawny.\"cs_item_name\" asc nulls first,
    scrawny.\"cs_item_desc\" asc nulls first,
    scrawny.\"revenue_ratio\" asc nulls first
LIMIT (100)"""
