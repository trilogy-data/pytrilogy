query_id = 20
parse_time = 1.922649
exec_time = 0.93673
comp_time = 0.150535
gen_length = 11830
generated_sql = """

WITH 
tearful as (
SELECT
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    items.\"I_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.item as items
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
colossal as (
SELECT
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_SOLD_DATE_SK\" as \"cs_sold_date_id\"
FROM
    memory.catalog_sales as catalog_sales
GROUP BY 
    catalog_sales.\"CS_ITEM_SK\",
    catalog_sales.\"CS_SOLD_DATE_SK\"),
dapper as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price_filter_3197596984767774\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\"
FROM
    memory.catalog_sales as catalog_sales
    LEFT OUTER JOIN tearful on catalog_sales.\"CS_ITEM_SK\" = tearful.\"cs_item_id\"
    LEFT OUTER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    tearful.\"cs_item_category\" in ( 'Sports','Books','Home' ) and date.\"D_DATE\" >= cast('1999-02-22' as date) and date.\"D_DATE\" <= cast('1999-03-24' as date)
),
cougar as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price\",
    tearful.\"cs_item_category\" as \"cs_item_category\",
    date.\"D_DATE\" as \"cs_sold_date_date\",
    tearful.\"cs_item_class\" as \"cs_item_class\",
    tearful.\"cs_item_current_price\" as \"cs_item_current_price\",
    tearful.\"cs_item_desc\" as \"cs_item_desc\",
    tearful.\"cs_item_name\" as \"cs_item_name\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.catalog_sales as catalog_sales
    LEFT OUTER JOIN tearful on catalog_sales.\"CS_ITEM_SK\" = tearful.\"cs_item_id\"
    LEFT OUTER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    tearful.\"cs_item_category\" in ( 'Sports','Books','Home' )
),
round as (
SELECT
    items.\"I_ITEM_SK\" as \"cs_item_id\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    colossal.\"cs_sold_date_id\" as \"cs_sold_date_id\"
FROM
    colossal
    LEFT OUTER JOIN memory.item as items on colossal.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
wooden as (
SELECT
    dapper.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    dapper.\"cs_order_number\" as \"cs_order_number\",
    dapper.\"cs_item_id\" as \"cs_item_id\"
FROM
    dapper
    LEFT OUTER JOIN memory.item as items on dapper.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
grouse as (
SELECT
    CASE WHEN cougar.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cougar.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and cougar.\"cs_sold_date_date\" <= cast('1999-03-24' as date) THEN cougar.\"cs_extra_sales_price\" ELSE NULL END as \"cs_extra_sales_price_filter_3197596984767774\",
    cougar.\"cs_order_number\" as \"cs_order_number\",
    cougar.\"cs_item_id\" as \"cs_item_id\"
FROM
    cougar),
yellow as (
SELECT
    round.\"cs_item_category\" as \"cs_item_category\",
    round.\"cs_item_class\" as \"cs_item_class\",
    round.\"cs_item_current_price\" as \"cs_item_current_price\",
    round.\"cs_item_desc\" as \"cs_item_desc\",
    round.\"cs_item_name\" as \"cs_item_name\",
    date.\"D_DATE\" as \"cs_sold_date_date\"
FROM
    memory.date_dim as date
    LEFT OUTER JOIN round on date.\"D_DATE_SK\" = round.\"cs_sold_date_id\"
WHERE
    round.\"cs_item_category\" in ( 'Sports','Books','Home' ) and date.\"D_DATE\" >= cast('1999-02-22' as date) and date.\"D_DATE\" <= cast('1999-03-24' as date)
),
cool as (
SELECT
    sum(wooden.\"cs_extra_sales_price_filter_3197596984767774\") as \"revenue\",
    wooden.\"cs_item_category\" as \"cs_item_category\",
    wooden.\"cs_item_class\" as \"cs_item_class\",
    wooden.\"cs_item_current_price\" as \"cs_item_current_price\",
    wooden.\"cs_item_desc\" as \"cs_item_desc\",
    wooden.\"cs_item_name\" as \"cs_item_name\"
FROM
    wooden
GROUP BY 
    wooden.\"cs_item_desc\",
    wooden.\"cs_item_category\",
    wooden.\"cs_item_current_price\",
    wooden.\"cs_item_class\",
    wooden.\"cs_item_name\"),
shark as (
SELECT
    grouse.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    grouse.\"cs_order_number\" as \"cs_order_number\",
    grouse.\"cs_item_id\" as \"cs_item_id\"
FROM
    grouse
    LEFT OUTER JOIN memory.item as items on grouse.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
penguin as (
SELECT
    sum(shark.\"cs_extra_sales_price_filter_3197596984767774\") as \"_virtual_364582426434762\",
    shark.\"cs_item_category\" as \"cs_item_category\",
    shark.\"cs_item_class\" as \"cs_item_class\",
    shark.\"cs_item_current_price\" as \"cs_item_current_price\",
    shark.\"cs_item_desc\" as \"cs_item_desc\",
    shark.\"cs_item_name\" as \"cs_item_name\",
    sum(shark.\"cs_extra_sales_price_filter_3197596984767774\") as \"_agg_sum_364582426434762\"
FROM
    shark
GROUP BY 
    shark.\"cs_item_current_price\",
    shark.\"cs_item_name\",
    shark.\"cs_item_class\",
    shark.\"cs_item_category\",
    shark.\"cs_item_desc\"),
albatross as (
SELECT
    sum(penguin.\"_agg_sum_364582426434762\") over (partition by penguin.\"cs_item_class\") as \"_virtual_6172232945537998\",
    penguin.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    penguin.\"cs_item_class\" as \"cs_item_class\"
FROM
    penguin),
vacuous as (
SELECT
    yellow.\"cs_item_category\" as \"cs_item_category\",
    yellow.\"cs_item_class\" as \"cs_item_class\",
    yellow.\"cs_item_current_price\" as \"cs_item_current_price\",
    yellow.\"cs_item_desc\" as \"cs_item_desc\",
    yellow.\"cs_item_name\" as \"cs_item_name\",
    yellow.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    penguin.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\"
FROM
    yellow
    LEFT OUTER JOIN penguin on ((yellow.\"cs_item_category\" is null and penguin.\"cs_item_category\" is null) or (yellow.\"cs_item_category\" = penguin.\"cs_item_category\")) AND ((yellow.\"cs_item_class\" is null and penguin.\"cs_item_class\" is null) or (yellow.\"cs_item_class\" = penguin.\"cs_item_class\")) AND ((yellow.\"cs_item_current_price\" is null and penguin.\"cs_item_current_price\" is null) or (yellow.\"cs_item_current_price\" = penguin.\"cs_item_current_price\")) AND ((yellow.\"cs_item_desc\" is null and penguin.\"cs_item_desc\" is null) or (yellow.\"cs_item_desc\" = penguin.\"cs_item_desc\")) AND yellow.\"cs_item_name\" = penguin.\"cs_item_name\"
WHERE
    yellow.\"cs_item_category\" in ( 'Sports','Books','Home' ) and yellow.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and yellow.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
wolf as (
SELECT
    vacuous.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    vacuous.\"cs_item_class\" as \"cs_item_class\",
    vacuous.\"cs_item_category\" as \"cs_item_category\",
    vacuous.\"cs_item_current_price\" as \"cs_item_current_price\",
    vacuous.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    vacuous.\"cs_item_desc\" as \"cs_item_desc\",
    vacuous.\"cs_item_name\" as \"cs_item_name\",
    albatross.\"_virtual_6172232945537998\" as \"_virtual_6172232945537998\"
FROM
    vacuous
    LEFT OUTER JOIN albatross on vacuous.\"_agg_sum_364582426434762\" = albatross.\"_agg_sum_364582426434762\" AND ((vacuous.\"cs_item_class\" is null and albatross.\"cs_item_class\" is null) or (vacuous.\"cs_item_class\" = albatross.\"cs_item_class\"))
WHERE
    vacuous.\"cs_item_category\" in ( 'Sports','Books','Home' ) and vacuous.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and vacuous.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
flashy as (
SELECT
    wolf.\"cs_item_category\" as \"cs_item_category\",
    wolf.\"cs_item_class\" as \"cs_item_class\",
    wolf.\"cs_item_current_price\" as \"cs_item_current_price\",
    wolf.\"cs_item_desc\" as \"cs_item_desc\",
    wolf.\"cs_item_name\" as \"cs_item_name\",
    wolf.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    penguin.\"_virtual_364582426434762\" * 100.0 / wolf.\"_virtual_6172232945537998\" as \"revenue_ratio\"
FROM
    wolf
    LEFT OUTER JOIN penguin on ((wolf.\"cs_item_category\" is null and penguin.\"cs_item_category\" is null) or (wolf.\"cs_item_category\" = penguin.\"cs_item_category\")) AND ((wolf.\"cs_item_class\" is null and penguin.\"cs_item_class\" is null) or (wolf.\"cs_item_class\" = penguin.\"cs_item_class\")) AND ((wolf.\"cs_item_current_price\" is null and penguin.\"cs_item_current_price\" is null) or (wolf.\"cs_item_current_price\" = penguin.\"cs_item_current_price\")) AND ((wolf.\"cs_item_desc\" is null and penguin.\"cs_item_desc\" is null) or (wolf.\"cs_item_desc\" = penguin.\"cs_item_desc\")) AND wolf.\"cs_item_name\" = penguin.\"cs_item_name\"
WHERE
    wolf.\"cs_item_category\" in ( 'Sports','Books','Home' ) and wolf.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and wolf.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
fabulous as (
SELECT
    flashy.\"cs_item_category\" as \"cs_item_category\",
    flashy.\"cs_item_class\" as \"cs_item_class\",
    flashy.\"cs_item_current_price\" as \"cs_item_current_price\",
    flashy.\"cs_item_desc\" as \"cs_item_desc\",
    flashy.\"cs_item_name\" as \"cs_item_name\",
    flashy.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    flashy.\"revenue_ratio\" as \"revenue_ratio\",
    cool.\"revenue\" as \"revenue\"
FROM
    flashy
    LEFT OUTER JOIN cool on ((flashy.\"cs_item_category\" is null and cool.\"cs_item_category\" is null) or (flashy.\"cs_item_category\" = cool.\"cs_item_category\")) AND ((flashy.\"cs_item_class\" is null and cool.\"cs_item_class\" is null) or (flashy.\"cs_item_class\" = cool.\"cs_item_class\")) AND ((flashy.\"cs_item_current_price\" is null and cool.\"cs_item_current_price\" is null) or (flashy.\"cs_item_current_price\" = cool.\"cs_item_current_price\")) AND ((flashy.\"cs_item_desc\" is null and cool.\"cs_item_desc\" is null) or (flashy.\"cs_item_desc\" = cool.\"cs_item_desc\")) AND flashy.\"cs_item_name\" = cool.\"cs_item_name\"
WHERE
    flashy.\"cs_item_category\" in ( 'Sports','Books','Home' ) and flashy.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and flashy.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
)
SELECT
    fabulous.\"cs_item_name\" as \"cs_item_name\",
    fabulous.\"cs_item_desc\" as \"cs_item_desc\",
    fabulous.\"cs_item_category\" as \"cs_item_category\",
    fabulous.\"cs_item_class\" as \"cs_item_class\",
    fabulous.\"cs_item_current_price\" as \"cs_item_current_price\",
    fabulous.\"revenue\" as \"revenue\",
    fabulous.\"revenue_ratio\" as \"revenue_ratio\"
FROM
    fabulous
WHERE
    fabulous.\"cs_item_category\" in ( 'Sports','Books','Home' ) and fabulous.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and fabulous.\"cs_sold_date_date\" <= cast('1999-03-24' as date)

GROUP BY 
    fabulous.\"cs_item_desc\",
    fabulous.\"cs_item_class\",
    fabulous.\"cs_item_name\",
    fabulous.\"revenue\",
    fabulous.\"cs_item_current_price\",
    fabulous.\"revenue_ratio\",
    fabulous.\"cs_item_category\"
ORDER BY 
    fabulous.\"cs_item_category\" asc nulls first,
    fabulous.\"cs_item_class\" asc nulls first,
    fabulous.\"cs_item_name\" asc nulls first,
    fabulous.\"cs_item_desc\" asc nulls first,
    fabulous.\"revenue_ratio\" asc nulls first
LIMIT (100)"""
