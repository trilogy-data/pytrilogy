query_id = 20
parse_time = 9.478823
exec_time = 0.694361
comp_time = 0.179575
gen_length = 11717
generated_sql = """

WITH 
shark as (
SELECT
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    items.\"I_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.item as items
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
ruthless as (
SELECT
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_SOLD_DATE_SK\" as \"cs_sold_date_id\"
FROM
    memory.catalog_sales as catalog_sales
GROUP BY 
    catalog_sales.\"CS_ITEM_SK\",
    catalog_sales.\"CS_SOLD_DATE_SK\"),
boa as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price_filter_3197596984767774\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN shark on catalog_sales.\"CS_ITEM_SK\" = shark.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    shark.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
monitor as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price\",
    shark.\"cs_item_category\" as \"cs_item_category\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\",
    shark.\"cs_item_class\" as \"cs_item_class\",
    shark.\"cs_item_current_price\" as \"cs_item_current_price\",
    shark.\"cs_item_desc\" as \"cs_item_desc\",
    shark.\"cs_item_name\" as \"cs_item_name\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN shark on catalog_sales.\"CS_ITEM_SK\" = shark.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    shark.\"cs_item_category\" in ( 'Sports','Books','Home' )
),
human as (
SELECT
    items.\"I_ITEM_SK\" as \"cs_item_id\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    ruthless.\"cs_sold_date_id\" as \"cs_sold_date_id\"
FROM
    ruthless
    INNER JOIN memory.item as items on ruthless.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
duck as (
SELECT
    boa.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    boa.\"cs_order_number\" as \"cs_order_number\",
    boa.\"cs_item_id\" as \"cs_item_id\"
FROM
    boa
    INNER JOIN memory.item as items on boa.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
owl as (
SELECT
    CASE WHEN monitor.\"cs_item_category\" in ( 'Sports','Books','Home' ) and monitor.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and monitor.\"cs_sold_date_date\" <= cast('1999-03-24' as date) THEN monitor.\"cs_extra_sales_price\" ELSE NULL END as \"cs_extra_sales_price_filter_3197596984767774\",
    monitor.\"cs_order_number\" as \"cs_order_number\",
    monitor.\"cs_item_id\" as \"cs_item_id\"
FROM
    monitor),
spiritual as (
SELECT
    human.\"cs_item_category\" as \"cs_item_category\",
    human.\"cs_item_class\" as \"cs_item_class\",
    human.\"cs_item_current_price\" as \"cs_item_current_price\",
    human.\"cs_item_desc\" as \"cs_item_desc\",
    human.\"cs_item_name\" as \"cs_item_name\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\"
FROM
    memory.date_dim as date
    INNER JOIN human on date.\"D_DATE_SK\" = human.\"cs_sold_date_id\"
WHERE
    human.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
crocodile as (
SELECT
    sum(duck.\"cs_extra_sales_price_filter_3197596984767774\") as \"revenue\",
    duck.\"cs_item_category\" as \"cs_item_category\",
    duck.\"cs_item_class\" as \"cs_item_class\",
    duck.\"cs_item_current_price\" as \"cs_item_current_price\",
    duck.\"cs_item_desc\" as \"cs_item_desc\",
    duck.\"cs_item_name\" as \"cs_item_name\"
FROM
    duck
GROUP BY 
    duck.\"cs_item_name\",
    duck.\"cs_item_class\",
    duck.\"cs_item_category\",
    duck.\"cs_item_current_price\",
    duck.\"cs_item_desc\"),
odd as (
SELECT
    owl.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    owl.\"cs_order_number\" as \"cs_order_number\",
    owl.\"cs_item_id\" as \"cs_item_id\"
FROM
    owl
    INNER JOIN memory.item as items on owl.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
fowl as (
SELECT
    sum(odd.\"cs_extra_sales_price_filter_3197596984767774\") as \"_virtual_364582426434762\",
    odd.\"cs_item_category\" as \"cs_item_category\",
    odd.\"cs_item_class\" as \"cs_item_class\",
    odd.\"cs_item_current_price\" as \"cs_item_current_price\",
    odd.\"cs_item_desc\" as \"cs_item_desc\",
    odd.\"cs_item_name\" as \"cs_item_name\",
    sum(odd.\"cs_extra_sales_price_filter_3197596984767774\") as \"_agg_sum_364582426434762\"
FROM
    odd
GROUP BY 
    odd.\"cs_item_category\",
    odd.\"cs_item_desc\",
    odd.\"cs_item_class\",
    odd.\"cs_item_name\",
    odd.\"cs_item_current_price\"),
shrike as (
SELECT
    sum(fowl.\"_agg_sum_364582426434762\") over (partition by fowl.\"cs_item_class\") as \"_virtual_503034876863510\",
    fowl.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    fowl.\"cs_item_class\" as \"cs_item_class\"
FROM
    fowl),
ostrich as (
SELECT
    spiritual.\"cs_item_category\" as \"cs_item_category\",
    spiritual.\"cs_item_class\" as \"cs_item_class\",
    spiritual.\"cs_item_current_price\" as \"cs_item_current_price\",
    spiritual.\"cs_item_desc\" as \"cs_item_desc\",
    spiritual.\"cs_item_name\" as \"cs_item_name\",
    spiritual.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    fowl.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\"
FROM
    fowl
    INNER JOIN spiritual on (fowl.\"cs_item_category\" = spiritual.\"cs_item_category\" or (fowl.\"cs_item_category\" is null and spiritual.\"cs_item_category\" is null)) AND (fowl.\"cs_item_class\" = spiritual.\"cs_item_class\" or (fowl.\"cs_item_class\" is null and spiritual.\"cs_item_class\" is null)) AND (fowl.\"cs_item_current_price\" = spiritual.\"cs_item_current_price\" or (fowl.\"cs_item_current_price\" is null and spiritual.\"cs_item_current_price\" is null)) AND (fowl.\"cs_item_desc\" = spiritual.\"cs_item_desc\" or (fowl.\"cs_item_desc\" is null and spiritual.\"cs_item_desc\" is null)) AND fowl.\"cs_item_name\" = spiritual.\"cs_item_name\"
WHERE
    spiritual.\"cs_item_category\" in ( 'Sports','Books','Home' ) and spiritual.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and spiritual.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
elated as (
SELECT
    ostrich.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    ostrich.\"cs_item_class\" as \"cs_item_class\",
    ostrich.\"cs_item_category\" as \"cs_item_category\",
    ostrich.\"cs_item_current_price\" as \"cs_item_current_price\",
    ostrich.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    ostrich.\"cs_item_desc\" as \"cs_item_desc\",
    ostrich.\"cs_item_name\" as \"cs_item_name\",
    shrike.\"_virtual_503034876863510\" as \"_virtual_503034876863510\"
FROM
    ostrich
    LEFT OUTER JOIN shrike on (ostrich.\"cs_item_class\" = shrike.\"cs_item_class\" or (ostrich.\"cs_item_class\" is null and shrike.\"cs_item_class\" is null)) AND ostrich.\"_agg_sum_364582426434762\" = shrike.\"_agg_sum_364582426434762\"
WHERE
    ostrich.\"cs_item_category\" in ( 'Sports','Books','Home' ) and ostrich.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and ostrich.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
abstracted as (
SELECT
    elated.\"cs_item_category\" as \"cs_item_category\",
    elated.\"cs_item_class\" as \"cs_item_class\",
    elated.\"cs_item_current_price\" as \"cs_item_current_price\",
    elated.\"cs_item_desc\" as \"cs_item_desc\",
    elated.\"cs_item_name\" as \"cs_item_name\",
    elated.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    fowl.\"_virtual_364582426434762\" * 100.0 / elated.\"_virtual_503034876863510\" as \"revenue_ratio\"
FROM
    fowl
    INNER JOIN elated on (fowl.\"cs_item_category\" = elated.\"cs_item_category\" or (fowl.\"cs_item_category\" is null and elated.\"cs_item_category\" is null)) AND (fowl.\"cs_item_class\" = elated.\"cs_item_class\" or (fowl.\"cs_item_class\" is null and elated.\"cs_item_class\" is null)) AND (fowl.\"cs_item_current_price\" = elated.\"cs_item_current_price\" or (fowl.\"cs_item_current_price\" is null and elated.\"cs_item_current_price\" is null)) AND (fowl.\"cs_item_desc\" = elated.\"cs_item_desc\" or (fowl.\"cs_item_desc\" is null and elated.\"cs_item_desc\" is null)) AND fowl.\"cs_item_name\" = elated.\"cs_item_name\"
WHERE
    elated.\"cs_item_category\" in ( 'Sports','Books','Home' ) and elated.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and elated.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
jay as (
SELECT
    abstracted.\"cs_item_category\" as \"cs_item_category\",
    abstracted.\"cs_item_class\" as \"cs_item_class\",
    abstracted.\"cs_item_current_price\" as \"cs_item_current_price\",
    abstracted.\"cs_item_desc\" as \"cs_item_desc\",
    abstracted.\"cs_item_name\" as \"cs_item_name\",
    abstracted.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    abstracted.\"revenue_ratio\" as \"revenue_ratio\",
    crocodile.\"revenue\" as \"revenue\"
FROM
    crocodile
    INNER JOIN abstracted on (crocodile.\"cs_item_category\" = abstracted.\"cs_item_category\" or (crocodile.\"cs_item_category\" is null and abstracted.\"cs_item_category\" is null)) AND (crocodile.\"cs_item_class\" = abstracted.\"cs_item_class\" or (crocodile.\"cs_item_class\" is null and abstracted.\"cs_item_class\" is null)) AND (crocodile.\"cs_item_current_price\" = abstracted.\"cs_item_current_price\" or (crocodile.\"cs_item_current_price\" is null and abstracted.\"cs_item_current_price\" is null)) AND (crocodile.\"cs_item_desc\" = abstracted.\"cs_item_desc\" or (crocodile.\"cs_item_desc\" is null and abstracted.\"cs_item_desc\" is null)) AND crocodile.\"cs_item_name\" = abstracted.\"cs_item_name\"
WHERE
    abstracted.\"cs_item_category\" in ( 'Sports','Books','Home' ) and abstracted.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and abstracted.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
)
SELECT
    jay.\"cs_item_name\" as \"cs_item_name\",
    jay.\"cs_item_desc\" as \"cs_item_desc\",
    jay.\"cs_item_category\" as \"cs_item_category\",
    jay.\"cs_item_class\" as \"cs_item_class\",
    jay.\"cs_item_current_price\" as \"cs_item_current_price\",
    jay.\"revenue\" as \"revenue\",
    jay.\"revenue_ratio\" as \"revenue_ratio\"
FROM
    jay
WHERE
    jay.\"cs_item_category\" in ( 'Sports','Books','Home' ) and jay.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and jay.\"cs_sold_date_date\" <= cast('1999-03-24' as date)

GROUP BY 
    jay.\"cs_item_desc\",
    jay.\"cs_item_class\",
    jay.\"revenue\",
    jay.\"revenue_ratio\",
    jay.\"cs_item_category\",
    jay.\"cs_item_current_price\",
    jay.\"cs_item_name\"
ORDER BY 
    jay.\"cs_item_category\" asc nulls first,
    jay.\"cs_item_class\" asc nulls first,
    jay.\"cs_item_name\" asc nulls first,
    jay.\"cs_item_desc\" asc nulls first,
    jay.\"revenue_ratio\" asc nulls first
LIMIT (100)"""
