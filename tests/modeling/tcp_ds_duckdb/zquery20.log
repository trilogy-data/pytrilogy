query_id = 20
parse_time = 25.4676
exec_time = 1.247418
comp_time = 0.340126
gen_length = 11867
generated_sql = """

WITH 
jay as (
SELECT
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    items.\"I_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.item as items
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
kaput as (
SELECT
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_SOLD_DATE_SK\" as \"cs_sold_date_id\"
FROM
    memory.catalog_sales as catalog_sales
GROUP BY 
    catalog_sales.\"CS_SOLD_DATE_SK\",
    catalog_sales.\"CS_ITEM_SK\"),
colossal as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price_filter_3197596984767774\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN jay on catalog_sales.\"CS_ITEM_SK\" = jay.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    jay.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
imported as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price\",
    jay.\"cs_item_category\" as \"cs_item_category\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\",
    jay.\"cs_item_class\" as \"cs_item_class\",
    jay.\"cs_item_current_price\" as \"cs_item_current_price\",
    jay.\"cs_item_desc\" as \"cs_item_desc\",
    jay.\"cs_item_name\" as \"cs_item_name\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN jay on catalog_sales.\"CS_ITEM_SK\" = jay.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    jay.\"cs_item_category\" in ( 'Sports','Books','Home' )
),
quail as (
SELECT
    items.\"I_ITEM_SK\" as \"cs_item_id\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    kaput.\"cs_sold_date_id\" as \"cs_sold_date_id\"
FROM
    kaput
    INNER JOIN memory.item as items on kaput.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
cool as (
SELECT
    colossal.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    colossal.\"cs_order_number\" as \"cs_order_number\",
    colossal.\"cs_item_id\" as \"cs_item_id\"
FROM
    colossal
    INNER JOIN memory.item as items on colossal.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
scrawny as (
SELECT
    CASE WHEN imported.\"cs_item_category\" in ( 'Sports','Books','Home' ) and imported.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and imported.\"cs_sold_date_date\" <= cast('1999-03-24' as date) THEN imported.\"cs_extra_sales_price\" ELSE NULL END as \"cs_extra_sales_price_filter_3197596984767774\",
    imported.\"cs_order_number\" as \"cs_order_number\",
    imported.\"cs_item_id\" as \"cs_item_id\"
FROM
    imported),
tanager as (
SELECT
    quail.\"cs_item_category\" as \"cs_item_category\",
    quail.\"cs_item_class\" as \"cs_item_class\",
    quail.\"cs_item_current_price\" as \"cs_item_current_price\",
    quail.\"cs_item_desc\" as \"cs_item_desc\",
    quail.\"cs_item_name\" as \"cs_item_name\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\"
FROM
    memory.date_dim as date
    INNER JOIN quail on date.\"D_DATE_SK\" = quail.\"cs_sold_date_id\"
WHERE
    quail.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
macho as (
SELECT
    sum(cool.\"cs_extra_sales_price_filter_3197596984767774\") as \"revenue\",
    cool.\"cs_item_category\" as \"cs_item_category\",
    cool.\"cs_item_class\" as \"cs_item_class\",
    cool.\"cs_item_current_price\" as \"cs_item_current_price\",
    cool.\"cs_item_desc\" as \"cs_item_desc\",
    cool.\"cs_item_name\" as \"cs_item_name\"
FROM
    cool
GROUP BY 
    cool.\"cs_item_current_price\",
    cool.\"cs_item_category\",
    cool.\"cs_item_class\",
    cool.\"cs_item_name\",
    cool.\"cs_item_desc\"),
young as (
SELECT
    scrawny.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    scrawny.\"cs_order_number\" as \"cs_order_number\",
    scrawny.\"cs_item_id\" as \"cs_item_id\"
FROM
    scrawny
    INNER JOIN memory.item as items on scrawny.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
gullible as (
SELECT
    sum(young.\"cs_extra_sales_price_filter_3197596984767774\") as \"_virtual_364582426434762\",
    young.\"cs_item_category\" as \"cs_item_category\",
    young.\"cs_item_class\" as \"cs_item_class\",
    young.\"cs_item_current_price\" as \"cs_item_current_price\",
    young.\"cs_item_desc\" as \"cs_item_desc\",
    young.\"cs_item_name\" as \"cs_item_name\",
    sum(young.\"cs_extra_sales_price_filter_3197596984767774\") as \"_agg_sum_364582426434762\"
FROM
    young
GROUP BY 
    young.\"cs_item_desc\",
    young.\"cs_item_category\",
    young.\"cs_item_name\",
    young.\"cs_item_class\",
    young.\"cs_item_current_price\"),
thrush as (
SELECT
    sum(gullible.\"_agg_sum_364582426434762\") over (partition by gullible.\"cs_item_class\") as \"_virtual_503034876863510\",
    gullible.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    gullible.\"cs_item_class\" as \"cs_item_class\"
FROM
    gullible),
level as (
SELECT
    tanager.\"cs_item_category\" as \"cs_item_category\",
    tanager.\"cs_item_class\" as \"cs_item_class\",
    tanager.\"cs_item_current_price\" as \"cs_item_current_price\",
    tanager.\"cs_item_desc\" as \"cs_item_desc\",
    tanager.\"cs_item_name\" as \"cs_item_name\",
    tanager.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    gullible.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\"
FROM
    gullible
    INNER JOIN tanager on (gullible.\"cs_item_category\" = tanager.\"cs_item_category\" or (gullible.\"cs_item_category\" is null and tanager.\"cs_item_category\" is null)) AND (gullible.\"cs_item_class\" = tanager.\"cs_item_class\" or (gullible.\"cs_item_class\" is null and tanager.\"cs_item_class\" is null)) AND (gullible.\"cs_item_current_price\" = tanager.\"cs_item_current_price\" or (gullible.\"cs_item_current_price\" is null and tanager.\"cs_item_current_price\" is null)) AND (gullible.\"cs_item_desc\" = tanager.\"cs_item_desc\" or (gullible.\"cs_item_desc\" is null and tanager.\"cs_item_desc\" is null)) AND gullible.\"cs_item_name\" = tanager.\"cs_item_name\"
WHERE
    tanager.\"cs_item_category\" in ( 'Sports','Books','Home' ) and tanager.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and tanager.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
brave as (
SELECT
    level.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    level.\"cs_item_class\" as \"cs_item_class\",
    level.\"cs_item_category\" as \"cs_item_category\",
    level.\"cs_item_current_price\" as \"cs_item_current_price\",
    level.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    level.\"cs_item_desc\" as \"cs_item_desc\",
    level.\"cs_item_name\" as \"cs_item_name\",
    thrush.\"_virtual_503034876863510\" as \"_virtual_503034876863510\"
FROM
    level
    LEFT OUTER JOIN thrush on (level.\"cs_item_class\" = thrush.\"cs_item_class\" or (level.\"cs_item_class\" is null and thrush.\"cs_item_class\" is null)) AND level.\"_agg_sum_364582426434762\" = thrush.\"_agg_sum_364582426434762\"
WHERE
    level.\"cs_item_category\" in ( 'Sports','Books','Home' ) and level.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and level.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
albatross as (
SELECT
    brave.\"cs_item_category\" as \"cs_item_category\",
    brave.\"cs_item_class\" as \"cs_item_class\",
    brave.\"cs_item_current_price\" as \"cs_item_current_price\",
    brave.\"cs_item_desc\" as \"cs_item_desc\",
    brave.\"cs_item_name\" as \"cs_item_name\",
    brave.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    gullible.\"_virtual_364582426434762\" * 100.0 / brave.\"_virtual_503034876863510\" as \"revenue_ratio\"
FROM
    gullible
    INNER JOIN brave on (gullible.\"cs_item_category\" = brave.\"cs_item_category\" or (gullible.\"cs_item_category\" is null and brave.\"cs_item_category\" is null)) AND (gullible.\"cs_item_class\" = brave.\"cs_item_class\" or (gullible.\"cs_item_class\" is null and brave.\"cs_item_class\" is null)) AND (gullible.\"cs_item_current_price\" = brave.\"cs_item_current_price\" or (gullible.\"cs_item_current_price\" is null and brave.\"cs_item_current_price\" is null)) AND (gullible.\"cs_item_desc\" = brave.\"cs_item_desc\" or (gullible.\"cs_item_desc\" is null and brave.\"cs_item_desc\" is null)) AND gullible.\"cs_item_name\" = brave.\"cs_item_name\"
WHERE
    brave.\"cs_item_category\" in ( 'Sports','Books','Home' ) and brave.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and brave.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
vivacious as (
SELECT
    albatross.\"cs_item_category\" as \"cs_item_category\",
    albatross.\"cs_item_class\" as \"cs_item_class\",
    albatross.\"cs_item_current_price\" as \"cs_item_current_price\",
    albatross.\"cs_item_desc\" as \"cs_item_desc\",
    albatross.\"cs_item_name\" as \"cs_item_name\",
    albatross.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    albatross.\"revenue_ratio\" as \"revenue_ratio\",
    macho.\"revenue\" as \"revenue\"
FROM
    macho
    INNER JOIN albatross on (macho.\"cs_item_category\" = albatross.\"cs_item_category\" or (macho.\"cs_item_category\" is null and albatross.\"cs_item_category\" is null)) AND (macho.\"cs_item_class\" = albatross.\"cs_item_class\" or (macho.\"cs_item_class\" is null and albatross.\"cs_item_class\" is null)) AND (macho.\"cs_item_current_price\" = albatross.\"cs_item_current_price\" or (macho.\"cs_item_current_price\" is null and albatross.\"cs_item_current_price\" is null)) AND (macho.\"cs_item_desc\" = albatross.\"cs_item_desc\" or (macho.\"cs_item_desc\" is null and albatross.\"cs_item_desc\" is null)) AND macho.\"cs_item_name\" = albatross.\"cs_item_name\"
WHERE
    albatross.\"cs_item_category\" in ( 'Sports','Books','Home' ) and albatross.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and albatross.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
)
SELECT
    vivacious.\"cs_item_name\" as \"cs_item_name\",
    vivacious.\"cs_item_desc\" as \"cs_item_desc\",
    vivacious.\"cs_item_category\" as \"cs_item_category\",
    vivacious.\"cs_item_class\" as \"cs_item_class\",
    vivacious.\"cs_item_current_price\" as \"cs_item_current_price\",
    vivacious.\"revenue\" as \"revenue\",
    vivacious.\"revenue_ratio\" as \"revenue_ratio\"
FROM
    vivacious
WHERE
    vivacious.\"cs_item_category\" in ( 'Sports','Books','Home' ) and vivacious.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and vivacious.\"cs_sold_date_date\" <= cast('1999-03-24' as date)

GROUP BY 
    vivacious.\"cs_item_desc\",
    vivacious.\"cs_item_class\",
    vivacious.\"revenue\",
    vivacious.\"revenue_ratio\",
    vivacious.\"cs_item_category\",
    vivacious.\"cs_item_name\",
    vivacious.\"cs_item_current_price\"
ORDER BY 
    vivacious.\"cs_item_category\" asc nulls first,
    vivacious.\"cs_item_class\" asc nulls first,
    vivacious.\"cs_item_name\" asc nulls first,
    vivacious.\"cs_item_desc\" asc nulls first,
    vivacious.\"revenue_ratio\" asc nulls first
LIMIT (100)"""
