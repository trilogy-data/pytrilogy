query_id = 20
parse_time = 10.55029
exec_time = 0.570809
comp_time = 0.15791
gen_length = 11766
generated_sql = """

WITH 
parakeet as (
SELECT
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    items.\"I_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.item as items
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
shark as (
SELECT
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_SOLD_DATE_SK\" as \"cs_sold_date_id\"
FROM
    memory.catalog_sales as catalog_sales
GROUP BY 
    catalog_sales.\"CS_SOLD_DATE_SK\",
    catalog_sales.\"CS_ITEM_SK\"),
eagle as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price_filter_3197596984767774\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN parakeet on catalog_sales.\"CS_ITEM_SK\" = parakeet.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    parakeet.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
fossa as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price\",
    parakeet.\"cs_item_category\" as \"cs_item_category\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\",
    parakeet.\"cs_item_class\" as \"cs_item_class\",
    parakeet.\"cs_item_current_price\" as \"cs_item_current_price\",
    parakeet.\"cs_item_desc\" as \"cs_item_desc\",
    parakeet.\"cs_item_name\" as \"cs_item_name\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN parakeet on catalog_sales.\"CS_ITEM_SK\" = parakeet.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    parakeet.\"cs_item_category\" in ( 'Sports','Books','Home' )
),
goose as (
SELECT
    items.\"I_ITEM_SK\" as \"cs_item_id\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    shark.\"cs_sold_date_id\" as \"cs_sold_date_id\"
FROM
    shark
    INNER JOIN memory.item as items on shark.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
highfalutin as (
SELECT
    eagle.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    eagle.\"cs_order_number\" as \"cs_order_number\",
    eagle.\"cs_item_id\" as \"cs_item_id\"
FROM
    eagle
    INNER JOIN memory.item as items on eagle.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
wary as (
SELECT
    CASE WHEN fossa.\"cs_item_category\" in ( 'Sports','Books','Home' ) and fossa.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and fossa.\"cs_sold_date_date\" <= cast('1999-03-24' as date) THEN fossa.\"cs_extra_sales_price\" ELSE NULL END as \"cs_extra_sales_price_filter_3197596984767774\",
    fossa.\"cs_order_number\" as \"cs_order_number\",
    fossa.\"cs_item_id\" as \"cs_item_id\"
FROM
    fossa),
budgie as (
SELECT
    goose.\"cs_item_category\" as \"cs_item_category\",
    goose.\"cs_item_class\" as \"cs_item_class\",
    goose.\"cs_item_current_price\" as \"cs_item_current_price\",
    goose.\"cs_item_desc\" as \"cs_item_desc\",
    goose.\"cs_item_name\" as \"cs_item_name\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\"
FROM
    memory.date_dim as date
    INNER JOIN goose on date.\"D_DATE_SK\" = goose.\"cs_sold_date_id\"
WHERE
    goose.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
ugly as (
SELECT
    sum(highfalutin.\"cs_extra_sales_price_filter_3197596984767774\") as \"revenue\",
    highfalutin.\"cs_item_category\" as \"cs_item_category\",
    highfalutin.\"cs_item_class\" as \"cs_item_class\",
    highfalutin.\"cs_item_current_price\" as \"cs_item_current_price\",
    highfalutin.\"cs_item_desc\" as \"cs_item_desc\",
    highfalutin.\"cs_item_name\" as \"cs_item_name\"
FROM
    highfalutin
GROUP BY 
    highfalutin.\"cs_item_category\",
    highfalutin.\"cs_item_current_price\",
    highfalutin.\"cs_item_name\",
    highfalutin.\"cs_item_class\",
    highfalutin.\"cs_item_desc\"),
odd as (
SELECT
    wary.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    wary.\"cs_order_number\" as \"cs_order_number\",
    wary.\"cs_item_id\" as \"cs_item_id\"
FROM
    wary
    INNER JOIN memory.item as items on wary.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
obsolete as (
SELECT
    sum(odd.\"cs_extra_sales_price_filter_3197596984767774\") as \"_virtual_364582426434762\",
    odd.\"cs_item_category\" as \"cs_item_category\",
    odd.\"cs_item_class\" as \"cs_item_class\",
    odd.\"cs_item_current_price\" as \"cs_item_current_price\",
    odd.\"cs_item_desc\" as \"cs_item_desc\",
    odd.\"cs_item_name\" as \"cs_item_name\",
    sum(odd.\"cs_extra_sales_price_filter_3197596984767774\") as \"_agg_sum_364582426434762\"
FROM
    odd
GROUP BY 
    odd.\"cs_item_current_price\",
    odd.\"cs_item_desc\",
    odd.\"cs_item_category\",
    odd.\"cs_item_name\",
    odd.\"cs_item_class\"),
fabulous as (
SELECT
    sum(obsolete.\"_agg_sum_364582426434762\") over (partition by obsolete.\"cs_item_class\") as \"_virtual_503034876863510\",
    obsolete.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    obsolete.\"cs_item_class\" as \"cs_item_class\"
FROM
    obsolete),
hawk as (
SELECT
    budgie.\"cs_item_category\" as \"cs_item_category\",
    budgie.\"cs_item_class\" as \"cs_item_class\",
    budgie.\"cs_item_current_price\" as \"cs_item_current_price\",
    budgie.\"cs_item_desc\" as \"cs_item_desc\",
    budgie.\"cs_item_name\" as \"cs_item_name\",
    budgie.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    obsolete.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\"
FROM
    obsolete
    INNER JOIN budgie on (obsolete.\"cs_item_category\" = budgie.\"cs_item_category\" or (obsolete.\"cs_item_category\" is null and budgie.\"cs_item_category\" is null)) AND (obsolete.\"cs_item_class\" = budgie.\"cs_item_class\" or (obsolete.\"cs_item_class\" is null and budgie.\"cs_item_class\" is null)) AND (obsolete.\"cs_item_current_price\" = budgie.\"cs_item_current_price\" or (obsolete.\"cs_item_current_price\" is null and budgie.\"cs_item_current_price\" is null)) AND (obsolete.\"cs_item_desc\" = budgie.\"cs_item_desc\" or (obsolete.\"cs_item_desc\" is null and budgie.\"cs_item_desc\" is null)) AND obsolete.\"cs_item_name\" = budgie.\"cs_item_name\"
WHERE
    budgie.\"cs_item_category\" in ( 'Sports','Books','Home' ) and budgie.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and budgie.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
skua as (
SELECT
    hawk.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    hawk.\"cs_item_class\" as \"cs_item_class\",
    hawk.\"cs_item_category\" as \"cs_item_category\",
    hawk.\"cs_item_current_price\" as \"cs_item_current_price\",
    hawk.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    hawk.\"cs_item_desc\" as \"cs_item_desc\",
    hawk.\"cs_item_name\" as \"cs_item_name\",
    fabulous.\"_virtual_503034876863510\" as \"_virtual_503034876863510\"
FROM
    hawk
    LEFT OUTER JOIN fabulous on (hawk.\"cs_item_class\" = fabulous.\"cs_item_class\" or (hawk.\"cs_item_class\" is null and fabulous.\"cs_item_class\" is null)) AND hawk.\"_agg_sum_364582426434762\" = fabulous.\"_agg_sum_364582426434762\"
WHERE
    hawk.\"cs_item_category\" in ( 'Sports','Books','Home' ) and hawk.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and hawk.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
covey as (
SELECT
    skua.\"cs_item_category\" as \"cs_item_category\",
    skua.\"cs_item_class\" as \"cs_item_class\",
    skua.\"cs_item_current_price\" as \"cs_item_current_price\",
    skua.\"cs_item_desc\" as \"cs_item_desc\",
    skua.\"cs_item_name\" as \"cs_item_name\",
    skua.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    obsolete.\"_virtual_364582426434762\" * 100.0 / skua.\"_virtual_503034876863510\" as \"revenue_ratio\"
FROM
    obsolete
    INNER JOIN skua on (obsolete.\"cs_item_category\" = skua.\"cs_item_category\" or (obsolete.\"cs_item_category\" is null and skua.\"cs_item_category\" is null)) AND (obsolete.\"cs_item_class\" = skua.\"cs_item_class\" or (obsolete.\"cs_item_class\" is null and skua.\"cs_item_class\" is null)) AND (obsolete.\"cs_item_current_price\" = skua.\"cs_item_current_price\" or (obsolete.\"cs_item_current_price\" is null and skua.\"cs_item_current_price\" is null)) AND (obsolete.\"cs_item_desc\" = skua.\"cs_item_desc\" or (obsolete.\"cs_item_desc\" is null and skua.\"cs_item_desc\" is null)) AND obsolete.\"cs_item_name\" = skua.\"cs_item_name\"
WHERE
    skua.\"cs_item_category\" in ( 'Sports','Books','Home' ) and skua.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and skua.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
friendly as (
SELECT
    covey.\"cs_item_category\" as \"cs_item_category\",
    covey.\"cs_item_class\" as \"cs_item_class\",
    covey.\"cs_item_current_price\" as \"cs_item_current_price\",
    covey.\"cs_item_desc\" as \"cs_item_desc\",
    covey.\"cs_item_name\" as \"cs_item_name\",
    covey.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    covey.\"revenue_ratio\" as \"revenue_ratio\",
    ugly.\"revenue\" as \"revenue\"
FROM
    ugly
    INNER JOIN covey on (ugly.\"cs_item_category\" = covey.\"cs_item_category\" or (ugly.\"cs_item_category\" is null and covey.\"cs_item_category\" is null)) AND (ugly.\"cs_item_class\" = covey.\"cs_item_class\" or (ugly.\"cs_item_class\" is null and covey.\"cs_item_class\" is null)) AND (ugly.\"cs_item_current_price\" = covey.\"cs_item_current_price\" or (ugly.\"cs_item_current_price\" is null and covey.\"cs_item_current_price\" is null)) AND (ugly.\"cs_item_desc\" = covey.\"cs_item_desc\" or (ugly.\"cs_item_desc\" is null and covey.\"cs_item_desc\" is null)) AND ugly.\"cs_item_name\" = covey.\"cs_item_name\"
WHERE
    covey.\"cs_item_category\" in ( 'Sports','Books','Home' ) and covey.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and covey.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
)
SELECT
    friendly.\"cs_item_name\" as \"cs_item_name\",
    friendly.\"cs_item_desc\" as \"cs_item_desc\",
    friendly.\"cs_item_category\" as \"cs_item_category\",
    friendly.\"cs_item_class\" as \"cs_item_class\",
    friendly.\"cs_item_current_price\" as \"cs_item_current_price\",
    friendly.\"revenue\" as \"revenue\",
    friendly.\"revenue_ratio\" as \"revenue_ratio\"
FROM
    friendly
WHERE
    friendly.\"cs_item_category\" in ( 'Sports','Books','Home' ) and friendly.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and friendly.\"cs_sold_date_date\" <= cast('1999-03-24' as date)

GROUP BY 
    friendly.\"cs_item_current_price\",
    friendly.\"revenue\",
    friendly.\"cs_item_desc\",
    friendly.\"revenue_ratio\",
    friendly.\"cs_item_class\",
    friendly.\"cs_item_name\",
    friendly.\"cs_item_category\"
ORDER BY 
    friendly.\"cs_item_category\" asc nulls first,
    friendly.\"cs_item_class\" asc nulls first,
    friendly.\"cs_item_name\" asc nulls first,
    friendly.\"cs_item_desc\" asc nulls first,
    friendly.\"revenue_ratio\" asc nulls first
LIMIT (100)"""
