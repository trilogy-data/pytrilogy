query_id = 20
parse_time = 24.391938
exec_time = 1.827266
comp_time = 0.396532
gen_length = 11855
generated_sql = """

WITH 
jay as (
SELECT
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    items.\"I_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.item as items
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
slow as (
SELECT
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_SOLD_DATE_SK\" as \"cs_sold_date_id\"
FROM
    memory.catalog_sales as catalog_sales
GROUP BY 
    catalog_sales.\"CS_SOLD_DATE_SK\",
    catalog_sales.\"CS_ITEM_SK\"),
thoughtful as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price_filter_3197596984767774\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN jay on catalog_sales.\"CS_ITEM_SK\" = jay.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    jay.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
coyote as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price\",
    jay.\"cs_item_category\" as \"cs_item_category\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\",
    jay.\"cs_item_class\" as \"cs_item_class\",
    jay.\"cs_item_current_price\" as \"cs_item_current_price\",
    jay.\"cs_item_desc\" as \"cs_item_desc\",
    jay.\"cs_item_name\" as \"cs_item_name\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN jay on catalog_sales.\"CS_ITEM_SK\" = jay.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    jay.\"cs_item_category\" in ( 'Sports','Books','Home' )
),
yellow as (
SELECT
    items.\"I_ITEM_SK\" as \"cs_item_id\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    slow.\"cs_sold_date_id\" as \"cs_sold_date_id\"
FROM
    slow
    INNER JOIN memory.item as items on slow.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
abstracted as (
SELECT
    thoughtful.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    thoughtful.\"cs_order_number\" as \"cs_order_number\",
    thoughtful.\"cs_item_id\" as \"cs_item_id\"
FROM
    thoughtful
    INNER JOIN memory.item as items on thoughtful.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
dingo as (
SELECT
    CASE WHEN coyote.\"cs_item_category\" in ( 'Sports','Books','Home' ) and coyote.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and coyote.\"cs_sold_date_date\" <= cast('1999-03-24' as date) THEN coyote.\"cs_extra_sales_price\" ELSE NULL END as \"cs_extra_sales_price_filter_3197596984767774\",
    coyote.\"cs_order_number\" as \"cs_order_number\",
    coyote.\"cs_item_id\" as \"cs_item_id\"
FROM
    coyote),
level as (
SELECT
    yellow.\"cs_item_category\" as \"cs_item_category\",
    yellow.\"cs_item_class\" as \"cs_item_class\",
    yellow.\"cs_item_current_price\" as \"cs_item_current_price\",
    yellow.\"cs_item_desc\" as \"cs_item_desc\",
    yellow.\"cs_item_name\" as \"cs_item_name\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\"
FROM
    memory.date_dim as date
    INNER JOIN yellow on date.\"D_DATE_SK\" = yellow.\"cs_sold_date_id\"
WHERE
    yellow.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
vacuous as (
SELECT
    sum(abstracted.\"cs_extra_sales_price_filter_3197596984767774\") as \"revenue\",
    abstracted.\"cs_item_category\" as \"cs_item_category\",
    abstracted.\"cs_item_class\" as \"cs_item_class\",
    abstracted.\"cs_item_current_price\" as \"cs_item_current_price\",
    abstracted.\"cs_item_desc\" as \"cs_item_desc\",
    abstracted.\"cs_item_name\" as \"cs_item_name\"
FROM
    abstracted
GROUP BY 
    abstracted.\"cs_item_category\",
    abstracted.\"cs_item_current_price\",
    abstracted.\"cs_item_name\",
    abstracted.\"cs_item_desc\",
    abstracted.\"cs_item_class\"),
resonant as (
SELECT
    dingo.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    dingo.\"cs_order_number\" as \"cs_order_number\",
    dingo.\"cs_item_id\" as \"cs_item_id\"
FROM
    dingo
    INNER JOIN memory.item as items on dingo.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
covey as (
SELECT
    sum(resonant.\"cs_extra_sales_price_filter_3197596984767774\") as \"_virtual_364582426434762\",
    resonant.\"cs_item_category\" as \"cs_item_category\",
    resonant.\"cs_item_class\" as \"cs_item_class\",
    resonant.\"cs_item_current_price\" as \"cs_item_current_price\",
    resonant.\"cs_item_desc\" as \"cs_item_desc\",
    resonant.\"cs_item_name\" as \"cs_item_name\",
    sum(resonant.\"cs_extra_sales_price_filter_3197596984767774\") as \"_agg_sum_364582426434762\"
FROM
    resonant
GROUP BY 
    resonant.\"cs_item_class\",
    resonant.\"cs_item_name\",
    resonant.\"cs_item_category\",
    resonant.\"cs_item_current_price\",
    resonant.\"cs_item_desc\"),
dove as (
SELECT
    sum(covey.\"_agg_sum_364582426434762\") over (partition by covey.\"cs_item_class\") as \"_virtual_503034876863510\",
    covey.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    covey.\"cs_item_class\" as \"cs_item_class\"
FROM
    covey),
eminent as (
SELECT
    level.\"cs_item_category\" as \"cs_item_category\",
    level.\"cs_item_class\" as \"cs_item_class\",
    level.\"cs_item_current_price\" as \"cs_item_current_price\",
    level.\"cs_item_desc\" as \"cs_item_desc\",
    level.\"cs_item_name\" as \"cs_item_name\",
    level.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    covey.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\"
FROM
    covey
    INNER JOIN level on (covey.\"cs_item_category\" = level.\"cs_item_category\" or (covey.\"cs_item_category\" is null and level.\"cs_item_category\" is null)) AND (covey.\"cs_item_class\" = level.\"cs_item_class\" or (covey.\"cs_item_class\" is null and level.\"cs_item_class\" is null)) AND (covey.\"cs_item_current_price\" = level.\"cs_item_current_price\" or (covey.\"cs_item_current_price\" is null and level.\"cs_item_current_price\" is null)) AND (covey.\"cs_item_desc\" = level.\"cs_item_desc\" or (covey.\"cs_item_desc\" is null and level.\"cs_item_desc\" is null)) AND covey.\"cs_item_name\" = level.\"cs_item_name\"
WHERE
    level.\"cs_item_category\" in ( 'Sports','Books','Home' ) and level.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and level.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
quetzal as (
SELECT
    eminent.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    eminent.\"cs_item_class\" as \"cs_item_class\",
    eminent.\"cs_item_category\" as \"cs_item_category\",
    eminent.\"cs_item_current_price\" as \"cs_item_current_price\",
    eminent.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    eminent.\"cs_item_desc\" as \"cs_item_desc\",
    eminent.\"cs_item_name\" as \"cs_item_name\",
    dove.\"_virtual_503034876863510\" as \"_virtual_503034876863510\"
FROM
    eminent
    LEFT OUTER JOIN dove on (eminent.\"cs_item_class\" = dove.\"cs_item_class\" or (eminent.\"cs_item_class\" is null and dove.\"cs_item_class\" is null)) AND eminent.\"_agg_sum_364582426434762\" = dove.\"_agg_sum_364582426434762\"
WHERE
    eminent.\"cs_item_category\" in ( 'Sports','Books','Home' ) and eminent.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and eminent.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
rambunctious as (
SELECT
    quetzal.\"cs_item_category\" as \"cs_item_category\",
    quetzal.\"cs_item_class\" as \"cs_item_class\",
    quetzal.\"cs_item_current_price\" as \"cs_item_current_price\",
    quetzal.\"cs_item_desc\" as \"cs_item_desc\",
    quetzal.\"cs_item_name\" as \"cs_item_name\",
    quetzal.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    covey.\"_virtual_364582426434762\" * 100.0 / quetzal.\"_virtual_503034876863510\" as \"revenue_ratio\"
FROM
    covey
    INNER JOIN quetzal on (covey.\"cs_item_category\" = quetzal.\"cs_item_category\" or (covey.\"cs_item_category\" is null and quetzal.\"cs_item_category\" is null)) AND (covey.\"cs_item_class\" = quetzal.\"cs_item_class\" or (covey.\"cs_item_class\" is null and quetzal.\"cs_item_class\" is null)) AND (covey.\"cs_item_current_price\" = quetzal.\"cs_item_current_price\" or (covey.\"cs_item_current_price\" is null and quetzal.\"cs_item_current_price\" is null)) AND (covey.\"cs_item_desc\" = quetzal.\"cs_item_desc\" or (covey.\"cs_item_desc\" is null and quetzal.\"cs_item_desc\" is null)) AND covey.\"cs_item_name\" = quetzal.\"cs_item_name\"
WHERE
    quetzal.\"cs_item_category\" in ( 'Sports','Books','Home' ) and quetzal.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and quetzal.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
owl as (
SELECT
    rambunctious.\"cs_item_category\" as \"cs_item_category\",
    rambunctious.\"cs_item_class\" as \"cs_item_class\",
    rambunctious.\"cs_item_current_price\" as \"cs_item_current_price\",
    rambunctious.\"cs_item_desc\" as \"cs_item_desc\",
    rambunctious.\"cs_item_name\" as \"cs_item_name\",
    rambunctious.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    rambunctious.\"revenue_ratio\" as \"revenue_ratio\",
    vacuous.\"revenue\" as \"revenue\"
FROM
    vacuous
    INNER JOIN rambunctious on (vacuous.\"cs_item_category\" = rambunctious.\"cs_item_category\" or (vacuous.\"cs_item_category\" is null and rambunctious.\"cs_item_category\" is null)) AND (vacuous.\"cs_item_class\" = rambunctious.\"cs_item_class\" or (vacuous.\"cs_item_class\" is null and rambunctious.\"cs_item_class\" is null)) AND (vacuous.\"cs_item_current_price\" = rambunctious.\"cs_item_current_price\" or (vacuous.\"cs_item_current_price\" is null and rambunctious.\"cs_item_current_price\" is null)) AND (vacuous.\"cs_item_desc\" = rambunctious.\"cs_item_desc\" or (vacuous.\"cs_item_desc\" is null and rambunctious.\"cs_item_desc\" is null)) AND vacuous.\"cs_item_name\" = rambunctious.\"cs_item_name\"
WHERE
    rambunctious.\"cs_item_category\" in ( 'Sports','Books','Home' ) and rambunctious.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and rambunctious.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
)
SELECT
    owl.\"cs_item_name\" as \"cs_item_name\",
    owl.\"cs_item_desc\" as \"cs_item_desc\",
    owl.\"cs_item_category\" as \"cs_item_category\",
    owl.\"cs_item_class\" as \"cs_item_class\",
    owl.\"cs_item_current_price\" as \"cs_item_current_price\",
    owl.\"revenue\" as \"revenue\",
    owl.\"revenue_ratio\" as \"revenue_ratio\"
FROM
    owl
WHERE
    owl.\"cs_item_category\" in ( 'Sports','Books','Home' ) and owl.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and owl.\"cs_sold_date_date\" <= cast('1999-03-24' as date)

GROUP BY 
    owl.\"cs_item_name\",
    owl.\"cs_item_current_price\",
    owl.\"cs_item_desc\",
    owl.\"revenue_ratio\",
    owl.\"revenue\",
    owl.\"cs_item_category\",
    owl.\"cs_item_class\"
ORDER BY 
    owl.\"cs_item_category\" asc nulls first,
    owl.\"cs_item_class\" asc nulls first,
    owl.\"cs_item_name\" asc nulls first,
    owl.\"cs_item_desc\" asc nulls first,
    owl.\"revenue_ratio\" asc nulls first
LIMIT (100)"""
