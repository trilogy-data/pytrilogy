query_id = 20
parse_time = 9.505639
exec_time = 0.719444
comp_time = 0.259552
gen_length = 11790
generated_sql = """

WITH 
toucan as (
SELECT
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    items.\"I_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.item as items
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
ruthless as (
SELECT
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_SOLD_DATE_SK\" as \"cs_sold_date_id\"
FROM
    memory.catalog_sales as catalog_sales
GROUP BY 
    catalog_sales.\"CS_SOLD_DATE_SK\",
    catalog_sales.\"CS_ITEM_SK\"),
razorbill as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price_filter_3197596984767774\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN toucan on catalog_sales.\"CS_ITEM_SK\" = toucan.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    toucan.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
lynx as (
SELECT
    catalog_sales.\"CS_EXT_SALES_PRICE\" as \"cs_extra_sales_price\",
    toucan.\"cs_item_category\" as \"cs_item_category\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\",
    toucan.\"cs_item_class\" as \"cs_item_class\",
    toucan.\"cs_item_current_price\" as \"cs_item_current_price\",
    toucan.\"cs_item_desc\" as \"cs_item_desc\",
    toucan.\"cs_item_name\" as \"cs_item_name\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN toucan on catalog_sales.\"CS_ITEM_SK\" = toucan.\"cs_item_id\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    toucan.\"cs_item_category\" in ( 'Sports','Books','Home' )
),
kestrel as (
SELECT
    items.\"I_ITEM_SK\" as \"cs_item_id\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    ruthless.\"cs_sold_date_id\" as \"cs_sold_date_id\"
FROM
    ruthless
    INNER JOIN memory.item as items on ruthless.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
python as (
SELECT
    razorbill.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    razorbill.\"cs_order_number\" as \"cs_order_number\",
    razorbill.\"cs_item_id\" as \"cs_item_id\"
FROM
    razorbill
    INNER JOIN memory.item as items on razorbill.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
cougar as (
SELECT
    CASE WHEN lynx.\"cs_item_category\" in ( 'Sports','Books','Home' ) and lynx.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and lynx.\"cs_sold_date_date\" <= cast('1999-03-24' as date) THEN lynx.\"cs_extra_sales_price\" ELSE NULL END as \"cs_extra_sales_price_filter_3197596984767774\",
    lynx.\"cs_order_number\" as \"cs_order_number\",
    lynx.\"cs_item_id\" as \"cs_item_id\"
FROM
    lynx),
parrot as (
SELECT
    kestrel.\"cs_item_category\" as \"cs_item_category\",
    kestrel.\"cs_item_class\" as \"cs_item_class\",
    kestrel.\"cs_item_current_price\" as \"cs_item_current_price\",
    kestrel.\"cs_item_desc\" as \"cs_item_desc\",
    kestrel.\"cs_item_name\" as \"cs_item_name\",
    cast(\"D_DATE\" as date) as \"cs_sold_date_date\"
FROM
    memory.date_dim as date
    INNER JOIN kestrel on date.\"D_DATE_SK\" = kestrel.\"cs_sold_date_id\"
WHERE
    kestrel.\"cs_item_category\" in ( 'Sports','Books','Home' ) and cast(\"D_DATE\" as date) >= cast('1999-02-22' as date) and cast(\"D_DATE\" as date) <= cast('1999-03-24' as date)
),
flamingo as (
SELECT
    sum(python.\"cs_extra_sales_price_filter_3197596984767774\") as \"revenue\",
    python.\"cs_item_category\" as \"cs_item_category\",
    python.\"cs_item_class\" as \"cs_item_class\",
    python.\"cs_item_current_price\" as \"cs_item_current_price\",
    python.\"cs_item_desc\" as \"cs_item_desc\",
    python.\"cs_item_name\" as \"cs_item_name\"
FROM
    python
GROUP BY 
    python.\"cs_item_desc\",
    python.\"cs_item_class\",
    python.\"cs_item_name\",
    python.\"cs_item_category\",
    python.\"cs_item_current_price\"),
sordid as (
SELECT
    cougar.\"cs_extra_sales_price_filter_3197596984767774\" as \"cs_extra_sales_price_filter_3197596984767774\",
    items.\"I_CATEGORY\" as \"cs_item_category\",
    items.\"I_CLASS\" as \"cs_item_class\",
    items.\"I_CURRENT_PRICE\" as \"cs_item_current_price\",
    items.\"I_ITEM_DESC\" as \"cs_item_desc\",
    items.\"I_ITEM_ID\" as \"cs_item_name\",
    cougar.\"cs_order_number\" as \"cs_order_number\",
    cougar.\"cs_item_id\" as \"cs_item_id\"
FROM
    cougar
    INNER JOIN memory.item as items on cougar.\"cs_item_id\" = items.\"I_ITEM_SK\"
WHERE
    items.\"I_CATEGORY\" in ( 'Sports','Books','Home' )
),
boa as (
SELECT
    sum(sordid.\"cs_extra_sales_price_filter_3197596984767774\") as \"_virtual_364582426434762\",
    sordid.\"cs_item_category\" as \"cs_item_category\",
    sordid.\"cs_item_class\" as \"cs_item_class\",
    sordid.\"cs_item_current_price\" as \"cs_item_current_price\",
    sordid.\"cs_item_desc\" as \"cs_item_desc\",
    sordid.\"cs_item_name\" as \"cs_item_name\",
    sum(sordid.\"cs_extra_sales_price_filter_3197596984767774\") as \"_agg_sum_364582426434762\"
FROM
    sordid
GROUP BY 
    sordid.\"cs_item_desc\",
    sordid.\"cs_item_category\",
    sordid.\"cs_item_name\",
    sordid.\"cs_item_class\",
    sordid.\"cs_item_current_price\"),
blue as (
SELECT
    sum(boa.\"_agg_sum_364582426434762\") over (partition by boa.\"cs_item_class\") as \"_virtual_503034876863510\",
    boa.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    boa.\"cs_item_class\" as \"cs_item_class\"
FROM
    boa),
barracuda as (
SELECT
    parrot.\"cs_item_category\" as \"cs_item_category\",
    parrot.\"cs_item_class\" as \"cs_item_class\",
    parrot.\"cs_item_current_price\" as \"cs_item_current_price\",
    parrot.\"cs_item_desc\" as \"cs_item_desc\",
    parrot.\"cs_item_name\" as \"cs_item_name\",
    parrot.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    boa.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\"
FROM
    boa
    INNER JOIN parrot on (boa.\"cs_item_category\" = parrot.\"cs_item_category\" or (boa.\"cs_item_category\" is null and parrot.\"cs_item_category\" is null)) AND (boa.\"cs_item_class\" = parrot.\"cs_item_class\" or (boa.\"cs_item_class\" is null and parrot.\"cs_item_class\" is null)) AND (boa.\"cs_item_current_price\" = parrot.\"cs_item_current_price\" or (boa.\"cs_item_current_price\" is null and parrot.\"cs_item_current_price\" is null)) AND (boa.\"cs_item_desc\" = parrot.\"cs_item_desc\" or (boa.\"cs_item_desc\" is null and parrot.\"cs_item_desc\" is null)) AND boa.\"cs_item_name\" = parrot.\"cs_item_name\"
WHERE
    parrot.\"cs_item_category\" in ( 'Sports','Books','Home' ) and parrot.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and parrot.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
obsolete as (
SELECT
    barracuda.\"_agg_sum_364582426434762\" as \"_agg_sum_364582426434762\",
    barracuda.\"cs_item_class\" as \"cs_item_class\",
    barracuda.\"cs_item_category\" as \"cs_item_category\",
    barracuda.\"cs_item_current_price\" as \"cs_item_current_price\",
    barracuda.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    barracuda.\"cs_item_desc\" as \"cs_item_desc\",
    barracuda.\"cs_item_name\" as \"cs_item_name\",
    blue.\"_virtual_503034876863510\" as \"_virtual_503034876863510\"
FROM
    barracuda
    LEFT OUTER JOIN blue on (barracuda.\"cs_item_class\" = blue.\"cs_item_class\" or (barracuda.\"cs_item_class\" is null and blue.\"cs_item_class\" is null)) AND barracuda.\"_agg_sum_364582426434762\" = blue.\"_agg_sum_364582426434762\"
WHERE
    barracuda.\"cs_item_category\" in ( 'Sports','Books','Home' ) and barracuda.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and barracuda.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
jackdaw as (
SELECT
    obsolete.\"cs_item_category\" as \"cs_item_category\",
    obsolete.\"cs_item_class\" as \"cs_item_class\",
    obsolete.\"cs_item_current_price\" as \"cs_item_current_price\",
    obsolete.\"cs_item_desc\" as \"cs_item_desc\",
    obsolete.\"cs_item_name\" as \"cs_item_name\",
    obsolete.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    boa.\"_virtual_364582426434762\" * 100.0 / obsolete.\"_virtual_503034876863510\" as \"revenue_ratio\"
FROM
    boa
    INNER JOIN obsolete on (boa.\"cs_item_category\" = obsolete.\"cs_item_category\" or (boa.\"cs_item_category\" is null and obsolete.\"cs_item_category\" is null)) AND (boa.\"cs_item_class\" = obsolete.\"cs_item_class\" or (boa.\"cs_item_class\" is null and obsolete.\"cs_item_class\" is null)) AND (boa.\"cs_item_current_price\" = obsolete.\"cs_item_current_price\" or (boa.\"cs_item_current_price\" is null and obsolete.\"cs_item_current_price\" is null)) AND (boa.\"cs_item_desc\" = obsolete.\"cs_item_desc\" or (boa.\"cs_item_desc\" is null and obsolete.\"cs_item_desc\" is null)) AND boa.\"cs_item_name\" = obsolete.\"cs_item_name\"
WHERE
    obsolete.\"cs_item_category\" in ( 'Sports','Books','Home' ) and obsolete.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and obsolete.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
),
macho as (
SELECT
    jackdaw.\"cs_item_category\" as \"cs_item_category\",
    jackdaw.\"cs_item_class\" as \"cs_item_class\",
    jackdaw.\"cs_item_current_price\" as \"cs_item_current_price\",
    jackdaw.\"cs_item_desc\" as \"cs_item_desc\",
    jackdaw.\"cs_item_name\" as \"cs_item_name\",
    jackdaw.\"cs_sold_date_date\" as \"cs_sold_date_date\",
    jackdaw.\"revenue_ratio\" as \"revenue_ratio\",
    flamingo.\"revenue\" as \"revenue\"
FROM
    flamingo
    INNER JOIN jackdaw on (flamingo.\"cs_item_category\" = jackdaw.\"cs_item_category\" or (flamingo.\"cs_item_category\" is null and jackdaw.\"cs_item_category\" is null)) AND (flamingo.\"cs_item_class\" = jackdaw.\"cs_item_class\" or (flamingo.\"cs_item_class\" is null and jackdaw.\"cs_item_class\" is null)) AND (flamingo.\"cs_item_current_price\" = jackdaw.\"cs_item_current_price\" or (flamingo.\"cs_item_current_price\" is null and jackdaw.\"cs_item_current_price\" is null)) AND (flamingo.\"cs_item_desc\" = jackdaw.\"cs_item_desc\" or (flamingo.\"cs_item_desc\" is null and jackdaw.\"cs_item_desc\" is null)) AND flamingo.\"cs_item_name\" = jackdaw.\"cs_item_name\"
WHERE
    jackdaw.\"cs_item_category\" in ( 'Sports','Books','Home' ) and jackdaw.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and jackdaw.\"cs_sold_date_date\" <= cast('1999-03-24' as date)
)
SELECT
    macho.\"cs_item_name\" as \"cs_item_name\",
    macho.\"cs_item_desc\" as \"cs_item_desc\",
    macho.\"cs_item_category\" as \"cs_item_category\",
    macho.\"cs_item_class\" as \"cs_item_class\",
    macho.\"cs_item_current_price\" as \"cs_item_current_price\",
    macho.\"revenue\" as \"revenue\",
    macho.\"revenue_ratio\" as \"revenue_ratio\"
FROM
    macho
WHERE
    macho.\"cs_item_category\" in ( 'Sports','Books','Home' ) and macho.\"cs_sold_date_date\" >= cast('1999-02-22' as date) and macho.\"cs_sold_date_date\" <= cast('1999-03-24' as date)

GROUP BY 
    macho.\"cs_item_name\",
    macho.\"cs_item_current_price\",
    macho.\"cs_item_class\",
    macho.\"revenue\",
    macho.\"cs_item_desc\",
    macho.\"revenue_ratio\",
    macho.\"cs_item_category\"
ORDER BY 
    macho.\"cs_item_category\" asc nulls first,
    macho.\"cs_item_class\" asc nulls first,
    macho.\"cs_item_name\" asc nulls first,
    macho.\"cs_item_desc\" asc nulls first,
    macho.\"revenue_ratio\" asc nulls first
LIMIT (100)"""
