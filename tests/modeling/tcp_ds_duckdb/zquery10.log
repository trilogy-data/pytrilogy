{
    "query_id": 10,
    "parse_time": 23.14527,
    "exec_time": 0.428541,
    "comp_time": 0.650745,
    "generated_sql": "\nWITH \nbrave as (\nSELECT\n    web_sales.\"WS_SOLD_DATE_SK\" as \"web_sales_date_id\",\n    web_sales.\"WS_BILL_CUSTOMER_SK\" as \"customer_id\"\nFROM\n    memory.web_sales as web_sales\nGROUP BY \n    web_sales.\"WS_BILL_CUSTOMER_SK\",\n    web_sales.\"WS_SOLD_DATE_SK\"),\ncobra as (\nSELECT\n    date.\"D_DATE_SK\" as \"web_sales_date_id\",\n    brave.\"customer_id\" as \"customer_id\",\n    date.\"D_MOY\" as \"web_sales_date_month_of_year\",\n    cast(\"D_YEAR\" as int) as \"web_sales_date_year\"\nFROM\n    brave\n    LEFT OUTER JOIN memory.date_dim as date on brave.\"web_sales_date_id\" = date.\"D_DATE_SK\"),\nlark as (\nSELECT\n    store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\",\n    store_sales.\"SS_CUSTOMER_SK\" as \"customer_id\"\nFROM\n    memory.store_sales as store_sales\nGROUP BY \n    store_sales.\"SS_SOLD_DATE_SK\",\n    store_sales.\"SS_CUSTOMER_SK\"),\nobsolete as (\nSELECT\n    date.\"D_DATE_SK\" as \"store_sales_date_id\",\n    lark.\"customer_id\" as \"customer_id\",\n    date.\"D_MOY\" as \"store_sales_date_month_of_year\",\n    cast(\"D_YEAR\" as int) as \"store_sales_date_year\"\nFROM\n    lark\n    LEFT OUTER JOIN memory.date_dim as date on lark.\"store_sales_date_id\" = date.\"D_DATE_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2002 and date.\"D_MOY\" in ( 1,2,3,4 )\n),\nquetzal as (\nSELECT\n    customers.\"C_CURRENT_ADDR_SK\" as \"customer_address_id\",\n    customer_address.\"CA_COUNTY\" as \"customer_county\",\n    customers.\"C_CUSTOMER_SK\" as \"customer_id\"\nFROM\n    memory.customer as customers\n    LEFT OUTER JOIN memory.customer_address as customer_address on customers.\"C_CURRENT_ADDR_SK\" = customer_address.\"CA_ADDRESS_SK\"\nWHERE\n    customer_address.\"CA_COUNTY\" in ( 'Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County' )\n),\nalbatross as (\nSELECT\n    catalog_sales.\"CS_SOLD_DATE_SK\" as \"catalog_sales_date_id\",\n    catalog_sales.\"CS_SHIP_CUSTOMER_SK\" as \"customer_id\"\nFROM\n    memory.catalog_sales as catalog_sales\nGROUP BY \n    catalog_sales.\"CS_SHIP_CUSTOMER_SK\",\n    catalog_sales.\"CS_SOLD_DATE_SK\"),\nwakeful as (\nSELECT\n    date.\"D_DATE_SK\" as \"catalog_sales_date_id\",\n    date.\"D_MOY\" as \"catalog_sales_date_month_of_year\",\n    cast(\"D_YEAR\" as int) as \"catalog_sales_date_year\",\n    albatross.\"customer_id\" as \"customer_id\"\nFROM\n    albatross\n    LEFT OUTER JOIN memory.date_dim as date on albatross.\"catalog_sales_date_id\" = date.\"D_DATE_SK\"),\nwarbler as (\nSELECT\n    quetzal.\"customer_id\" as \"relevant_customers\"\nFROM\n    quetzal\n    LEFT OUTER JOIN wakeful on quetzal.\"customer_id\" = wakeful.\"customer_id\"\n    LEFT OUTER JOIN obsolete on quetzal.\"customer_id\" = obsolete.\"customer_id\"\n    LEFT OUTER JOIN cobra on quetzal.\"customer_id\" = cobra.\"customer_id\"\nWHERE\n    obsolete.\"store_sales_date_year\" = 2002 and obsolete.\"store_sales_date_month_of_year\" in ( 1,2,3,4 ) and ( ( cobra.\"web_sales_date_year\" = 2002 and cobra.\"web_sales_date_month_of_year\" in ( 1,2,3,4 ) ) or ( wakeful.\"catalog_sales_date_year\" = 2002 and wakeful.\"catalog_sales_date_month_of_year\" in ( 1,2,3,4 ) ) ) and quetzal.\"customer_county\" in ( 'Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County' )\n\nGROUP BY \n    quetzal.\"customer_id\"),\nray as (\nSELECT\n    warbler.\"relevant_customers\" as \"relevant_customers\"\nFROM\n    warbler\nGROUP BY \n    warbler.\"relevant_customers\"),\nleopard as (\nSELECT\n    customers.\"C_CUSTOMER_SK\" as \"customer_id\",\n    customers.\"C_CURRENT_CDEMO_SK\" as \"customer_demographics_id\",\n    customer_demographics.\"CD_GENDER\" as \"customer_demographics_gender\",\n    customer_demographics.\"CD_MARITAL_STATUS\" as \"customer_demographics_marital_status\",\n    customer_demographics.\"CD_EDUCATION_STATUS\" as \"customer_demographics_education_status\",\n    customer_demographics.\"CD_PURCHASE_ESTIMATE\" as \"customer_demographics_purchase_estimate\",\n    customer_demographics.\"CD_CREDIT_RATING\" as \"customer_demographics_credit_rating\",\n    customer_demographics.\"CD_DEP_COUNT\" as \"customer_demographics_dependent_count\",\n    customer_demographics.\"CD_DEP_EMPLOYED_COUNT\" as \"customer_demographics_employed_dependent_count\",\n    customer_demographics.\"CD_DEP_COLLEGE_COUNT\" as \"customer_demographics_college_dependent_count\"\nFROM\n    memory.customer as customers\n    LEFT OUTER JOIN memory.customer_demographics as customer_demographics on customers.\"C_CURRENT_CDEMO_SK\" = customer_demographics.\"CD_DEMO_SK\"\nWHERE\n    customers.\"C_CUSTOMER_SK\" in (select ray.\"relevant_customers\" from ray where ray.\"relevant_customers\" is not null)\n),\nocelot as (\nSELECT\n    leopard.\"customer_id\" as \"base_customer_id\",\n    leopard.\"customer_demographics_id\" as \"base_customer_demographics_id\",\n    leopard.\"customer_demographics_gender\" as \"base_customer_demographics_gender\",\n    leopard.\"customer_demographics_marital_status\" as \"base_customer_demographics_marital_status\",\n    leopard.\"customer_demographics_education_status\" as \"base_customer_demographics_education_status\",\n    leopard.\"customer_demographics_purchase_estimate\" as \"base_customer_demographics_purchase_estimate\",\n    leopard.\"customer_demographics_credit_rating\" as \"base_customer_demographics_credit_rating\",\n    leopard.\"customer_demographics_dependent_count\" as \"base_customer_demographics_dependent_count\",\n    leopard.\"customer_demographics_employed_dependent_count\" as \"base_customer_demographics_employed_dependent_count\",\n    leopard.\"customer_demographics_college_dependent_count\" as \"base_customer_demographics_college_dependent_count\"\nFROM\n    leopard),\nblue as (\nSELECT\n    count(ocelot.\"base_customer_id\") as \"cnt6\",\n    ocelot.\"base_customer_demographics_college_dependent_count\" as \"base_customer_demographics_college_dependent_count\",\n    ocelot.\"base_customer_demographics_credit_rating\" as \"base_customer_demographics_credit_rating\",\n    ocelot.\"base_customer_demographics_dependent_count\" as \"base_customer_demographics_dependent_count\",\n    ocelot.\"base_customer_demographics_education_status\" as \"base_customer_demographics_education_status\",\n    ocelot.\"base_customer_demographics_employed_dependent_count\" as \"base_customer_demographics_employed_dependent_count\",\n    ocelot.\"base_customer_demographics_gender\" as \"base_customer_demographics_gender\",\n    ocelot.\"base_customer_demographics_marital_status\" as \"base_customer_demographics_marital_status\",\n    ocelot.\"base_customer_demographics_purchase_estimate\" as \"base_customer_demographics_purchase_estimate\",\n    count(ocelot.\"base_customer_id\") as \"cnt5\",\n    count(ocelot.\"base_customer_id\") as \"cnt4\",\n    count(ocelot.\"base_customer_id\") as \"cnt3\",\n    count(ocelot.\"base_customer_id\") as \"cnt2\",\n    count(ocelot.\"base_customer_id\") as \"cnt1\"\nFROM\n    ocelot\nWHERE\n    ocelot.\"base_customer_demographics_gender\" is not null\n\nGROUP BY \n    ocelot.\"base_customer_demographics_dependent_count\",\n    ocelot.\"base_customer_demographics_credit_rating\",\n    ocelot.\"base_customer_demographics_purchase_estimate\",\n    ocelot.\"base_customer_demographics_employed_dependent_count\",\n    ocelot.\"base_customer_demographics_marital_status\",\n    ocelot.\"base_customer_demographics_education_status\",\n    ocelot.\"base_customer_demographics_gender\",\n    ocelot.\"base_customer_demographics_college_dependent_count\")\nSELECT\n    blue.\"base_customer_demographics_gender\" as \"base_customer_demographics_gender\",\n    blue.\"base_customer_demographics_marital_status\" as \"base_customer_demographics_marital_status\",\n    blue.\"base_customer_demographics_education_status\" as \"base_customer_demographics_education_status\",\n    blue.\"cnt1\" as \"cnt1\",\n    blue.\"base_customer_demographics_purchase_estimate\" as \"base_customer_demographics_purchase_estimate\",\n    blue.\"cnt2\" as \"cnt2\",\n    blue.\"base_customer_demographics_credit_rating\" as \"base_customer_demographics_credit_rating\",\n    blue.\"cnt3\" as \"cnt3\",\n    blue.\"base_customer_demographics_dependent_count\" as \"base_customer_demographics_dependent_count\",\n    blue.\"cnt4\" as \"cnt4\",\n    blue.\"base_customer_demographics_employed_dependent_count\" as \"base_customer_demographics_employed_dependent_count\",\n    blue.\"cnt5\" as \"cnt5\",\n    blue.\"base_customer_demographics_college_dependent_count\" as \"base_customer_demographics_college_dependent_count\",\n    blue.\"cnt6\" as \"cnt6\"\nFROM\n    blue\nORDER BY \n    blue.\"base_customer_demographics_gender\" asc,\n    blue.\"base_customer_demographics_marital_status\" asc,\n    blue.\"base_customer_demographics_education_status\" asc,\n    blue.\"base_customer_demographics_purchase_estimate\" asc,\n    blue.\"base_customer_demographics_credit_rating\" asc,\n    blue.\"base_customer_demographics_dependent_count\" asc,\n    blue.\"base_customer_demographics_employed_dependent_count\" asc,\n    blue.\"base_customer_demographics_college_dependent_count\" asc"
}