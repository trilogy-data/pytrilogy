query_id = 21
parse_time = 4.128323
exec_time = 0.275468
comp_time = 0.073034
gen_length = 4894
generated_sql = """

WITH 
fossa as (
SELECT
    warehouse_inventory.\"inv_item_sk\" as \"inventory_item_id\",
    warehouse_inventory.\"inv_date_sk\" as \"inventory_date_id\",
    items.\"I_ITEM_ID\" as \"inventory_item_name\",
    warehouse_inventory.\"inv_quantity_on_hand\" as \"inventory_quantity_on_hand\",
    warehouse_inventory.\"inv_warehouse_sk\" as \"inventory_warehouse_id\"
FROM
    memory.inventory as warehouse_inventory
    INNER JOIN memory.item as items on warehouse_inventory.\"inv_item_sk\" = items.\"I_ITEM_SK\"),
sweltering as (
SELECT
    warehouse_inventory.\"inv_warehouse_sk\" as \"inventory_warehouse_id\",
    warehouse_inventory.\"inv_date_sk\" as \"inventory_date_id\",
    warehouse_inventory.\"inv_item_sk\" as \"inventory_item_id\",
    warehouse.\"w_warehouse_name\" as \"inventory_warehouse_name\"
FROM
    memory.inventory as warehouse_inventory
    LEFT OUTER JOIN memory.warehouse as warehouse on warehouse_inventory.\"inv_warehouse_sk\" = warehouse.\"w_warehouse_sk\"),
yellow as (
SELECT
    cast(\"D_DATE\" as date) as \"inventory_date_date\",
    fossa.\"inventory_quantity_on_hand\" as \"inventory_quantity_on_hand\",
    warehouse.\"w_warehouse_name\" as \"inventory_warehouse_name\",
    fossa.\"inventory_item_name\" as \"inventory_item_name\",
    date.\"D_DATE_SK\" as \"inventory_date_id\",
    fossa.\"inventory_warehouse_id\" as \"inventory_warehouse_id\"
FROM
    fossa
    INNER JOIN memory.date_dim as date on fossa.\"inventory_date_id\" = date.\"D_DATE_SK\"
    LEFT OUTER JOIN memory.warehouse as warehouse on fossa.\"inventory_warehouse_id\" = warehouse.\"w_warehouse_sk\"
WHERE
    cast(\"D_DATE\" as date) >= cast('2000-02-10' as date) and cast(\"D_DATE\" as date) <= cast('2000-04-10' as date)
),
snipe as (
SELECT
    sweltering.\"inventory_warehouse_name\" as \"inventory_warehouse_name\",
    items.\"I_ITEM_ID\" as \"inventory_item_name\",
    items.\"I_CURRENT_PRICE\" as \"inventory_item_current_price\",
    cast(\"D_DATE\" as date) as \"inventory_date_date\"
FROM
    sweltering
    INNER JOIN memory.date_dim as date on sweltering.\"inventory_date_id\" = date.\"D_DATE_SK\"
    INNER JOIN memory.item as items on sweltering.\"inventory_item_id\" = items.\"I_ITEM_SK\"
WHERE
    cast(\"D_DATE\" as date) >= cast('2000-02-10' as date) and cast(\"D_DATE\" as date) <= cast('2000-04-10' as date) and items.\"I_CURRENT_PRICE\" >= 0.99 and items.\"I_CURRENT_PRICE\" <= 1.49
),
odd as (
SELECT
    sum(CASE
	WHEN yellow.\"inventory_date_date\" < cast('2000-03-11' as date) THEN yellow.\"inventory_quantity_on_hand\"
	ELSE 0
	END) as \"inv_before\",
    yellow.\"inventory_warehouse_name\" as \"inventory_warehouse_name\",
    yellow.\"inventory_item_name\" as \"inventory_item_name\",
    sum(CASE
	WHEN yellow.\"inventory_date_date\" >= cast('2000-03-11' as date) THEN yellow.\"inventory_quantity_on_hand\"
	ELSE 0
	END) as \"inv_after\"
FROM
    yellow
GROUP BY 
    yellow.\"inventory_item_name\",
    yellow.\"inventory_warehouse_name\"),
quetzal as (
SELECT
    snipe.\"inventory_warehouse_name\" as \"inventory_warehouse_name\",
    snipe.\"inventory_item_name\" as \"inventory_item_name\",
    snipe.\"inventory_item_current_price\" as \"inventory_item_current_price\",
    snipe.\"inventory_date_date\" as \"inventory_date_date\",
    odd.\"inv_before\" as \"inv_before\",
    odd.\"inv_after\" as \"inv_after\"
FROM
    snipe
    LEFT OUTER JOIN odd on (snipe.\"inventory_warehouse_name\" = odd.\"inventory_warehouse_name\" or (snipe.\"inventory_warehouse_name\" is null and odd.\"inventory_warehouse_name\" is null)) AND snipe.\"inventory_item_name\" = odd.\"inventory_item_name\"
WHERE
    CASE
	WHEN odd.\"inv_before\" > 0 THEN odd.\"inv_after\" * 1.0 / odd.\"inv_before\"
	ELSE null
	END >= 2.0 / 3.0 and CASE
	WHEN odd.\"inv_before\" > 0 THEN odd.\"inv_after\" * 1.0 / odd.\"inv_before\"
	ELSE null
	END <= 3.0 / 2.0 and snipe.\"inventory_date_date\" >= cast('2000-02-10' as date) and snipe.\"inventory_date_date\" <= cast('2000-04-10' as date) and snipe.\"inventory_item_current_price\" >= 0.99 and snipe.\"inventory_item_current_price\" <= 1.49
)
SELECT
    quetzal.\"inventory_warehouse_name\" as \"inventory_warehouse_name\",
    quetzal.\"inventory_item_name\" as \"inventory_item_name\",
    quetzal.\"inv_before\" as \"inv_before\",
    quetzal.\"inv_after\" as \"inv_after\"
FROM
    quetzal
WHERE
    CASE
	WHEN quetzal.\"inv_before\" > 0 THEN quetzal.\"inv_after\" * 1.0 / quetzal.\"inv_before\"
	ELSE null
	END >= 2.0 / 3.0 and CASE
	WHEN quetzal.\"inv_before\" > 0 THEN quetzal.\"inv_after\" * 1.0 / quetzal.\"inv_before\"
	ELSE null
	END <= 3.0 / 2.0 and quetzal.\"inventory_date_date\" >= cast('2000-02-10' as date) and quetzal.\"inventory_date_date\" <= cast('2000-04-10' as date) and quetzal.\"inventory_item_current_price\" >= 0.99 and quetzal.\"inventory_item_current_price\" <= 1.49

GROUP BY 
    quetzal.\"inv_after\",
    quetzal.\"inv_before\",
    quetzal.\"inventory_item_name\",
    quetzal.\"inventory_warehouse_name\"
ORDER BY 
    quetzal.\"inventory_warehouse_name\" asc nulls first,
    quetzal.\"inventory_item_name\" asc nulls first
LIMIT (100)"""
