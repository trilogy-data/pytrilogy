import catalog_sales as sales;
import item as item;
import date as date;
import time as time;

property<sales.order_number,item.id>.net_loss float;
property<sales.order_number,item.id>.had_return bool;

datasource catalog_returns (
    CR_RETURNED_DATE_SK: date.id,
    CR_RETURNED_TIME_SK: time.id,
    CR_ITEM_SK: item.id,
    CR_ORDER_NUMBER: sales.order_number,
    CR_NET_LOSS: net_loss,
    raw('''true'''): had_return,

)
grain (sales.order_number, item.id)
address memory.catalog_returns
;