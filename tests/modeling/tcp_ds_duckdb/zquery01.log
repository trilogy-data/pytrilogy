{
    "query_id": 1,
    "parse_time": 1.745647,
    "exec_time": 0.367273,
    "comp_time": 0.30448,
    "generated_sql": "\nWITH \nshark as (\nSELECT\n    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",\n    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",\n    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\",\n    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",\n    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",\n    store_returns.\"SR_STORE_SK\" as \"returns_store_id\",\n    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\"\nFROM\n    memory.store_returns as store_returns\n    LEFT OUTER JOIN memory.customer as customers on store_returns.\"SR_CUSTOMER_SK\" = customers.\"C_CUSTOMER_SK\"),\nbear as (\nSELECT\n    shark.\"returns_return_amount\" as \"returns_return_amount_filter_5387963398074161\",\n    shark.\"returns_store_id\" as \"returns_store_id\",\n    shark.\"returns_item_id\" as \"returns_item_id\",\n    shark.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    shark.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"\nFROM\n    shark\n    LEFT OUTER JOIN memory.date_dim as date on shark.\"returns_return_date_id\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.store as store on shark.\"returns_store_id\" = store.\"S_STORE_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2000 and store.\"S_STATE\" = 'TN'\n),\nquail as (\nSELECT\n    sum(bear.\"returns_return_amount_filter_5387963398074161\") as \"total_returns\",\n    bear.\"returns_store_id\" as \"returns_store_id\",\n    bear.\"returns_customer_text_id\" as \"returns_customer_text_id\"\nFROM\n    bear\nGROUP BY \n    bear.\"returns_customer_text_id\",\n    bear.\"returns_store_id\"),\nloon as (\nSELECT\n    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",\n    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",\n    store_returns.\"SR_STORE_SK\" as \"returns_store_id\"\nFROM\n    memory.store_returns as store_returns\nGROUP BY \n    store_returns.\"SR_CUSTOMER_SK\",\n    store_returns.\"SR_STORE_SK\",\n    store_returns.\"SR_RETURNED_DATE_SK\"),\nceaseless as (\nSELECT\n    loon.\"returns_customer_id\" as \"returns_customer_id\",\n    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",\n    loon.\"returns_return_date_id\" as \"returns_return_date_id\",\n    loon.\"returns_store_id\" as \"returns_store_id\"\nFROM\n    loon\n    LEFT OUTER JOIN memory.customer as customers on loon.\"returns_customer_id\" = customers.\"C_CUSTOMER_SK\"),\nwaggish as (\nSELECT\n    ceaseless.\"returns_store_id\" as \"returns_store_id\",\n    ceaseless.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    cast(\"D_YEAR\" as int) as \"returns_return_date_year\"\nFROM\n    ceaseless\n    LEFT OUTER JOIN memory.date_dim as date on ceaseless.\"returns_return_date_id\" = date.\"D_DATE_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2000\n),\nwolverine as (\nSELECT\n    waggish.\"returns_store_id\" as \"returns_store_id\",\n    waggish.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    waggish.\"returns_return_date_year\" as \"returns_return_date_year\",\n    quail.\"total_returns\" as \"total_returns\"\nFROM\n    waggish\n    LEFT OUTER JOIN quail on waggish.\"returns_store_id\" = quail.\"returns_store_id\" AND waggish.\"returns_customer_text_id\" = quail.\"returns_customer_text_id\"\nWHERE\n    waggish.\"returns_return_date_year\" = 2000\n),\nodd as (\nSELECT\n    wolverine.\"returns_return_date_year\" as \"returns_return_date_year\",\n    store.\"S_STATE\" as \"returns_store_state\",\n    wolverine.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    wolverine.\"returns_store_id\" as \"returns_store_id\",\n    wolverine.\"total_returns\" as \"total_returns\"\nFROM\n    wolverine\n    LEFT OUTER JOIN memory.store as store on wolverine.\"returns_store_id\" = store.\"S_STORE_SK\"\nWHERE\n    wolverine.\"returns_return_date_year\" = 2000 and store.\"S_STATE\" = 'TN'\n),\ndarter as (\nSELECT\n    odd.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    odd.\"returns_store_id\" as \"returns_store_id\",\n    odd.\"returns_store_state\" as \"returns_store_state\",\n    odd.\"total_returns\" as \"total_returns\"\nFROM\n    odd\nGROUP BY \n    odd.\"returns_store_id\",\n    odd.\"total_returns\",\n    odd.\"returns_customer_text_id\",\n    odd.\"returns_store_state\"),\nspiritual as (\nSELECT\n    darter.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    darter.\"returns_store_id\" as \"returns_store_id\",\n    darter.\"returns_store_state\" as \"returns_store_state\",\n    darter.\"total_returns\" as \"total_returns\",\n    darter.\"returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",\n    darter.\"returns_store_id\" as \"tn_2000_returns_store_id\",\n    darter.\"returns_store_state\" as \"tn_2000_returns_store_state\",\n    darter.\"total_returns\" as \"tn_2000_total_returns\"\nFROM\n    darter\nGROUP BY \n    darter.\"returns_store_id\",\n    darter.\"returns_customer_text_id\",\n    darter.\"returns_store_state\",\n    darter.\"total_returns\"),\njackal as (\nSELECT\n    avg(spiritual.\"tn_2000_total_returns\") as \"avg_store_returns\",\n    spiritual.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"\nFROM\n    spiritual\nGROUP BY \n    spiritual.\"tn_2000_returns_store_id\"),\nsedate as (\nSELECT\n    spiritual.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\",\n    spiritual.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",\n    jackal.\"avg_store_returns\" as \"avg_store_returns\"\nFROM\n    spiritual\n    LEFT OUTER JOIN jackal on spiritual.\"tn_2000_returns_store_id\" = jackal.\"tn_2000_returns_store_id\"\nWHERE\n    spiritual.\"tn_2000_total_returns\" > ( 1.2 * jackal.\"avg_store_returns\" )\n),\nchicken as (\nSELECT\n    spiritual.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",\n    sedate.\"avg_store_returns\" as \"avg_store_returns\",\n    spiritual.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",\n    spiritual.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"\nFROM\n    spiritual\n    LEFT OUTER JOIN sedate on spiritual.\"tn_2000_returns_store_id\" = sedate.\"tn_2000_returns_store_id\" AND spiritual.\"tn_2000_total_returns\" = sedate.\"tn_2000_total_returns\"\nWHERE\n    spiritual.\"tn_2000_total_returns\" > ( 1.2 * sedate.\"avg_store_returns\" )\n)\nSELECT\n    chicken.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\"\nFROM\n    chicken\nGROUP BY \n    chicken.\"tn_2000_returns_store_id\",\n    chicken.\"tn_2000_returns_customer_text_id\"\nORDER BY \n    chicken.\"tn_2000_returns_customer_text_id\" asc\nLIMIT (100)"
}