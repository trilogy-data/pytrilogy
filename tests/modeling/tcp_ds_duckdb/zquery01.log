query_id = 1
parse_time = 5.720138
exec_time = 0.914975
comp_time = 2.6157
gen_length = 6455
generated_sql = """

WITH 
yellow as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\"
FROM
    memory.store_returns as store_returns
GROUP BY 
    store_returns.\"SR_CUSTOMER_SK\",
    store_returns.\"SR_RETURNED_DATE_SK\",
    store_returns.\"SR_STORE_SK\"),
waggish as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\",
    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\",
    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\"
FROM
    memory.store_returns as store_returns
    INNER JOIN memory.customer as customers on store_returns.\"SR_CUSTOMER_SK\" = customers.\"C_CUSTOMER_SK\"),
nondescript as (
SELECT
    yellow.\"returns_customer_id\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    yellow.\"returns_return_date_id\" as \"returns_return_date_id\",
    yellow.\"returns_store_id\" as \"returns_store_id\"
FROM
    yellow
    INNER JOIN memory.customer as customers on yellow.\"returns_customer_id\" = customers.\"C_CUSTOMER_SK\"),
fabulous as (
SELECT
    waggish.\"returns_return_amount\" as \"returns_return_amount_filter_5387963398074161\",
    waggish.\"returns_store_id\" as \"returns_store_id\",
    waggish.\"returns_item_id\" as \"returns_item_id\",
    waggish.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    waggish.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"
FROM
    waggish
    INNER JOIN memory.date_dim as date on waggish.\"returns_return_date_id\" = date.\"D_DATE_SK\"
    INNER JOIN memory.store as store on waggish.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000 and store.\"S_STATE\" = 'TN'
),
eminent as (
SELECT
    nondescript.\"returns_store_id\" as \"returns_store_id\",
    nondescript.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    cast(\"D_YEAR\" as int) as \"returns_return_date_year\"
FROM
    nondescript
    INNER JOIN memory.date_dim as date on nondescript.\"returns_return_date_id\" = date.\"D_DATE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000
),
vulture as (
SELECT
    sum(fabulous.\"returns_return_amount_filter_5387963398074161\") as \"total_returns\",
    fabulous.\"returns_store_id\" as \"returns_store_id\",
    fabulous.\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    fabulous
GROUP BY 
    fabulous.\"returns_store_id\",
    fabulous.\"returns_customer_text_id\"),
snipe as (
SELECT
    eminent.\"returns_store_id\" as \"returns_store_id\",
    eminent.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    eminent.\"returns_return_date_year\" as \"returns_return_date_year\",
    vulture.\"total_returns\" as \"total_returns\"
FROM
    eminent
    INNER JOIN vulture on eminent.\"returns_store_id\" = vulture.\"returns_store_id\" AND eminent.\"returns_customer_text_id\" = vulture.\"returns_customer_text_id\"
WHERE
    eminent.\"returns_return_date_year\" = 2000
),
faithful as (
SELECT
    snipe.\"returns_return_date_year\" as \"returns_return_date_year\",
    store.\"S_STATE\" as \"returns_store_state\",
    snipe.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    snipe.\"returns_store_id\" as \"returns_store_id\",
    snipe.\"total_returns\" as \"total_returns\"
FROM
    snipe
    INNER JOIN memory.store as store on snipe.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    snipe.\"returns_return_date_year\" = 2000 and store.\"S_STATE\" = 'TN'
),
barracuda as (
SELECT
    faithful.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    faithful.\"returns_store_id\" as \"returns_store_id\",
    faithful.\"returns_store_state\" as \"returns_store_state\",
    faithful.\"total_returns\" as \"total_returns\"
FROM
    faithful
GROUP BY 
    faithful.\"returns_store_state\",
    faithful.\"total_returns\",
    faithful.\"returns_customer_text_id\",
    faithful.\"returns_store_id\"),
boa as (
SELECT
    barracuda.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    barracuda.\"returns_store_id\" as \"returns_store_id\",
    barracuda.\"returns_store_state\" as \"returns_store_state\",
    barracuda.\"total_returns\" as \"total_returns\",
    barracuda.\"returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    barracuda.\"returns_store_id\" as \"tn_2000_returns_store_id\",
    barracuda.\"returns_store_state\" as \"tn_2000_returns_store_state\",
    barracuda.\"total_returns\" as \"tn_2000_total_returns\"
FROM
    barracuda
GROUP BY 
    barracuda.\"returns_customer_text_id\",
    barracuda.\"returns_store_state\",
    barracuda.\"returns_store_id\",
    barracuda.\"total_returns\"),
pelican as (
SELECT
    avg(boa.\"tn_2000_total_returns\") as \"avg_store_returns\",
    boa.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    boa
GROUP BY 
    boa.\"tn_2000_returns_store_id\"),
ray as (
SELECT
    boa.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\",
    boa.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    pelican.\"avg_store_returns\" as \"avg_store_returns\"
FROM
    boa
    LEFT OUTER JOIN pelican on (boa.\"tn_2000_returns_store_id\" = pelican.\"tn_2000_returns_store_id\" or (boa.\"tn_2000_returns_store_id\" is null and pelican.\"tn_2000_returns_store_id\" is null))
WHERE
    boa.\"tn_2000_total_returns\" > ( 1.2 * pelican.\"avg_store_returns\" )
),
ugly as (
SELECT
    boa.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    ray.\"avg_store_returns\" as \"avg_store_returns\",
    boa.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    boa.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    boa
    LEFT OUTER JOIN ray on (boa.\"tn_2000_returns_store_id\" = ray.\"tn_2000_returns_store_id\" or (boa.\"tn_2000_returns_store_id\" is null and ray.\"tn_2000_returns_store_id\" is null)) AND (boa.\"tn_2000_total_returns\" = ray.\"tn_2000_total_returns\" or (boa.\"tn_2000_total_returns\" is null and ray.\"tn_2000_total_returns\" is null))
WHERE
    boa.\"tn_2000_total_returns\" > ( 1.2 * ray.\"avg_store_returns\" )
)
SELECT
    ugly.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\"
FROM
    ugly
GROUP BY 
    ugly.\"tn_2000_returns_store_id\",
    ugly.\"tn_2000_returns_customer_text_id\"
ORDER BY 
    ugly.\"tn_2000_returns_customer_text_id\" asc
LIMIT (100)"""
