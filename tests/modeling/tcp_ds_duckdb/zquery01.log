query_id = 1
parse_time = 2.59572
exec_time = 0.446895
comp_time = 1.670444
gen_length = 6461
generated_sql = """

WITH 
ocelot as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\"
FROM
    memory.store_returns as store_returns
GROUP BY 
    store_returns.\"SR_CUSTOMER_SK\",
    store_returns.\"SR_STORE_SK\",
    store_returns.\"SR_RETURNED_DATE_SK\"),
dove as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\",
    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\",
    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\"
FROM
    memory.store_returns as store_returns
    INNER JOIN memory.customer as customers on store_returns.\"SR_CUSTOMER_SK\" = customers.\"C_CUSTOMER_SK\"),
juicy as (
SELECT
    ocelot.\"returns_customer_id\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    ocelot.\"returns_return_date_id\" as \"returns_return_date_id\",
    ocelot.\"returns_store_id\" as \"returns_store_id\"
FROM
    ocelot
    INNER JOIN memory.customer as customers on ocelot.\"returns_customer_id\" = customers.\"C_CUSTOMER_SK\"),
stork as (
SELECT
    dove.\"returns_return_amount\" as \"returns_return_amount_filter_5387963398074161\",
    dove.\"returns_store_id\" as \"returns_store_id\",
    dove.\"returns_item_id\" as \"returns_item_id\",
    dove.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    dove.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"
FROM
    dove
    INNER JOIN memory.date_dim as date on dove.\"returns_return_date_id\" = date.\"D_DATE_SK\"
    INNER JOIN memory.store as store on dove.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000 and store.\"S_STATE\" = 'TN'
),
concerned as (
SELECT
    juicy.\"returns_store_id\" as \"returns_store_id\",
    juicy.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    cast(\"D_YEAR\" as int) as \"returns_return_date_year\"
FROM
    juicy
    INNER JOIN memory.date_dim as date on juicy.\"returns_return_date_id\" = date.\"D_DATE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000
),
viper as (
SELECT
    sum(stork.\"returns_return_amount_filter_5387963398074161\") as \"total_returns\",
    stork.\"returns_store_id\" as \"returns_store_id\",
    stork.\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    stork
GROUP BY 
    stork.\"returns_customer_text_id\",
    stork.\"returns_store_id\"),
brave as (
SELECT
    concerned.\"returns_store_id\" as \"returns_store_id\",
    concerned.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    concerned.\"returns_return_date_year\" as \"returns_return_date_year\",
    viper.\"total_returns\" as \"total_returns\"
FROM
    concerned
    INNER JOIN viper on concerned.\"returns_store_id\" = viper.\"returns_store_id\" AND concerned.\"returns_customer_text_id\" = viper.\"returns_customer_text_id\"
WHERE
    concerned.\"returns_return_date_year\" = 2000
),
abhorrent as (
SELECT
    brave.\"returns_return_date_year\" as \"returns_return_date_year\",
    store.\"S_STATE\" as \"returns_store_state\",
    brave.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    brave.\"returns_store_id\" as \"returns_store_id\",
    brave.\"total_returns\" as \"total_returns\"
FROM
    brave
    INNER JOIN memory.store as store on brave.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    brave.\"returns_return_date_year\" = 2000 and store.\"S_STATE\" = 'TN'
),
kestrel as (
SELECT
    abhorrent.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    abhorrent.\"returns_store_id\" as \"returns_store_id\",
    abhorrent.\"returns_store_state\" as \"returns_store_state\",
    abhorrent.\"total_returns\" as \"total_returns\"
FROM
    abhorrent
GROUP BY 
    abhorrent.\"total_returns\",
    abhorrent.\"returns_customer_text_id\",
    abhorrent.\"returns_store_state\",
    abhorrent.\"returns_store_id\"),
warbler as (
SELECT
    kestrel.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    kestrel.\"returns_store_id\" as \"returns_store_id\",
    kestrel.\"returns_store_state\" as \"returns_store_state\",
    kestrel.\"total_returns\" as \"total_returns\",
    kestrel.\"returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    kestrel.\"returns_store_id\" as \"tn_2000_returns_store_id\",
    kestrel.\"returns_store_state\" as \"tn_2000_returns_store_state\",
    kestrel.\"total_returns\" as \"tn_2000_total_returns\"
FROM
    kestrel
GROUP BY 
    kestrel.\"total_returns\",
    kestrel.\"returns_store_state\",
    kestrel.\"returns_customer_text_id\",
    kestrel.\"returns_store_id\"),
chick as (
SELECT
    avg(warbler.\"tn_2000_total_returns\") as \"avg_store_returns\",
    warbler.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    warbler
GROUP BY 
    warbler.\"tn_2000_returns_store_id\"),
puffy as (
SELECT
    warbler.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\",
    warbler.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    chick.\"avg_store_returns\" as \"avg_store_returns\"
FROM
    warbler
    LEFT OUTER JOIN chick on (warbler.\"tn_2000_returns_store_id\" = chick.\"tn_2000_returns_store_id\" or (warbler.\"tn_2000_returns_store_id\" is null and chick.\"tn_2000_returns_store_id\" is null))
WHERE
    warbler.\"tn_2000_total_returns\" > ( 1.2 * chick.\"avg_store_returns\" )
),
serval as (
SELECT
    warbler.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    puffy.\"avg_store_returns\" as \"avg_store_returns\",
    warbler.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    warbler.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    warbler
    LEFT OUTER JOIN puffy on (warbler.\"tn_2000_returns_store_id\" = puffy.\"tn_2000_returns_store_id\" or (warbler.\"tn_2000_returns_store_id\" is null and puffy.\"tn_2000_returns_store_id\" is null)) AND (warbler.\"tn_2000_total_returns\" = puffy.\"tn_2000_total_returns\" or (warbler.\"tn_2000_total_returns\" is null and puffy.\"tn_2000_total_returns\" is null))
WHERE
    warbler.\"tn_2000_total_returns\" > ( 1.2 * puffy.\"avg_store_returns\" )
)
SELECT
    serval.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\"
FROM
    serval
GROUP BY 
    serval.\"tn_2000_returns_store_id\",
    serval.\"tn_2000_returns_customer_text_id\"
ORDER BY 
    serval.\"tn_2000_returns_customer_text_id\" asc
LIMIT (100)"""
