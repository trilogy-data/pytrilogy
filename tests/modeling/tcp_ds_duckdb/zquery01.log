query_id = 1
parse_time = 2.484258
exec_time = 0.300612
comp_time = 2.308146
gen_length = 6263
generated_sql = """

WITH 
helpless as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\"
FROM
    memory.store_returns as store_returns
GROUP BY 
    store_returns.\"SR_STORE_SK\",
    store_returns.\"SR_CUSTOMER_SK\",
    store_returns.\"SR_RETURNED_DATE_SK\"),
canary as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\",
    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\",
    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\"
FROM
    memory.store_returns as store_returns
    LEFT OUTER JOIN memory.customer as customers on store_returns.\"SR_CUSTOMER_SK\" = customers.\"C_CUSTOMER_SK\"),
warbler as (
SELECT
    helpless.\"returns_customer_id\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    helpless.\"returns_return_date_id\" as \"returns_return_date_id\",
    helpless.\"returns_store_id\" as \"returns_store_id\"
FROM
    helpless
    LEFT OUTER JOIN memory.customer as customers on helpless.\"returns_customer_id\" = customers.\"C_CUSTOMER_SK\"),
duck as (
SELECT
    canary.\"returns_return_amount\" as \"returns_return_amount_filter_5387963398074161\",
    canary.\"returns_store_id\" as \"returns_store_id\",
    canary.\"returns_item_id\" as \"returns_item_id\",
    canary.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    canary.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"
FROM
    canary
    LEFT OUTER JOIN memory.date_dim as date on canary.\"returns_return_date_id\" = date.\"D_DATE_SK\"
    LEFT OUTER JOIN memory.store as store on canary.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000 and store.\"S_STATE\" = 'TN'
),
swallow as (
SELECT
    warbler.\"returns_store_id\" as \"returns_store_id\",
    warbler.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    cast(\"D_YEAR\" as int) as \"returns_return_date_year\"
FROM
    warbler
    LEFT OUTER JOIN memory.date_dim as date on warbler.\"returns_return_date_id\" = date.\"D_DATE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000
),
budgie as (
SELECT
    sum(duck.\"returns_return_amount_filter_5387963398074161\") as \"total_returns\",
    duck.\"returns_store_id\" as \"returns_store_id\",
    duck.\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    duck
GROUP BY 
    duck.\"returns_store_id\",
    duck.\"returns_customer_text_id\"),
lynx as (
SELECT
    swallow.\"returns_store_id\" as \"returns_store_id\",
    swallow.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    swallow.\"returns_return_date_year\" as \"returns_return_date_year\",
    budgie.\"total_returns\" as \"total_returns\"
FROM
    swallow
    LEFT OUTER JOIN budgie on swallow.\"returns_store_id\" = budgie.\"returns_store_id\" AND swallow.\"returns_customer_text_id\" = budgie.\"returns_customer_text_id\"
WHERE
    swallow.\"returns_return_date_year\" = 2000
),
puzzled as (
SELECT
    lynx.\"returns_return_date_year\" as \"returns_return_date_year\",
    store.\"S_STATE\" as \"returns_store_state\",
    lynx.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    lynx.\"returns_store_id\" as \"returns_store_id\",
    lynx.\"total_returns\" as \"total_returns\"
FROM
    lynx
    LEFT OUTER JOIN memory.store as store on lynx.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    lynx.\"returns_return_date_year\" = 2000 and store.\"S_STATE\" = 'TN'
),
yummy as (
SELECT
    puzzled.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    puzzled.\"returns_store_id\" as \"returns_store_id\",
    puzzled.\"returns_store_state\" as \"returns_store_state\",
    puzzled.\"total_returns\" as \"total_returns\"
FROM
    puzzled
GROUP BY 
    puzzled.\"returns_customer_text_id\",
    puzzled.\"returns_store_id\",
    puzzled.\"returns_store_state\",
    puzzled.\"total_returns\"),
cooperative as (
SELECT
    yummy.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    yummy.\"returns_store_id\" as \"returns_store_id\",
    yummy.\"returns_store_state\" as \"returns_store_state\",
    yummy.\"total_returns\" as \"total_returns\",
    yummy.\"returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    yummy.\"returns_store_id\" as \"tn_2000_returns_store_id\",
    yummy.\"returns_store_state\" as \"tn_2000_returns_store_state\",
    yummy.\"total_returns\" as \"tn_2000_total_returns\"
FROM
    yummy
GROUP BY 
    yummy.\"returns_customer_text_id\",
    yummy.\"returns_store_id\",
    yummy.\"total_returns\",
    yummy.\"returns_store_state\"),
fossa as (
SELECT
    avg(cooperative.\"tn_2000_total_returns\") as \"avg_store_returns\",
    cooperative.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    cooperative
GROUP BY 
    cooperative.\"tn_2000_returns_store_id\"),
flamingo as (
SELECT
    cooperative.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\",
    cooperative.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    fossa.\"avg_store_returns\" as \"avg_store_returns\"
FROM
    cooperative
    LEFT OUTER JOIN fossa on cooperative.\"tn_2000_returns_store_id\" = fossa.\"tn_2000_returns_store_id\"
WHERE
    cooperative.\"tn_2000_total_returns\" > ( 1.2 * fossa.\"avg_store_returns\" )
),
civet as (
SELECT
    cooperative.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    flamingo.\"avg_store_returns\" as \"avg_store_returns\",
    cooperative.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    cooperative.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    cooperative
    LEFT OUTER JOIN flamingo on cooperative.\"tn_2000_returns_store_id\" = flamingo.\"tn_2000_returns_store_id\" AND cooperative.\"tn_2000_total_returns\" = flamingo.\"tn_2000_total_returns\"
WHERE
    cooperative.\"tn_2000_total_returns\" > ( 1.2 * flamingo.\"avg_store_returns\" )
)
SELECT
    civet.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\"
FROM
    civet
GROUP BY 
    civet.\"tn_2000_returns_store_id\",
    civet.\"tn_2000_returns_customer_text_id\"
ORDER BY 
    civet.\"tn_2000_returns_customer_text_id\" asc
LIMIT (100)"""
