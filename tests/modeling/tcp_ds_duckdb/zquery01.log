{
    "query_id": 1,
    "parse_time": 5.202418,
    "exec_time": 0.50436,
    "comp_time": 1.517544,
    "generated_sql": "\nWITH \nvulture as (\nSELECT\n    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",\n    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",\n    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\",\n    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",\n    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",\n    store_returns.\"SR_STORE_SK\" as \"returns_store_id\",\n    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\"\nFROM\n    memory.store_returns as store_returns\n    LEFT OUTER JOIN memory.customer as customers on store_returns.\"SR_CUSTOMER_SK\" = customers.\"C_CUSTOMER_SK\"),\nhard as (\nSELECT\n    vulture.\"returns_return_amount\" as \"returns_return_amount_filter_5387963398074161\",\n    vulture.\"returns_store_id\" as \"returns_store_id\",\n    vulture.\"returns_item_id\" as \"returns_item_id\",\n    vulture.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    vulture.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"\nFROM\n    vulture\n    LEFT OUTER JOIN memory.date_dim as date on vulture.\"returns_return_date_id\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.store as store on vulture.\"returns_store_id\" = store.\"S_STORE_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2000 and store.\"S_STATE\" = 'TN'\n),\ntoucan as (\nSELECT\n    sum(hard.\"returns_return_amount_filter_5387963398074161\") as \"total_returns\",\n    hard.\"returns_store_id\" as \"returns_store_id\",\n    hard.\"returns_customer_text_id\" as \"returns_customer_text_id\"\nFROM\n    hard\nGROUP BY \n    hard.\"returns_store_id\",\n    hard.\"returns_customer_text_id\"),\nprotective as (\nSELECT\n    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",\n    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",\n    store_returns.\"SR_STORE_SK\" as \"returns_store_id\"\nFROM\n    memory.store_returns as store_returns\nGROUP BY \n    store_returns.\"SR_RETURNED_DATE_SK\",\n    store_returns.\"SR_STORE_SK\",\n    store_returns.\"SR_CUSTOMER_SK\"),\neminent as (\nSELECT\n    protective.\"returns_customer_id\" as \"returns_customer_id\",\n    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",\n    protective.\"returns_return_date_id\" as \"returns_return_date_id\",\n    protective.\"returns_store_id\" as \"returns_store_id\"\nFROM\n    protective\n    LEFT OUTER JOIN memory.customer as customers on protective.\"returns_customer_id\" = customers.\"C_CUSTOMER_SK\"),\njackal as (\nSELECT\n    eminent.\"returns_store_id\" as \"returns_store_id\",\n    eminent.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    cast(\"D_YEAR\" as int) as \"returns_return_date_year\"\nFROM\n    eminent\n    LEFT OUTER JOIN memory.date_dim as date on eminent.\"returns_return_date_id\" = date.\"D_DATE_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2000\n),\ndivergent as (\nSELECT\n    jackal.\"returns_store_id\" as \"returns_store_id\",\n    jackal.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    jackal.\"returns_return_date_year\" as \"returns_return_date_year\",\n    toucan.\"total_returns\" as \"total_returns\"\nFROM\n    jackal\n    LEFT OUTER JOIN toucan on jackal.\"returns_store_id\" = toucan.\"returns_store_id\" AND jackal.\"returns_customer_text_id\" = toucan.\"returns_customer_text_id\"\nWHERE\n    jackal.\"returns_return_date_year\" = 2000\n),\ncooperative as (\nSELECT\n    divergent.\"returns_return_date_year\" as \"returns_return_date_year\",\n    store.\"S_STATE\" as \"returns_store_state\",\n    divergent.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    divergent.\"returns_store_id\" as \"returns_store_id\",\n    divergent.\"total_returns\" as \"total_returns\"\nFROM\n    divergent\n    LEFT OUTER JOIN memory.store as store on divergent.\"returns_store_id\" = store.\"S_STORE_SK\"\nWHERE\n    divergent.\"returns_return_date_year\" = 2000 and store.\"S_STATE\" = 'TN'\n),\nquizzical as (\nSELECT\n    cooperative.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    cooperative.\"returns_store_id\" as \"returns_store_id\",\n    cooperative.\"returns_store_state\" as \"returns_store_state\",\n    cooperative.\"total_returns\" as \"total_returns\"\nFROM\n    cooperative\nGROUP BY \n    cooperative.\"returns_store_state\",\n    cooperative.\"total_returns\",\n    cooperative.\"returns_customer_text_id\",\n    cooperative.\"returns_store_id\"),\nparakeet as (\nSELECT\n    quizzical.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    quizzical.\"returns_store_id\" as \"returns_store_id\",\n    quizzical.\"returns_store_state\" as \"returns_store_state\",\n    quizzical.\"total_returns\" as \"total_returns\",\n    quizzical.\"returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",\n    quizzical.\"returns_store_id\" as \"tn_2000_returns_store_id\",\n    quizzical.\"returns_store_state\" as \"tn_2000_returns_store_state\",\n    quizzical.\"total_returns\" as \"tn_2000_total_returns\"\nFROM\n    quizzical\nGROUP BY \n    quizzical.\"total_returns\",\n    quizzical.\"returns_store_state\",\n    quizzical.\"returns_customer_text_id\",\n    quizzical.\"returns_store_id\"),\ncourageous as (\nSELECT\n    avg(parakeet.\"tn_2000_total_returns\") as \"avg_store_returns\",\n    parakeet.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"\nFROM\n    parakeet\nGROUP BY \n    parakeet.\"tn_2000_returns_store_id\"),\ncrocodile as (\nSELECT\n    parakeet.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\",\n    parakeet.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",\n    courageous.\"avg_store_returns\" as \"avg_store_returns\"\nFROM\n    parakeet\n    LEFT OUTER JOIN courageous on parakeet.\"tn_2000_returns_store_id\" = courageous.\"tn_2000_returns_store_id\"\nWHERE\n    parakeet.\"tn_2000_total_returns\" > ( 1.2 * courageous.\"avg_store_returns\" )\n),\nwarbler as (\nSELECT\n    parakeet.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",\n    crocodile.\"avg_store_returns\" as \"avg_store_returns\",\n    parakeet.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",\n    parakeet.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"\nFROM\n    parakeet\n    LEFT OUTER JOIN crocodile on parakeet.\"tn_2000_returns_store_id\" = crocodile.\"tn_2000_returns_store_id\" AND parakeet.\"tn_2000_total_returns\" = crocodile.\"tn_2000_total_returns\"\nWHERE\n    parakeet.\"tn_2000_total_returns\" > ( 1.2 * crocodile.\"avg_store_returns\" )\n)\nSELECT\n    warbler.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\"\nFROM\n    warbler\nGROUP BY \n    warbler.\"tn_2000_returns_store_id\",\n    warbler.\"tn_2000_returns_customer_text_id\"\nORDER BY \n    warbler.\"tn_2000_returns_customer_text_id\" asc\nLIMIT (100)"
}