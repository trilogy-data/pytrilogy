query_id = 1
parse_time = 4.289912
exec_time = 0.489573
comp_time = 2.149838
gen_length = 6521
generated_sql = """

WITH 
vivacious as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\"
FROM
    memory.store_returns as store_returns
GROUP BY 
    store_returns.\"SR_RETURNED_DATE_SK\",
    store_returns.\"SR_CUSTOMER_SK\",
    store_returns.\"SR_STORE_SK\"),
python as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\",
    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\",
    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\"
FROM
    memory.store_returns as store_returns
    INNER JOIN memory.customer as customers on store_returns.\"SR_CUSTOMER_SK\" = customers.\"C_CUSTOMER_SK\"),
skua as (
SELECT
    vivacious.\"returns_customer_id\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    vivacious.\"returns_return_date_id\" as \"returns_return_date_id\",
    vivacious.\"returns_store_id\" as \"returns_store_id\"
FROM
    vivacious
    INNER JOIN memory.customer as customers on vivacious.\"returns_customer_id\" = customers.\"C_CUSTOMER_SK\"),
avocet as (
SELECT
    python.\"returns_return_amount\" as \"returns_return_amount_filter_5387963398074161\",
    python.\"returns_store_id\" as \"returns_store_id\",
    python.\"returns_item_id\" as \"returns_item_id\",
    python.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    python.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"
FROM
    python
    INNER JOIN memory.date_dim as date on python.\"returns_return_date_id\" = date.\"D_DATE_SK\"
    INNER JOIN memory.store as store on python.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000 and store.\"S_STATE\" = 'TN'
),
sordid as (
SELECT
    skua.\"returns_store_id\" as \"returns_store_id\",
    skua.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    cast(\"D_YEAR\" as int) as \"returns_return_date_year\"
FROM
    skua
    INNER JOIN memory.date_dim as date on skua.\"returns_return_date_id\" = date.\"D_DATE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000
),
finch as (
SELECT
    sum(avocet.\"returns_return_amount_filter_5387963398074161\") as \"total_returns\",
    avocet.\"returns_store_id\" as \"returns_store_id\",
    avocet.\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    avocet
GROUP BY 
    avocet.\"returns_store_id\",
    avocet.\"returns_customer_text_id\"),
eagle as (
SELECT
    sordid.\"returns_store_id\" as \"returns_store_id\",
    sordid.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    sordid.\"returns_return_date_year\" as \"returns_return_date_year\",
    finch.\"total_returns\" as \"total_returns\"
FROM
    sordid
    INNER JOIN finch on sordid.\"returns_store_id\" = finch.\"returns_store_id\" AND sordid.\"returns_customer_text_id\" = finch.\"returns_customer_text_id\"
WHERE
    sordid.\"returns_return_date_year\" = 2000
),
ceaseless as (
SELECT
    eagle.\"returns_return_date_year\" as \"returns_return_date_year\",
    store.\"S_STATE\" as \"returns_store_state\",
    eagle.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    eagle.\"returns_store_id\" as \"returns_store_id\",
    eagle.\"total_returns\" as \"total_returns\"
FROM
    eagle
    INNER JOIN memory.store as store on eagle.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    eagle.\"returns_return_date_year\" = 2000 and store.\"S_STATE\" = 'TN'
),
slow as (
SELECT
    ceaseless.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    ceaseless.\"returns_store_id\" as \"returns_store_id\",
    ceaseless.\"returns_store_state\" as \"returns_store_state\",
    ceaseless.\"total_returns\" as \"total_returns\"
FROM
    ceaseless
GROUP BY 
    ceaseless.\"total_returns\",
    ceaseless.\"returns_customer_text_id\",
    ceaseless.\"returns_store_state\",
    ceaseless.\"returns_store_id\"),
ruthless as (
SELECT
    slow.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    slow.\"returns_store_id\" as \"returns_store_id\",
    slow.\"returns_store_state\" as \"returns_store_state\",
    slow.\"total_returns\" as \"total_returns\",
    slow.\"returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    slow.\"returns_store_id\" as \"tn_2000_returns_store_id\",
    slow.\"returns_store_state\" as \"tn_2000_returns_store_state\",
    slow.\"total_returns\" as \"tn_2000_total_returns\"
FROM
    slow
GROUP BY 
    slow.\"returns_store_state\",
    slow.\"returns_store_id\",
    slow.\"total_returns\",
    slow.\"returns_customer_text_id\"),
duck as (
SELECT
    avg(ruthless.\"tn_2000_total_returns\") as \"avg_store_returns\",
    ruthless.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    ruthless
GROUP BY 
    ruthless.\"tn_2000_returns_store_id\"),
questionable as (
SELECT
    ruthless.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\",
    ruthless.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    duck.\"avg_store_returns\" as \"avg_store_returns\"
FROM
    ruthless
    LEFT OUTER JOIN duck on (ruthless.\"tn_2000_returns_store_id\" = duck.\"tn_2000_returns_store_id\" or (ruthless.\"tn_2000_returns_store_id\" is null and duck.\"tn_2000_returns_store_id\" is null))
WHERE
    ruthless.\"tn_2000_total_returns\" > ( 1.2 * duck.\"avg_store_returns\" )
),
barracuda as (
SELECT
    ruthless.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    questionable.\"avg_store_returns\" as \"avg_store_returns\",
    ruthless.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    ruthless.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    ruthless
    LEFT OUTER JOIN questionable on (ruthless.\"tn_2000_returns_store_id\" = questionable.\"tn_2000_returns_store_id\" or (ruthless.\"tn_2000_returns_store_id\" is null and questionable.\"tn_2000_returns_store_id\" is null)) AND (ruthless.\"tn_2000_total_returns\" = questionable.\"tn_2000_total_returns\" or (ruthless.\"tn_2000_total_returns\" is null and questionable.\"tn_2000_total_returns\" is null))
WHERE
    ruthless.\"tn_2000_total_returns\" > ( 1.2 * questionable.\"avg_store_returns\" )
)
SELECT
    barracuda.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\"
FROM
    barracuda
GROUP BY 
    barracuda.\"tn_2000_returns_customer_text_id\",
    barracuda.\"tn_2000_returns_store_id\"
ORDER BY 
    barracuda.\"tn_2000_returns_customer_text_id\" asc
LIMIT (100)"""
