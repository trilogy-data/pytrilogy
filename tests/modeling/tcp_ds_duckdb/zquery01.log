query_id = 1
parse_time = 4.96502
exec_time = 0.585224
comp_time = 2.609874
gen_length = 6509
generated_sql = """

WITH 
ray as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\"
FROM
    memory.store_returns as store_returns
GROUP BY 
    store_returns.\"SR_CUSTOMER_SK\",
    store_returns.\"SR_STORE_SK\",
    store_returns.\"SR_RETURNED_DATE_SK\"),
brave as (
SELECT
    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\",
    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",
    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    store_returns.\"SR_STORE_SK\" as \"returns_store_id\",
    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\"
FROM
    memory.store_returns as store_returns
    INNER JOIN memory.customer as customers on store_returns.\"SR_CUSTOMER_SK\" = customers.\"C_CUSTOMER_SK\"),
pigeon as (
SELECT
    ray.\"returns_customer_id\" as \"returns_customer_id\",
    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    ray.\"returns_return_date_id\" as \"returns_return_date_id\",
    ray.\"returns_store_id\" as \"returns_store_id\"
FROM
    ray
    INNER JOIN memory.customer as customers on ray.\"returns_customer_id\" = customers.\"C_CUSTOMER_SK\"),
leopard as (
SELECT
    brave.\"returns_return_amount\" as \"returns_return_amount_filter_5387963398074161\",
    brave.\"returns_store_id\" as \"returns_store_id\",
    brave.\"returns_item_id\" as \"returns_item_id\",
    brave.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    brave.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"
FROM
    brave
    INNER JOIN memory.date_dim as date on brave.\"returns_return_date_id\" = date.\"D_DATE_SK\"
    INNER JOIN memory.store as store on brave.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000 and store.\"S_STATE\" = 'TN'
),
razorbill as (
SELECT
    pigeon.\"returns_store_id\" as \"returns_store_id\",
    pigeon.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    cast(\"D_YEAR\" as int) as \"returns_return_date_year\"
FROM
    pigeon
    INNER JOIN memory.date_dim as date on pigeon.\"returns_return_date_id\" = date.\"D_DATE_SK\"
WHERE
    cast(\"D_YEAR\" as int) = 2000
),
chicken as (
SELECT
    sum(leopard.\"returns_return_amount_filter_5387963398074161\") as \"total_returns\",
    leopard.\"returns_store_id\" as \"returns_store_id\",
    leopard.\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    leopard
GROUP BY 
    leopard.\"returns_customer_text_id\",
    leopard.\"returns_store_id\"),
avocet as (
SELECT
    razorbill.\"returns_store_id\" as \"returns_store_id\",
    razorbill.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    razorbill.\"returns_return_date_year\" as \"returns_return_date_year\",
    chicken.\"total_returns\" as \"total_returns\"
FROM
    razorbill
    INNER JOIN chicken on razorbill.\"returns_store_id\" = chicken.\"returns_store_id\" AND razorbill.\"returns_customer_text_id\" = chicken.\"returns_customer_text_id\"
WHERE
    razorbill.\"returns_return_date_year\" = 2000
),
viper as (
SELECT
    avocet.\"returns_return_date_year\" as \"returns_return_date_year\",
    store.\"S_STATE\" as \"returns_store_state\",
    avocet.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    avocet.\"returns_store_id\" as \"returns_store_id\",
    avocet.\"total_returns\" as \"total_returns\"
FROM
    avocet
    INNER JOIN memory.store as store on avocet.\"returns_store_id\" = store.\"S_STORE_SK\"
WHERE
    avocet.\"returns_return_date_year\" = 2000 and store.\"S_STATE\" = 'TN'
),
colossal as (
SELECT
    viper.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    viper.\"returns_store_id\" as \"returns_store_id\",
    viper.\"returns_store_state\" as \"returns_store_state\",
    viper.\"total_returns\" as \"total_returns\"
FROM
    viper
GROUP BY 
    viper.\"total_returns\",
    viper.\"returns_store_state\",
    viper.\"returns_store_id\",
    viper.\"returns_customer_text_id\"),
warbler as (
SELECT
    colossal.\"returns_customer_text_id\" as \"returns_customer_text_id\",
    colossal.\"returns_store_id\" as \"returns_store_id\",
    colossal.\"returns_store_state\" as \"returns_store_state\",
    colossal.\"total_returns\" as \"total_returns\",
    colossal.\"returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    colossal.\"returns_store_id\" as \"tn_2000_returns_store_id\",
    colossal.\"returns_store_state\" as \"tn_2000_returns_store_state\",
    colossal.\"total_returns\" as \"tn_2000_total_returns\"
FROM
    colossal
GROUP BY 
    colossal.\"returns_store_state\",
    colossal.\"returns_customer_text_id\",
    colossal.\"total_returns\",
    colossal.\"returns_store_id\"),
yummy as (
SELECT
    avg(warbler.\"tn_2000_total_returns\") as \"avg_store_returns\",
    warbler.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    warbler
GROUP BY 
    warbler.\"tn_2000_returns_store_id\"),
bewildered as (
SELECT
    warbler.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\",
    warbler.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    yummy.\"avg_store_returns\" as \"avg_store_returns\"
FROM
    warbler
    LEFT OUTER JOIN yummy on (warbler.\"tn_2000_returns_store_id\" = yummy.\"tn_2000_returns_store_id\" or (warbler.\"tn_2000_returns_store_id\" is null and yummy.\"tn_2000_returns_store_id\" is null))
WHERE
    warbler.\"tn_2000_total_returns\" > ( 1.2 * yummy.\"avg_store_returns\" )
),
vacuous as (
SELECT
    warbler.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",
    bewildered.\"avg_store_returns\" as \"avg_store_returns\",
    warbler.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",
    warbler.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"
FROM
    warbler
    LEFT OUTER JOIN bewildered on (warbler.\"tn_2000_returns_store_id\" = bewildered.\"tn_2000_returns_store_id\" or (warbler.\"tn_2000_returns_store_id\" is null and bewildered.\"tn_2000_returns_store_id\" is null)) AND (warbler.\"tn_2000_total_returns\" = bewildered.\"tn_2000_total_returns\" or (warbler.\"tn_2000_total_returns\" is null and bewildered.\"tn_2000_total_returns\" is null))
WHERE
    warbler.\"tn_2000_total_returns\" > ( 1.2 * bewildered.\"avg_store_returns\" )
)
SELECT
    vacuous.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\"
FROM
    vacuous
GROUP BY 
    vacuous.\"tn_2000_returns_store_id\",
    vacuous.\"tn_2000_returns_customer_text_id\"
ORDER BY 
    vacuous.\"tn_2000_returns_customer_text_id\" asc
LIMIT (100)"""
