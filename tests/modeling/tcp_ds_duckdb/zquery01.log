{
    "query_id": 1,
    "parse_time": 1.617909,
    "exec_time": 0.260087,
    "comp_time": 0.275273,
    "generated_sql": "\nWITH \neel as (\nSELECT\n    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",\n    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",\n    store_returns.\"SR_STORE_SK\" as \"returns_store_id\"\nFROM\n    memory.store_returns as store_returns\nGROUP BY \n    store_returns.\"SR_STORE_SK\",\n    store_returns.\"SR_RETURNED_DATE_SK\",\n    store_returns.\"SR_CUSTOMER_SK\"),\nstork as (\nSELECT\n    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",\n    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",\n    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\",\n    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",\n    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",\n    store_returns.\"SR_STORE_SK\" as \"returns_store_id\",\n    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\"\nFROM\n    memory.store_returns as store_returns\n    LEFT OUTER JOIN memory.customer as customers on store_returns.\"SR_CUSTOMER_SK\" = customers.\"C_CUSTOMER_SK\"),\ncolossal as (\nSELECT\n    eel.\"returns_customer_id\" as \"returns_customer_id\",\n    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",\n    eel.\"returns_return_date_id\" as \"returns_return_date_id\",\n    eel.\"returns_store_id\" as \"returns_store_id\"\nFROM\n    eel\n    LEFT OUTER JOIN memory.customer as customers on eel.\"returns_customer_id\" = customers.\"C_CUSTOMER_SK\"),\nuneven as (\nSELECT\n    stork.\"returns_return_amount\" as \"returns_return_amount_filter_5387963398074161\",\n    stork.\"returns_store_id\" as \"returns_store_id\",\n    stork.\"returns_item_id\" as \"returns_item_id\",\n    stork.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    stork.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"\nFROM\n    stork\n    LEFT OUTER JOIN memory.date_dim as date on stork.\"returns_return_date_id\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.store as store on stork.\"returns_store_id\" = store.\"S_STORE_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2000 and store.\"S_STATE\" = 'TN'\n),\njay as (\nSELECT\n    colossal.\"returns_store_id\" as \"returns_store_id\",\n    colossal.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    cast(\"D_YEAR\" as int) as \"returns_return_date_year\"\nFROM\n    colossal\n    LEFT OUTER JOIN memory.date_dim as date on colossal.\"returns_return_date_id\" = date.\"D_DATE_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2000\n),\nnondescript as (\nSELECT\n    sum(uneven.\"returns_return_amount_filter_5387963398074161\") as \"total_returns\",\n    uneven.\"returns_store_id\" as \"returns_store_id\",\n    uneven.\"returns_customer_text_id\" as \"returns_customer_text_id\"\nFROM\n    uneven\nGROUP BY \n    uneven.\"returns_customer_text_id\",\n    uneven.\"returns_store_id\"),\nlevel as (\nSELECT\n    jay.\"returns_store_id\" as \"returns_store_id\",\n    jay.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    jay.\"returns_return_date_year\" as \"returns_return_date_year\",\n    nondescript.\"total_returns\" as \"total_returns\"\nFROM\n    jay\n    LEFT OUTER JOIN nondescript on jay.\"returns_store_id\" = nondescript.\"returns_store_id\" AND jay.\"returns_customer_text_id\" = nondescript.\"returns_customer_text_id\"\nWHERE\n    jay.\"returns_return_date_year\" = 2000\n),\npenguin as (\nSELECT\n    level.\"returns_return_date_year\" as \"returns_return_date_year\",\n    store.\"S_STATE\" as \"returns_store_state\",\n    level.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    level.\"returns_store_id\" as \"returns_store_id\",\n    level.\"total_returns\" as \"total_returns\"\nFROM\n    level\n    LEFT OUTER JOIN memory.store as store on level.\"returns_store_id\" = store.\"S_STORE_SK\"\nWHERE\n    level.\"returns_return_date_year\" = 2000 and store.\"S_STATE\" = 'TN'\n),\nsweltering as (\nSELECT\n    penguin.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    penguin.\"returns_store_id\" as \"returns_store_id\",\n    penguin.\"returns_store_state\" as \"returns_store_state\",\n    penguin.\"total_returns\" as \"total_returns\"\nFROM\n    penguin\nGROUP BY \n    penguin.\"total_returns\",\n    penguin.\"returns_store_state\",\n    penguin.\"returns_customer_text_id\",\n    penguin.\"returns_store_id\"),\nboa as (\nSELECT\n    sweltering.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    sweltering.\"returns_store_id\" as \"returns_store_id\",\n    sweltering.\"returns_store_state\" as \"returns_store_state\",\n    sweltering.\"total_returns\" as \"total_returns\",\n    sweltering.\"returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",\n    sweltering.\"returns_store_id\" as \"tn_2000_returns_store_id\",\n    sweltering.\"returns_store_state\" as \"tn_2000_returns_store_state\",\n    sweltering.\"total_returns\" as \"tn_2000_total_returns\"\nFROM\n    sweltering\nGROUP BY \n    sweltering.\"total_returns\",\n    sweltering.\"returns_store_state\",\n    sweltering.\"returns_customer_text_id\",\n    sweltering.\"returns_store_id\"),\npuzzled as (\nSELECT\n    avg(boa.\"tn_2000_total_returns\") as \"avg_store_returns\",\n    boa.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"\nFROM\n    boa\nGROUP BY \n    boa.\"tn_2000_returns_store_id\"),\nfabulous as (\nSELECT\n    boa.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\",\n    boa.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",\n    puzzled.\"avg_store_returns\" as \"avg_store_returns\"\nFROM\n    boa\n    LEFT OUTER JOIN puzzled on boa.\"tn_2000_returns_store_id\" = puzzled.\"tn_2000_returns_store_id\"\nWHERE\n    boa.\"tn_2000_total_returns\" > ( 1.2 * puzzled.\"avg_store_returns\" )\n),\nceaseless as (\nSELECT\n    boa.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",\n    fabulous.\"avg_store_returns\" as \"avg_store_returns\",\n    boa.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",\n    boa.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"\nFROM\n    boa\n    LEFT OUTER JOIN fabulous on boa.\"tn_2000_returns_store_id\" = fabulous.\"tn_2000_returns_store_id\" AND boa.\"tn_2000_total_returns\" = fabulous.\"tn_2000_total_returns\"\nWHERE\n    boa.\"tn_2000_total_returns\" > ( 1.2 * fabulous.\"avg_store_returns\" )\n)\nSELECT\n    ceaseless.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\"\nFROM\n    ceaseless\nGROUP BY \n    ceaseless.\"tn_2000_returns_store_id\",\n    ceaseless.\"tn_2000_returns_customer_text_id\"\nORDER BY \n    ceaseless.\"tn_2000_returns_customer_text_id\" asc\nLIMIT (100)"
}