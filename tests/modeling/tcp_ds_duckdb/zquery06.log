{
    "query_id": 6,
    "parse_time": 5.232301,
    "exec_time": 2.026006,
    "comp_time": 1.570383,
    "generated_sql": "\nWITH \nserval as (\nSELECT\n    store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\",\n    store_sales.\"SS_ITEM_SK\" as \"item_id\",\n    store_sales.\"SS_CUSTOMER_SK\" as \"store_sales_customer_id\"\nFROM\n    memory.store_sales as store_sales\nGROUP BY \n    store_sales.\"SS_CUSTOMER_SK\",\n    store_sales.\"SS_SOLD_DATE_SK\",\n    store_sales.\"SS_ITEM_SK\"),\nchimpanzee as (\nSELECT\n    customers.\"C_CURRENT_ADDR_SK\" as \"store_sales_customer_address_id\",\n    customers.\"C_CUSTOMER_SK\" as \"store_sales_customer_id\",\n    customer_address.\"CA_STATE\" as \"store_sales_customer_state\"\nFROM\n    memory.customer as customers\n    LEFT OUTER JOIN memory.customer_address as customer_address on customers.\"C_CURRENT_ADDR_SK\" = customer_address.\"CA_ADDRESS_SK\"),\nodd as (\nSELECT\n    items.\"I_CURRENT_PRICE\" as \"store_sales_item_current_price\",\n    items.\"I_ITEM_SK\" as \"item_id\"\nFROM\n    memory.item as items),\nparakeet as (\nSELECT\n    avg(items.\"I_CURRENT_PRICE\") as \"_virtual_6264207893106521\",\n    items.\"I_CATEGORY\" as \"item_category\"\nFROM\n    memory.item as items\nWHERE\n    items.\"I_CATEGORY\" is not null\n\nGROUP BY \n    items.\"I_CATEGORY\"),\nviper as (\nSELECT\n    date.\"D_DATE_SK\" as \"store_sales_date_id\",\n    serval.\"item_id\" as \"item_id\",\n    serval.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    date.\"D_MOY\" as \"store_sales_date_month_of_year\",\n    cast(\"D_YEAR\" as int) as \"store_sales_date_year\"\nFROM\n    serval\n    LEFT OUTER JOIN memory.date_dim as date on serval.\"store_sales_date_id\" = date.\"D_DATE_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2001 and date.\"D_MOY\" = 1\n),\nruthless as (\nSELECT\n    items.\"I_CATEGORY\" as \"item_category\",\n    odd.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    viper.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    chimpanzee.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    viper.\"store_sales_date_year\" as \"store_sales_date_year\",\n    chimpanzee.\"store_sales_customer_id\" as \"store_sales_customer_id\"\nFROM\n    chimpanzee\n    LEFT OUTER JOIN viper on chimpanzee.\"store_sales_customer_id\" = viper.\"store_sales_customer_id\"\n    LEFT OUTER JOIN memory.item as items on viper.\"item_id\" = items.\"I_ITEM_SK\"\n    LEFT OUTER JOIN odd on viper.\"item_id\" = odd.\"item_id\"\nWHERE\n    viper.\"store_sales_date_year\" = 2001 and viper.\"store_sales_date_month_of_year\" = 1 and items.\"I_CATEGORY\" is not null\n),\nobsolete as (\nSELECT\n    ruthless.\"item_category\" as \"item_category\",\n    ruthless.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    ruthless.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    ruthless.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    ruthless.\"store_sales_date_year\" as \"store_sales_date_year\",\n    parakeet.\"_virtual_6264207893106521\" as \"_virtual_6264207893106521\"\nFROM\n    ruthless\n    LEFT OUTER JOIN parakeet on ((ruthless.\"item_category\" is null and parakeet.\"item_category\" is null) or (ruthless.\"item_category\" = parakeet.\"item_category\"))\nWHERE\n    ruthless.\"store_sales_date_year\" = 2001 and ruthless.\"store_sales_date_month_of_year\" = 1 and ruthless.\"store_sales_item_current_price\" > 1.2 * parakeet.\"_virtual_6264207893106521\" and ruthless.\"item_category\" is not null\n),\npuffin as (\nSELECT\n    ruthless.\"store_sales_customer_id\" as \"store_sales_customer_id_filter_5640408687474034\",\n    ruthless.\"store_sales_customer_state\" as \"store_sales_customer_state\"\nFROM\n    ruthless\n    LEFT OUTER JOIN parakeet on ((ruthless.\"item_category\" is null and parakeet.\"item_category\" is null) or (ruthless.\"item_category\" = parakeet.\"item_category\"))\nWHERE\n    ruthless.\"store_sales_date_year\" = 2001 and ruthless.\"store_sales_date_month_of_year\" = 1 and ruthless.\"store_sales_item_current_price\" > 1.2 * parakeet.\"_virtual_6264207893106521\" and ruthless.\"item_category\" is not null\n),\nturkey as (\nSELECT\n    count(puffin.\"store_sales_customer_id_filter_5640408687474034\") as \"customer_count\",\n    puffin.\"store_sales_customer_state\" as \"store_sales_customer_state\"\nFROM\n    puffin\nGROUP BY \n    puffin.\"store_sales_customer_state\"),\nbewildered as (\nSELECT\n    ruthless.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    ruthless.\"item_category\" as \"item_category\",\n    ruthless.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    ruthless.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    ruthless.\"store_sales_date_year\" as \"store_sales_date_year\",\n    turkey.\"customer_count\" as \"customer_count\"\nFROM\n    ruthless\n    LEFT OUTER JOIN turkey on ((ruthless.\"store_sales_customer_state\" is null and turkey.\"store_sales_customer_state\" is null) or (ruthless.\"store_sales_customer_state\" = turkey.\"store_sales_customer_state\"))\nWHERE\n    ruthless.\"store_sales_date_year\" = 2001 and ruthless.\"store_sales_date_month_of_year\" = 1 and ruthless.\"item_category\" is not null\n),\nquail as (\nSELECT\n    bewildered.\"store_sales_date_year\" as \"store_sales_date_year\",\n    bewildered.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    bewildered.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    obsolete.\"_virtual_6264207893106521\" as \"_virtual_6264207893106521\",\n    bewildered.\"item_category\" as \"item_category\",\n    bewildered.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    bewildered.\"customer_count\" as \"customer_count\"\nFROM\n    bewildered\n    LEFT OUTER JOIN obsolete on ((bewildered.\"store_sales_customer_state\" is null and obsolete.\"store_sales_customer_state\" is null) or (bewildered.\"store_sales_customer_state\" = obsolete.\"store_sales_customer_state\")) AND ((bewildered.\"item_category\" is null and obsolete.\"item_category\" is null) or (bewildered.\"item_category\" = obsolete.\"item_category\")) AND ((bewildered.\"store_sales_item_current_price\" is null and obsolete.\"store_sales_item_current_price\" is null) or (bewildered.\"store_sales_item_current_price\" = obsolete.\"store_sales_item_current_price\")) AND bewildered.\"store_sales_date_month_of_year\" = obsolete.\"store_sales_date_month_of_year\" AND bewildered.\"store_sales_date_year\" = obsolete.\"store_sales_date_year\"\nWHERE\n    bewildered.\"store_sales_date_year\" = 2001 and bewildered.\"store_sales_date_month_of_year\" = 1 and bewildered.\"store_sales_item_current_price\" > 1.2 * obsolete.\"_virtual_6264207893106521\" and bewildered.\"item_category\" is not null\n)\nSELECT\n    quail.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    quail.\"customer_count\" as \"customer_count\"\nFROM\n    quail\nWHERE\n    quail.\"customer_count\" >= 10 and quail.\"store_sales_date_year\" = 2001 and quail.\"store_sales_date_month_of_year\" = 1 and quail.\"store_sales_item_current_price\" > 1.2 * quail.\"_virtual_6264207893106521\" and quail.\"item_category\" is not null\n\nGROUP BY \n    quail.\"store_sales_customer_state\",\n    quail.\"customer_count\"\nORDER BY \n    quail.\"customer_count\" asc nulls first,\n    quail.\"store_sales_customer_state\" asc nulls first"
}