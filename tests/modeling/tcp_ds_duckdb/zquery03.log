query_id = 3
parse_time = 2.179088
exec_time = 0.546995
comp_time = 0.196677
generated_sql = """

WITH 
ocelot as (
SELECT
    store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\",
    store_sales.\"SS_ITEM_SK\" as \"store_sales_item_id\"
FROM
    memory.store_sales as store_sales
GROUP BY 
    store_sales.\"SS_SOLD_DATE_SK\",
    store_sales.\"SS_ITEM_SK\"),
goose as (
SELECT
    store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\",
    date.\"D_MOY\" as \"store_sales_date_month_of_year\",
    cast(\"D_YEAR\" as int) as \"store_sales_date_year\",
    store_sales.\"SS_EXT_SALES_PRICE\" as \"store_sales_ext_sales_price\",
    store_sales.\"SS_ITEM_SK\" as \"store_sales_item_id\",
    store_sales.\"SS_TICKET_NUMBER\" as \"store_sales_ticket_number\"
FROM
    memory.store_sales as store_sales
    LEFT OUTER JOIN memory.date_dim as date on store_sales.\"SS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    date.\"D_MOY\" = 11
),
swift as (
SELECT
    date.\"D_DATE_SK\" as \"store_sales_date_id\",
    date.\"D_MOY\" as \"store_sales_date_month_of_year\",
    cast(\"D_YEAR\" as int) as \"store_sales_date_year\",
    ocelot.\"store_sales_item_id\" as \"store_sales_item_id\"
FROM
    ocelot
    LEFT OUTER JOIN memory.date_dim as date on ocelot.\"store_sales_date_id\" = date.\"D_DATE_SK\"
WHERE
    date.\"D_MOY\" = 11
),
albatross as (
SELECT
    goose.\"store_sales_ext_sales_price\" as \"store_sales_ext_sales_price_filter_1819642393595304\",
    goose.\"store_sales_item_id\" as \"store_sales_item_id\",
    goose.\"store_sales_ticket_number\" as \"store_sales_ticket_number\",
    goose.\"store_sales_date_year\" as \"store_sales_date_year\"
FROM
    goose
    LEFT OUTER JOIN memory.item as items on goose.\"store_sales_item_id\" = items.\"I_ITEM_SK\"
WHERE
    goose.\"store_sales_date_month_of_year\" = 11 and items.\"I_MANUFACT_ID\" = 128
),
magpie as (
SELECT
    items.\"I_BRAND_ID\" as \"store_sales_item_brand_id\",
    items.\"I_BRAND\" as \"store_sales_item_brand_name\",
    swift.\"store_sales_date_year\" as \"store_sales_date_year\",
    items.\"I_MANUFACT_ID\" as \"store_sales_item_manufacturer_id\",
    swift.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\"
FROM
    swift
    LEFT OUTER JOIN memory.item as items on swift.\"store_sales_item_id\" = items.\"I_ITEM_SK\"
WHERE
    swift.\"store_sales_date_month_of_year\" = 11 and items.\"I_MANUFACT_ID\" = 128
),
flashy as (
SELECT
    albatross.\"store_sales_ext_sales_price_filter_1819642393595304\" as \"store_sales_ext_sales_price_filter_1819642393595304\",
    items.\"I_BRAND_ID\" as \"store_sales_item_brand_id\",
    items.\"I_BRAND\" as \"store_sales_item_brand_name\",
    albatross.\"store_sales_date_year\" as \"store_sales_date_year\",
    albatross.\"store_sales_ticket_number\" as \"store_sales_ticket_number\",
    albatross.\"store_sales_item_id\" as \"store_sales_item_id\"
FROM
    albatross
    LEFT OUTER JOIN memory.item as items on albatross.\"store_sales_item_id\" = items.\"I_ITEM_SK\"),
rail as (
SELECT
    sum(flashy.\"store_sales_ext_sales_price_filter_1819642393595304\") as \"sum_agg\",
    flashy.\"store_sales_item_brand_id\" as \"store_sales_item_brand_id\",
    flashy.\"store_sales_item_brand_name\" as \"store_sales_item_brand_name\",
    flashy.\"store_sales_date_year\" as \"store_sales_date_year\"
FROM
    flashy
GROUP BY 
    flashy.\"store_sales_date_year\",
    flashy.\"store_sales_item_brand_name\",
    flashy.\"store_sales_item_brand_id\"),
jackal as (
SELECT
    magpie.\"store_sales_item_brand_id\" as \"store_sales_item_brand_id\",
    magpie.\"store_sales_item_brand_name\" as \"store_sales_item_brand_name\",
    magpie.\"store_sales_date_year\" as \"store_sales_date_year\",
    magpie.\"store_sales_item_manufacturer_id\" as \"store_sales_item_manufacturer_id\",
    magpie.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",
    rail.\"sum_agg\" as \"sum_agg\"
FROM
    magpie
    LEFT OUTER JOIN rail on magpie.\"store_sales_item_brand_id\" = rail.\"store_sales_item_brand_id\" AND magpie.\"store_sales_item_brand_name\" = rail.\"store_sales_item_brand_name\" AND magpie.\"store_sales_date_year\" = rail.\"store_sales_date_year\"
WHERE
    magpie.\"store_sales_date_month_of_year\" = 11 and magpie.\"store_sales_item_manufacturer_id\" = 128
)
SELECT
    jackal.\"store_sales_date_year\" as \"store_sales_date_year\",
    jackal.\"store_sales_item_brand_id\" as \"store_sales_item_brand_id\",
    jackal.\"store_sales_item_brand_name\" as \"store_sales_item_brand_name\",
    jackal.\"sum_agg\" as \"sum_agg\"
FROM
    jackal
GROUP BY 
    jackal.\"store_sales_date_year\",
    jackal.\"store_sales_item_brand_id\",
    jackal.\"sum_agg\",
    jackal.\"store_sales_item_brand_name\"
ORDER BY 
    jackal.\"store_sales_date_year\" asc,
    jackal.\"sum_agg\" desc,
    jackal.\"store_sales_item_brand_id\" asc
LIMIT (100)"""
