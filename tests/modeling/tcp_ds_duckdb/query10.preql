import customer as customer;
import store_sales as store_sales;
import web_sales as web_sales;
import catalog_sales as catalog_sales;

#Count the customers with the same gender, marital status, education status, purchase estimate, credit rating,
#dependent count, employed dependent count and college dependent count who live in certain counties and who
# have purchased from both stores and another sales channel during a three month time period of a given year.


#merge_new catalog_sales.customer.id into ~customer.id;
#merge_new web_sales.customer.id into ~customer.id;
merge_new store_sales.customer.id into ~customer.id;

auto relevant_customers <- filter 
    customer.id 
where 
    store_sales.date.year = 2002 and store_sales.date.month_of_year in (1,2,3,4)
    and web_sales.date.year = 2002 and web_sales.date.month_of_year in (1,2,3,4)
    #and ((web_sales.date.year = 2002 and web_sales.date.month_of_year in (1,2,3,4)) or (catalog_sales.date.year = 2002 and catalog_sales.date.month_of_year in (1,2,3,4)))
    and customer.county in (
    'Rush County',
    'Toole County',
    'Jefferson County',
    'Dona Ana County',
    'La Porte County',
);

select 
    relevant_customers
;
