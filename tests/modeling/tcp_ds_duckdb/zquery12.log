{
    "query_id": 12,
    "parse_time": 5.993521,
    "exec_time": 0.474538,
    "comp_time": 0.168576,
    "generated_sql": "\nWITH \nflamingo as (\nSELECT\n    web_sales.\"WS_EXT_SALES_PRICE\" as \"web_sales_external_sales_price\",\n    date.\"D_DATE\" as \"web_sales_date_date\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    web_sales.\"WS_ORDER_NUMBER\" as \"web_sales_order_number\",\n    web_sales.\"WS_ITEM_SK\" as \"web_sales_item_id\"\nFROM\n    memory.web_sales as web_sales\n    LEFT OUTER JOIN memory.date_dim as date on web_sales.\"WS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.item as items on web_sales.\"WS_ITEM_SK\" = items.\"I_ITEM_SK\"),\ncovey as (\nSELECT\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\"\nFROM\n    memory.item as items\nGROUP BY \n    items.\"I_ITEM_DESC\",\n    items.\"I_CURRENT_PRICE\",\n    items.\"I_CATEGORY\",\n    items.\"I_CLASS\",\n    items.\"I_ITEM_ID\"),\nhawk as (\nSELECT\n    CASE WHEN flamingo.\"web_sales_date_date\" >= cast('1999-02-22' as date) and flamingo.\"web_sales_date_date\" <= cast('1999-03-24' as date) and flamingo.\"web_sales_item_category\" in ( 'Sports','Books','Home' ) THEN flamingo.\"web_sales_external_sales_price\" ELSE NULL END as \"relevant_sales\",\n    flamingo.\"web_sales_order_number\" as \"web_sales_order_number\",\n    flamingo.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    flamingo),\ngrouse as (\nSELECT\n    hawk.\"relevant_sales\" as \"relevant_sales\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    hawk.\"web_sales_order_number\" as \"web_sales_order_number\",\n    hawk.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    hawk\n    LEFT OUTER JOIN memory.item as items on hawk.\"web_sales_item_id\" = items.\"I_ITEM_SK\"),\nskua as (\nSELECT\n    sum(grouse.\"relevant_sales\") as \"itemrevenue\",\n    grouse.\"web_sales_item_category\" as \"web_sales_item_category\",\n    grouse.\"web_sales_item_class\" as \"web_sales_item_class\",\n    grouse.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    grouse.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    grouse.\"web_sales_item_name\" as \"web_sales_item_name\",\n    sum(grouse.\"relevant_sales\") as \"_virtual_1496978012803723\"\nFROM\n    grouse\nGROUP BY \n    grouse.\"web_sales_item_class\",\n    grouse.\"web_sales_item_category\",\n    grouse.\"web_sales_item_current_price\",\n    grouse.\"web_sales_item_desc\",\n    grouse.\"web_sales_item_name\"),\ntoucan as (\nSELECT\n    sum(grouse.\"relevant_sales\") as \"_virtual_341251569527357\",\n    grouse.\"web_sales_item_class\" as \"web_sales_item_class\"\nFROM\n    grouse\nGROUP BY \n    grouse.\"web_sales_item_class\"),\ndapper as (\nSELECT\n    covey.\"web_sales_item_class\" as \"web_sales_item_class\",\n    covey.\"web_sales_item_category\" as \"web_sales_item_category\",\n    covey.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    covey.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    covey.\"web_sales_item_name\" as \"web_sales_item_name\",\n    toucan.\"_virtual_341251569527357\" as \"_virtual_341251569527357\"\nFROM\n    covey\n    LEFT OUTER JOIN toucan on covey.\"web_sales_item_class\" = toucan.\"web_sales_item_class\"),\neminent as (\nSELECT\n    skua.\"web_sales_item_category\" as \"web_sales_item_category\",\n    skua.\"web_sales_item_class\" as \"web_sales_item_class\",\n    skua.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    skua.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    skua.\"web_sales_item_name\" as \"web_sales_item_name\",\n    skua.\"_virtual_1496978012803723\" * 100.0 / dapper.\"_virtual_341251569527357\" as \"revenueratio\"\nFROM\n    skua\n    LEFT OUTER JOIN dapper on skua.\"web_sales_item_category\" = dapper.\"web_sales_item_category\" AND skua.\"web_sales_item_class\" = dapper.\"web_sales_item_class\" AND skua.\"web_sales_item_current_price\" = dapper.\"web_sales_item_current_price\" AND skua.\"web_sales_item_desc\" = dapper.\"web_sales_item_desc\" AND skua.\"web_sales_item_name\" = dapper.\"web_sales_item_name\"),\ncanary as (\nSELECT\n    eminent.\"web_sales_item_category\" as \"web_sales_item_category\",\n    eminent.\"web_sales_item_class\" as \"web_sales_item_class\",\n    eminent.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    eminent.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    eminent.\"web_sales_item_name\" as \"web_sales_item_name\",\n    eminent.\"revenueratio\" as \"revenueratio\",\n    skua.\"itemrevenue\" as \"itemrevenue\"\nFROM\n    eminent\n    LEFT OUTER JOIN skua on eminent.\"web_sales_item_category\" = skua.\"web_sales_item_category\" AND eminent.\"web_sales_item_class\" = skua.\"web_sales_item_class\" AND eminent.\"web_sales_item_current_price\" = skua.\"web_sales_item_current_price\" AND eminent.\"web_sales_item_desc\" = skua.\"web_sales_item_desc\" AND eminent.\"web_sales_item_name\" = skua.\"web_sales_item_name\")\nSELECT\n    canary.\"web_sales_item_name\" as \"web_sales_item_name\",\n    canary.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    canary.\"web_sales_item_category\" as \"web_sales_item_category\",\n    canary.\"web_sales_item_class\" as \"web_sales_item_class\",\n    canary.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    canary.\"itemrevenue\" as \"itemrevenue\",\n    canary.\"revenueratio\" as \"revenueratio\"\nFROM\n    canary\nWHERE\n    canary.\"itemrevenue\" is not null\n\nORDER BY \n    canary.\"web_sales_item_category\" asc,\n    canary.\"web_sales_item_class\" asc,\n    canary.\"web_sales_item_name\" asc,\n    canary.\"web_sales_item_desc\" asc,\n    canary.\"revenueratio\" asc\nLIMIT (100)"
}