{
    "query_id": 12,
    "parse_time": 7.797807,
    "exec_time": 0.979863,
    "comp_time": 0.219174,
    "generated_sql": "\nWITH \nfalcon as (\nSELECT\n    web_sales.\"WS_EXT_SALES_PRICE\" as \"web_sales_external_sales_price\",\n    date.\"D_DATE\" as \"web_sales_date_date\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    web_sales.\"WS_ORDER_NUMBER\" as \"web_sales_order_number\",\n    web_sales.\"WS_ITEM_SK\" as \"web_sales_item_id\"\nFROM\n    memory.web_sales as web_sales\n    LEFT OUTER JOIN memory.date_dim as date on web_sales.\"WS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.item as items on web_sales.\"WS_ITEM_SK\" = items.\"I_ITEM_SK\"),\nvast as (\nSELECT\n    CASE WHEN falcon.\"web_sales_date_date\" >= cast('1999-02-22' as date) and falcon.\"web_sales_date_date\" <= cast('1999-03-24' as date) and falcon.\"web_sales_item_category\" in ( 'Sports','Books','Home' ) THEN falcon.\"web_sales_external_sales_price\" ELSE NULL END as \"relevant_sales\",\n    falcon.\"web_sales_order_number\" as \"web_sales_order_number\",\n    falcon.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    falcon),\nflashy as (\nSELECT\n    vast.\"relevant_sales\" as \"relevant_sales\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    vast.\"web_sales_order_number\" as \"web_sales_order_number\",\n    vast.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    vast\n    LEFT OUTER JOIN memory.item as items on vast.\"web_sales_item_id\" = items.\"I_ITEM_SK\"),\nruthless as (\nSELECT\n    sum(flashy.\"relevant_sales\") as \"itemrevenue\",\n    flashy.\"web_sales_item_category\" as \"web_sales_item_category\",\n    flashy.\"web_sales_item_class\" as \"web_sales_item_class\",\n    flashy.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    flashy.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    flashy.\"web_sales_item_name\" as \"web_sales_item_name\",\n    sum(flashy.\"relevant_sales\") as \"_virtual_1496978012803723\"\nFROM\n    flashy\nGROUP BY \n    flashy.\"web_sales_item_current_price\",\n    flashy.\"web_sales_item_desc\",\n    flashy.\"web_sales_item_name\",\n    flashy.\"web_sales_item_category\",\n    flashy.\"web_sales_item_class\"),\ncockatiel as (\nSELECT\n    sum(flashy.\"relevant_sales\") as \"_virtual_341251569527357\",\n    flashy.\"web_sales_item_class\" as \"web_sales_item_class\"\nFROM\n    flashy\nGROUP BY \n    flashy.\"web_sales_item_class\"),\njackdaw as (\nSELECT\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\"\nFROM\n    memory.item as items\nGROUP BY \n    items.\"I_ITEM_DESC\",\n    items.\"I_CLASS\",\n    items.\"I_CURRENT_PRICE\",\n    items.\"I_CATEGORY\",\n    items.\"I_ITEM_ID\"),\nparakeet as (\nSELECT\n    jackdaw.\"web_sales_item_class\" as \"web_sales_item_class\",\n    jackdaw.\"web_sales_item_category\" as \"web_sales_item_category\",\n    jackdaw.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    jackdaw.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    jackdaw.\"web_sales_item_name\" as \"web_sales_item_name\",\n    cockatiel.\"_virtual_341251569527357\" as \"_virtual_341251569527357\"\nFROM\n    jackdaw\n    LEFT OUTER JOIN cockatiel on jackdaw.\"web_sales_item_class\" = cockatiel.\"web_sales_item_class\"),\neel as (\nSELECT\n    ruthless.\"web_sales_item_category\" as \"web_sales_item_category\",\n    ruthless.\"web_sales_item_class\" as \"web_sales_item_class\",\n    ruthless.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    ruthless.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    ruthless.\"web_sales_item_name\" as \"web_sales_item_name\",\n    ruthless.\"_virtual_1496978012803723\" * 100.0 / parakeet.\"_virtual_341251569527357\" as \"revenueratio\"\nFROM\n    ruthless\n    LEFT OUTER JOIN parakeet on ruthless.\"web_sales_item_category\" = parakeet.\"web_sales_item_category\" AND ruthless.\"web_sales_item_class\" = parakeet.\"web_sales_item_class\" AND ruthless.\"web_sales_item_current_price\" = parakeet.\"web_sales_item_current_price\" AND ruthless.\"web_sales_item_desc\" = parakeet.\"web_sales_item_desc\" AND ruthless.\"web_sales_item_name\" = parakeet.\"web_sales_item_name\"),\nsnipe as (\nSELECT\n    eel.\"web_sales_item_category\" as \"web_sales_item_category\",\n    eel.\"web_sales_item_class\" as \"web_sales_item_class\",\n    eel.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    eel.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    eel.\"web_sales_item_name\" as \"web_sales_item_name\",\n    eel.\"revenueratio\" as \"revenueratio\",\n    ruthless.\"itemrevenue\" as \"itemrevenue\"\nFROM\n    eel\n    LEFT OUTER JOIN ruthless on eel.\"web_sales_item_category\" = ruthless.\"web_sales_item_category\" AND eel.\"web_sales_item_class\" = ruthless.\"web_sales_item_class\" AND eel.\"web_sales_item_current_price\" = ruthless.\"web_sales_item_current_price\" AND eel.\"web_sales_item_desc\" = ruthless.\"web_sales_item_desc\" AND eel.\"web_sales_item_name\" = ruthless.\"web_sales_item_name\")\nSELECT\n    snipe.\"web_sales_item_name\" as \"web_sales_item_name\",\n    snipe.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    snipe.\"web_sales_item_category\" as \"web_sales_item_category\",\n    snipe.\"web_sales_item_class\" as \"web_sales_item_class\",\n    snipe.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    snipe.\"itemrevenue\" as \"itemrevenue\",\n    snipe.\"revenueratio\" as \"revenueratio\"\nFROM\n    snipe\nWHERE\n    snipe.\"itemrevenue\" is not null\n\nORDER BY \n    snipe.\"web_sales_item_category\" asc,\n    snipe.\"web_sales_item_class\" asc,\n    snipe.\"web_sales_item_name\" asc,\n    snipe.\"web_sales_item_desc\" asc,\n    snipe.\"revenueratio\" asc\nLIMIT (100)"
}