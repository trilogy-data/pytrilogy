{
    "query_id": 12,
    "parse_time": 4.62385,
    "exec_time": 0.387677,
    "comp_time": 0.093572,
    "generated_sql": "\nWITH \ncharming as (\nSELECT\n    web_sales.\"WS_EXT_SALES_PRICE\" as \"web_sales_external_sales_price\",\n    date.\"D_DATE\" as \"web_sales_date_date\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    web_sales.\"WS_ORDER_NUMBER\" as \"web_sales_order_number\",\n    web_sales.\"WS_ITEM_SK\" as \"web_sales_item_id\"\nFROM\n    memory.web_sales as web_sales\n    LEFT OUTER JOIN memory.date_dim as date on web_sales.\"WS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.item as items on web_sales.\"WS_ITEM_SK\" = items.\"I_ITEM_SK\"),\ndeeply as (\nSELECT\n    CASE WHEN charming.\"web_sales_date_date\" >= cast('1999-02-22' as date) and charming.\"web_sales_date_date\" <= cast('1999-03-24' as date) and charming.\"web_sales_item_category\" in ( 'Sports','Books','Home' ) THEN charming.\"web_sales_external_sales_price\" ELSE NULL END as \"relevant_sales\",\n    charming.\"web_sales_order_number\" as \"web_sales_order_number\",\n    charming.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    charming),\nresonant as (\nSELECT\n    deeply.\"relevant_sales\" as \"relevant_sales\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    deeply.\"web_sales_order_number\" as \"web_sales_order_number\",\n    deeply.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    deeply\n    LEFT OUTER JOIN memory.item as items on deeply.\"web_sales_item_id\" = items.\"I_ITEM_SK\"),\nstork as (\nSELECT\n    sum(resonant.\"relevant_sales\") as \"itemrevenue\",\n    resonant.\"web_sales_item_category\" as \"web_sales_item_category\",\n    resonant.\"web_sales_item_class\" as \"web_sales_item_class\",\n    resonant.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    resonant.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    resonant.\"web_sales_item_name\" as \"web_sales_item_name\",\n    sum(resonant.\"relevant_sales\") as \"_virtual_1496978012803723\"\nFROM\n    resonant\nGROUP BY \n    resonant.\"web_sales_item_category\",\n    resonant.\"web_sales_item_desc\",\n    resonant.\"web_sales_item_name\",\n    resonant.\"web_sales_item_current_price\",\n    resonant.\"web_sales_item_class\"),\nabhorrent as (\nSELECT\n    sum(resonant.\"relevant_sales\") as \"_virtual_341251569527357\",\n    resonant.\"web_sales_item_class\" as \"web_sales_item_class\"\nFROM\n    resonant\nGROUP BY \n    resonant.\"web_sales_item_class\"),\ncoyote as (\nSELECT\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\"\nFROM\n    memory.item as items\nGROUP BY \n    items.\"I_ITEM_DESC\",\n    items.\"I_CATEGORY\",\n    items.\"I_CURRENT_PRICE\",\n    items.\"I_ITEM_ID\",\n    items.\"I_CLASS\"),\nparakeet as (\nSELECT\n    coyote.\"web_sales_item_class\" as \"web_sales_item_class\",\n    coyote.\"web_sales_item_category\" as \"web_sales_item_category\",\n    coyote.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    coyote.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    coyote.\"web_sales_item_name\" as \"web_sales_item_name\",\n    abhorrent.\"_virtual_341251569527357\" as \"_virtual_341251569527357\"\nFROM\n    coyote\n    LEFT OUTER JOIN abhorrent on coyote.\"web_sales_item_class\" = abhorrent.\"web_sales_item_class\"),\nhard as (\nSELECT\n    stork.\"web_sales_item_category\" as \"web_sales_item_category\",\n    stork.\"web_sales_item_class\" as \"web_sales_item_class\",\n    stork.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    stork.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    stork.\"web_sales_item_name\" as \"web_sales_item_name\",\n    stork.\"_virtual_1496978012803723\" * 100.0 / parakeet.\"_virtual_341251569527357\" as \"revenueratio\"\nFROM\n    stork\n    LEFT OUTER JOIN parakeet on stork.\"web_sales_item_category\" = parakeet.\"web_sales_item_category\" AND stork.\"web_sales_item_class\" = parakeet.\"web_sales_item_class\" AND stork.\"web_sales_item_current_price\" = parakeet.\"web_sales_item_current_price\" AND stork.\"web_sales_item_desc\" = parakeet.\"web_sales_item_desc\" AND stork.\"web_sales_item_name\" = parakeet.\"web_sales_item_name\"),\nturkey as (\nSELECT\n    hard.\"web_sales_item_category\" as \"web_sales_item_category\",\n    hard.\"web_sales_item_class\" as \"web_sales_item_class\",\n    hard.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    hard.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    hard.\"web_sales_item_name\" as \"web_sales_item_name\",\n    hard.\"revenueratio\" as \"revenueratio\",\n    stork.\"itemrevenue\" as \"itemrevenue\"\nFROM\n    hard\n    LEFT OUTER JOIN stork on hard.\"web_sales_item_category\" = stork.\"web_sales_item_category\" AND hard.\"web_sales_item_class\" = stork.\"web_sales_item_class\" AND hard.\"web_sales_item_current_price\" = stork.\"web_sales_item_current_price\" AND hard.\"web_sales_item_desc\" = stork.\"web_sales_item_desc\" AND hard.\"web_sales_item_name\" = stork.\"web_sales_item_name\")\nSELECT\n    turkey.\"web_sales_item_name\" as \"web_sales_item_name\",\n    turkey.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    turkey.\"web_sales_item_category\" as \"web_sales_item_category\",\n    turkey.\"web_sales_item_class\" as \"web_sales_item_class\",\n    turkey.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    turkey.\"itemrevenue\" as \"itemrevenue\",\n    turkey.\"revenueratio\" as \"revenueratio\"\nFROM\n    turkey\nWHERE\n    turkey.\"itemrevenue\" is not null\n\nORDER BY \n    turkey.\"web_sales_item_category\" asc,\n    turkey.\"web_sales_item_class\" asc,\n    turkey.\"web_sales_item_name\" asc,\n    turkey.\"web_sales_item_desc\" asc,\n    turkey.\"revenueratio\" asc\nLIMIT (100)"
}