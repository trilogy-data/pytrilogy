{
    "query_id": 12,
    "parse_time": 3.308144,
    "exec_time": 1.189378,
    "comp_time": 0.130803,
    "generated_sql": "\nWITH \ntrite as (\nSELECT\n    web_sales.\"WS_EXT_SALES_PRICE\" as \"web_sales_external_sales_price\",\n    date.\"D_DATE\" as \"web_sales_date_date\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    web_sales.\"WS_ORDER_NUMBER\" as \"web_sales_order_number\",\n    web_sales.\"WS_ITEM_SK\" as \"web_sales_item_id\"\nFROM\n    memory.web_sales as web_sales\n    LEFT OUTER JOIN memory.date_dim as date on web_sales.\"WS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.item as items on web_sales.\"WS_ITEM_SK\" = items.\"I_ITEM_SK\"),\nmartin as (\nSELECT\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\"\nFROM\n    memory.item as items\nGROUP BY \n    items.\"I_ITEM_DESC\",\n    items.\"I_CURRENT_PRICE\",\n    items.\"I_ITEM_ID\",\n    items.\"I_CATEGORY\",\n    items.\"I_CLASS\"),\npelican as (\nSELECT\n    CASE WHEN trite.\"web_sales_date_date\" >= cast('1999-02-22' as date) and trite.\"web_sales_date_date\" <= cast('1999-03-24' as date) and trite.\"web_sales_item_category\" in ( 'Sports','Books','Home' ) THEN trite.\"web_sales_external_sales_price\" ELSE NULL END as \"relevant_sales\",\n    trite.\"web_sales_order_number\" as \"web_sales_order_number\",\n    trite.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    trite),\nshrike as (\nSELECT\n    pelican.\"relevant_sales\" as \"relevant_sales\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    pelican.\"web_sales_order_number\" as \"web_sales_order_number\",\n    pelican.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    pelican\n    LEFT OUTER JOIN memory.item as items on pelican.\"web_sales_item_id\" = items.\"I_ITEM_SK\"),\ncivet as (\nSELECT\n    sum(shrike.\"relevant_sales\") as \"itemrevenue\",\n    shrike.\"web_sales_item_category\" as \"web_sales_item_category\",\n    shrike.\"web_sales_item_class\" as \"web_sales_item_class\",\n    shrike.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    shrike.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    shrike.\"web_sales_item_name\" as \"web_sales_item_name\",\n    sum(shrike.\"relevant_sales\") as \"_virtual_1496978012803723\"\nFROM\n    shrike\nGROUP BY \n    shrike.\"web_sales_item_desc\",\n    shrike.\"web_sales_item_class\",\n    shrike.\"web_sales_item_current_price\",\n    shrike.\"web_sales_item_name\",\n    shrike.\"web_sales_item_category\"),\nyellow as (\nSELECT\n    sum(shrike.\"relevant_sales\") as \"_virtual_341251569527357\",\n    shrike.\"web_sales_item_class\" as \"web_sales_item_class\"\nFROM\n    shrike\nGROUP BY \n    shrike.\"web_sales_item_class\"),\nrambunctious as (\nSELECT\n    martin.\"web_sales_item_class\" as \"web_sales_item_class\",\n    martin.\"web_sales_item_category\" as \"web_sales_item_category\",\n    martin.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    martin.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    martin.\"web_sales_item_name\" as \"web_sales_item_name\",\n    yellow.\"_virtual_341251569527357\" as \"_virtual_341251569527357\"\nFROM\n    martin\n    LEFT OUTER JOIN yellow on ((martin.\"web_sales_item_class\" is null and yellow.\"web_sales_item_class\" is null) or (martin.\"web_sales_item_class\" = yellow.\"web_sales_item_class\"))),\nlion as (\nSELECT\n    civet.\"web_sales_item_category\" as \"web_sales_item_category\",\n    civet.\"web_sales_item_class\" as \"web_sales_item_class\",\n    civet.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    civet.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    civet.\"web_sales_item_name\" as \"web_sales_item_name\",\n    civet.\"_virtual_1496978012803723\" * 100.0 / rambunctious.\"_virtual_341251569527357\" as \"revenueratio\"\nFROM\n    civet\n    LEFT OUTER JOIN rambunctious on ((civet.\"web_sales_item_category\" is null and rambunctious.\"web_sales_item_category\" is null) or (civet.\"web_sales_item_category\" = rambunctious.\"web_sales_item_category\")) AND ((civet.\"web_sales_item_class\" is null and rambunctious.\"web_sales_item_class\" is null) or (civet.\"web_sales_item_class\" = rambunctious.\"web_sales_item_class\")) AND ((civet.\"web_sales_item_current_price\" is null and rambunctious.\"web_sales_item_current_price\" is null) or (civet.\"web_sales_item_current_price\" = rambunctious.\"web_sales_item_current_price\")) AND ((civet.\"web_sales_item_desc\" is null and rambunctious.\"web_sales_item_desc\" is null) or (civet.\"web_sales_item_desc\" = rambunctious.\"web_sales_item_desc\")) AND civet.\"web_sales_item_name\" = rambunctious.\"web_sales_item_name\"),\ntearful as (\nSELECT\n    lion.\"web_sales_item_category\" as \"web_sales_item_category\",\n    lion.\"web_sales_item_class\" as \"web_sales_item_class\",\n    lion.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    lion.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    lion.\"web_sales_item_name\" as \"web_sales_item_name\",\n    lion.\"revenueratio\" as \"revenueratio\",\n    civet.\"itemrevenue\" as \"itemrevenue\"\nFROM\n    lion\n    LEFT OUTER JOIN civet on ((lion.\"web_sales_item_category\" is null and civet.\"web_sales_item_category\" is null) or (lion.\"web_sales_item_category\" = civet.\"web_sales_item_category\")) AND ((lion.\"web_sales_item_class\" is null and civet.\"web_sales_item_class\" is null) or (lion.\"web_sales_item_class\" = civet.\"web_sales_item_class\")) AND ((lion.\"web_sales_item_current_price\" is null and civet.\"web_sales_item_current_price\" is null) or (lion.\"web_sales_item_current_price\" = civet.\"web_sales_item_current_price\")) AND ((lion.\"web_sales_item_desc\" is null and civet.\"web_sales_item_desc\" is null) or (lion.\"web_sales_item_desc\" = civet.\"web_sales_item_desc\")) AND lion.\"web_sales_item_name\" = civet.\"web_sales_item_name\")\nSELECT\n    tearful.\"web_sales_item_name\" as \"web_sales_item_name\",\n    tearful.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    tearful.\"web_sales_item_category\" as \"web_sales_item_category\",\n    tearful.\"web_sales_item_class\" as \"web_sales_item_class\",\n    tearful.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    tearful.\"itemrevenue\" as \"itemrevenue\",\n    tearful.\"revenueratio\" as \"revenueratio\"\nFROM\n    tearful\nWHERE\n    tearful.\"itemrevenue\" is not null\n\nORDER BY \n    tearful.\"web_sales_item_category\" asc,\n    tearful.\"web_sales_item_class\" asc,\n    tearful.\"web_sales_item_name\" asc,\n    tearful.\"web_sales_item_desc\" asc,\n    tearful.\"revenueratio\" asc\nLIMIT (100)"
}