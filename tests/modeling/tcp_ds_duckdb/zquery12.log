{
    "query_id": 12,
    "parse_time": 5.532384,
    "exec_time": 0.767223,
    "comp_time": 0.163508,
    "generated_sql": "\nWITH \nbewildered as (\nSELECT\n    web_sales.\"WS_EXT_SALES_PRICE\" as \"web_sales_external_sales_price\",\n    date.\"D_DATE\" as \"web_sales_date_date\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    web_sales.\"WS_ORDER_NUMBER\" as \"web_sales_order_number\",\n    web_sales.\"WS_ITEM_SK\" as \"web_sales_item_id\"\nFROM\n    memory.web_sales as web_sales\n    LEFT OUTER JOIN memory.date_dim as date on web_sales.\"WS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.item as items on web_sales.\"WS_ITEM_SK\" = items.\"I_ITEM_SK\"),\nmarlin as (\nSELECT\n    CASE WHEN bewildered.\"web_sales_date_date\" >= cast('1999-02-22' as date) and bewildered.\"web_sales_date_date\" <= cast('1999-03-24' as date) and bewildered.\"web_sales_item_category\" in ( 'Sports','Books','Home' ) THEN bewildered.\"web_sales_external_sales_price\" ELSE NULL END as \"relevant_sales\",\n    bewildered.\"web_sales_order_number\" as \"web_sales_order_number\",\n    bewildered.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    bewildered),\nfinch as (\nSELECT\n    marlin.\"relevant_sales\" as \"relevant_sales\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    marlin.\"web_sales_order_number\" as \"web_sales_order_number\",\n    marlin.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    marlin\n    LEFT OUTER JOIN memory.item as items on marlin.\"web_sales_item_id\" = items.\"I_ITEM_SK\"),\nquail as (\nSELECT\n    sum(finch.\"relevant_sales\") as \"itemrevenue\",\n    finch.\"web_sales_item_category\" as \"web_sales_item_category\",\n    finch.\"web_sales_item_class\" as \"web_sales_item_class\",\n    finch.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    finch.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    finch.\"web_sales_item_name\" as \"web_sales_item_name\",\n    sum(finch.\"relevant_sales\") as \"_virtual_1496978012803723\"\nFROM\n    finch\nGROUP BY \n    finch.\"web_sales_item_desc\",\n    finch.\"web_sales_item_class\",\n    finch.\"web_sales_item_current_price\",\n    finch.\"web_sales_item_category\",\n    finch.\"web_sales_item_name\"),\nconcerned as (\nSELECT\n    sum(finch.\"relevant_sales\") as \"_virtual_341251569527357\",\n    finch.\"web_sales_item_class\" as \"web_sales_item_class\"\nFROM\n    finch\nGROUP BY \n    finch.\"web_sales_item_class\"),\nparrot as (\nSELECT\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\"\nFROM\n    memory.item as items\nGROUP BY \n    items.\"I_CURRENT_PRICE\",\n    items.\"I_CLASS\",\n    items.\"I_ITEM_ID\",\n    items.\"I_CATEGORY\",\n    items.\"I_ITEM_DESC\"),\nfaithful as (\nSELECT\n    parrot.\"web_sales_item_class\" as \"web_sales_item_class\",\n    parrot.\"web_sales_item_category\" as \"web_sales_item_category\",\n    parrot.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    parrot.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    parrot.\"web_sales_item_name\" as \"web_sales_item_name\",\n    concerned.\"_virtual_341251569527357\" as \"_virtual_341251569527357\"\nFROM\n    parrot\n    LEFT OUTER JOIN concerned on parrot.\"web_sales_item_class\" = concerned.\"web_sales_item_class\"),\nsweltering as (\nSELECT\n    quail.\"web_sales_item_category\" as \"web_sales_item_category\",\n    quail.\"web_sales_item_class\" as \"web_sales_item_class\",\n    quail.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    quail.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    quail.\"web_sales_item_name\" as \"web_sales_item_name\",\n    quail.\"_virtual_1496978012803723\" * 100.0 / faithful.\"_virtual_341251569527357\" as \"revenueratio\"\nFROM\n    quail\n    LEFT OUTER JOIN faithful on quail.\"web_sales_item_category\" = faithful.\"web_sales_item_category\" AND quail.\"web_sales_item_class\" = faithful.\"web_sales_item_class\" AND quail.\"web_sales_item_current_price\" = faithful.\"web_sales_item_current_price\" AND quail.\"web_sales_item_desc\" = faithful.\"web_sales_item_desc\" AND quail.\"web_sales_item_name\" = faithful.\"web_sales_item_name\"),\nuneven as (\nSELECT\n    sweltering.\"web_sales_item_category\" as \"web_sales_item_category\",\n    sweltering.\"web_sales_item_class\" as \"web_sales_item_class\",\n    sweltering.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    sweltering.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    sweltering.\"web_sales_item_name\" as \"web_sales_item_name\",\n    sweltering.\"revenueratio\" as \"revenueratio\",\n    quail.\"itemrevenue\" as \"itemrevenue\"\nFROM\n    sweltering\n    LEFT OUTER JOIN quail on sweltering.\"web_sales_item_category\" = quail.\"web_sales_item_category\" AND sweltering.\"web_sales_item_class\" = quail.\"web_sales_item_class\" AND sweltering.\"web_sales_item_current_price\" = quail.\"web_sales_item_current_price\" AND sweltering.\"web_sales_item_desc\" = quail.\"web_sales_item_desc\" AND sweltering.\"web_sales_item_name\" = quail.\"web_sales_item_name\")\nSELECT\n    uneven.\"web_sales_item_name\" as \"web_sales_item_name\",\n    uneven.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    uneven.\"web_sales_item_category\" as \"web_sales_item_category\",\n    uneven.\"web_sales_item_class\" as \"web_sales_item_class\",\n    uneven.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    uneven.\"itemrevenue\" as \"itemrevenue\",\n    uneven.\"revenueratio\" as \"revenueratio\"\nFROM\n    uneven\nWHERE\n    uneven.\"itemrevenue\" is not null\n\nORDER BY \n    uneven.\"web_sales_item_category\" asc,\n    uneven.\"web_sales_item_class\" asc,\n    uneven.\"web_sales_item_name\" asc,\n    uneven.\"web_sales_item_desc\" asc,\n    uneven.\"revenueratio\" asc\nLIMIT (100)"
}