query_id = 2
parse_time = 9.752635
exec_time = 0.240756
comp_time = 0.07253
gen_length = 9968
generated_sql = """

WITH 
abundant as (
SELECT
    date_date.\"D_WEEK_SEQ\" as \"relevent_week_seq\"
FROM
    memory.date_dim as date_date
WHERE
    cast(date_date.\"D_YEAR\" as int) in (2001,2002)
),
cooperative as (
SELECT
    date_date.\"D_DATE_SK\" as \"date_id\",
    date_date.\"D_DOW\" as \"date_day_of_week\",
    date_date.\"D_WEEK_SEQ\" as \"date_week_seq\",
    web_sales_web_sales.\"WS_EXT_SALES_PRICE\" as \"web_sales_extra_sales_price\",
    web_sales_web_sales.\"WS_ITEM_SK\" as \"web_sales_item_id\",
    web_sales_web_sales.\"WS_ORDER_NUMBER\" as \"web_sales_order_number\"
FROM
    memory.date_dim as date_date
    LEFT OUTER JOIN memory.web_sales as web_sales_web_sales on date_date.\"D_DATE_SK\" = web_sales_web_sales.\"WS_SOLD_DATE_SK\"
    LEFT OUTER JOIN memory.date_dim as catalog_sales_date_date on cast(date_date.\"D_DATE\" as date) = cast(catalog_sales_date_date.\"D_DATE\" as date) AND cast(date_date.\"D_YEAR\" as int) = cast(catalog_sales_date_date.\"D_YEAR\" as int) AND date_date.\"D_DATE\" = catalog_sales_date_date.\"D_DATE\" AND date_date.\"D_DATE_ID\" = catalog_sales_date_date.\"D_DATE_ID\" AND date_date.\"D_DATE_SK\" = catalog_sales_date_date.\"D_DATE_SK\" AND date_date.\"D_DOW\" = catalog_sales_date_date.\"D_DOW\" AND date_date.\"D_MOY\" = catalog_sales_date_date.\"D_MOY\" AND date_date.\"D_QOY\" = catalog_sales_date_date.\"D_QOY\" AND date_date.\"D_WEEK_SEQ\" = catalog_sales_date_date.\"D_WEEK_SEQ\" AND date_date.\"D_YEAR\" = catalog_sales_date_date.\"D_YEAR\" AND web_sales_web_sales.\"WS_SOLD_DATE_SK\" = catalog_sales_date_date.\"D_DATE_SK\"),
wakeful as (
SELECT
    catalog_sales_catalog_sales.\"CS_EXT_SALES_PRICE\" as \"catalog_sales_extra_sales_price\",
    catalog_sales_catalog_sales.\"CS_ITEM_SK\" as \"catalog_sales_item_id\",
    catalog_sales_catalog_sales.\"CS_ORDER_NUMBER\" as \"catalog_sales_order_number\",
    date_date.\"D_DATE_SK\" as \"date_id\",
    date_date.\"D_DOW\" as \"date_day_of_week\",
    date_date.\"D_WEEK_SEQ\" as \"date_week_seq\"
FROM
    memory.date_dim as date_date
    LEFT OUTER JOIN memory.catalog_sales as catalog_sales_catalog_sales on date_date.\"D_DATE_SK\" = catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\"
    LEFT OUTER JOIN memory.date_dim as catalog_sales_date_date on cast(date_date.\"D_DATE\" as date) = cast(catalog_sales_date_date.\"D_DATE\" as date) AND cast(date_date.\"D_YEAR\" as int) = cast(catalog_sales_date_date.\"D_YEAR\" as int) AND catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" = catalog_sales_date_date.\"D_DATE_SK\" AND date_date.\"D_DATE\" = catalog_sales_date_date.\"D_DATE\" AND date_date.\"D_DATE_ID\" = catalog_sales_date_date.\"D_DATE_ID\" AND date_date.\"D_DATE_SK\" = catalog_sales_date_date.\"D_DATE_SK\" AND date_date.\"D_DOW\" = catalog_sales_date_date.\"D_DOW\" AND date_date.\"D_MOY\" = catalog_sales_date_date.\"D_MOY\" AND date_date.\"D_QOY\" = catalog_sales_date_date.\"D_QOY\" AND date_date.\"D_WEEK_SEQ\" = catalog_sales_date_date.\"D_WEEK_SEQ\" AND date_date.\"D_YEAR\" = catalog_sales_date_date.\"D_YEAR\"),
uneven as (
SELECT
    abundant.\"relevent_week_seq\" as \"relevent_week_seq\"
FROM
    abundant
GROUP BY 
    abundant.\"relevent_week_seq\"),
questionable as (
SELECT
    cooperative.\"date_week_seq\" as \"date_week_seq\",
    sum(CASE
	WHEN cooperative.\"date_day_of_week\" = 0 THEN cooperative.\"web_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_7925017690385460\",
    sum(CASE
	WHEN cooperative.\"date_day_of_week\" = 1 THEN cooperative.\"web_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_4241182155400568\",
    sum(CASE
	WHEN cooperative.\"date_day_of_week\" = 2 THEN cooperative.\"web_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_1509796867940095\",
    sum(CASE
	WHEN cooperative.\"date_day_of_week\" = 3 THEN cooperative.\"web_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_7659915543538790\",
    sum(CASE
	WHEN cooperative.\"date_day_of_week\" = 4 THEN cooperative.\"web_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_8414085047694243\",
    sum(CASE
	WHEN cooperative.\"date_day_of_week\" = 5 THEN cooperative.\"web_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_2674229030918237\",
    sum(CASE
	WHEN cooperative.\"date_day_of_week\" = 6 THEN cooperative.\"web_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_628571582465146\"
FROM
    cooperative
GROUP BY 
    cooperative.\"date_week_seq\"),
cheerful as (
SELECT
    sum(CASE
	WHEN wakeful.\"date_day_of_week\" = 0 THEN wakeful.\"catalog_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_1839451380137276\",
    sum(CASE
	WHEN wakeful.\"date_day_of_week\" = 1 THEN wakeful.\"catalog_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_2005409577793585\",
    sum(CASE
	WHEN wakeful.\"date_day_of_week\" = 2 THEN wakeful.\"catalog_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_1900390020562438\",
    sum(CASE
	WHEN wakeful.\"date_day_of_week\" = 3 THEN wakeful.\"catalog_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_7830132902767713\",
    sum(CASE
	WHEN wakeful.\"date_day_of_week\" = 4 THEN wakeful.\"catalog_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_8675768522390353\",
    sum(CASE
	WHEN wakeful.\"date_day_of_week\" = 5 THEN wakeful.\"catalog_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_3072933958886594\",
    sum(CASE
	WHEN wakeful.\"date_day_of_week\" = 6 THEN wakeful.\"catalog_sales_extra_sales_price\"
	ELSE 0.0
	END) as \"_virt_1686049322505568\",
    wakeful.\"date_week_seq\" as \"date_week_seq\"
FROM
    wakeful
GROUP BY 
    wakeful.\"date_week_seq\"),
yummy as (
SELECT
    cheerful.\"date_week_seq\" as \"yearly_agg_date_week_seq\",
    questionable.\"_virt_1509796867940095\" + cheerful.\"_virt_1900390020562438\" as \"yearly_agg_tuesday_sales\",
    questionable.\"_virt_2674229030918237\" + cheerful.\"_virt_3072933958886594\" as \"yearly_agg_friday_sales\",
    questionable.\"_virt_4241182155400568\" + cheerful.\"_virt_2005409577793585\" as \"yearly_agg_monday_sales\",
    questionable.\"_virt_628571582465146\" + cheerful.\"_virt_1686049322505568\" as \"yearly_agg_saturday_sales\",
    questionable.\"_virt_7659915543538790\" + cheerful.\"_virt_7830132902767713\" as \"yearly_agg_wednesday_sales\",
    questionable.\"_virt_7925017690385460\" + cheerful.\"_virt_1839451380137276\" as \"yearly_agg_sunday_sales\",
    questionable.\"_virt_8414085047694243\" + cheerful.\"_virt_8675768522390353\" as \"yearly_agg_thursday_sales\"
FROM
    cheerful
    INNER JOIN questionable on cheerful.\"date_week_seq\" = questionable.\"date_week_seq\"
WHERE
    cheerful.\"date_week_seq\" in (select uneven.\"relevent_week_seq\" from uneven where uneven.\"relevent_week_seq\" is not null)
),
juicy as (
SELECT
    lead(yummy.\"yearly_agg_friday_sales\", 53) over (order by yummy.\"yearly_agg_date_week_seq\" asc ) as \"_virt_6193053320794901\",
    lead(yummy.\"yearly_agg_monday_sales\", 53) over (order by yummy.\"yearly_agg_date_week_seq\" asc ) as \"_virt_7130145607898357\",
    lead(yummy.\"yearly_agg_saturday_sales\", 53) over (order by yummy.\"yearly_agg_date_week_seq\" asc ) as \"_virt_8034893742859652\",
    lead(yummy.\"yearly_agg_sunday_sales\", 53) over (order by yummy.\"yearly_agg_date_week_seq\" asc ) as \"_virt_8280558569351677\",
    lead(yummy.\"yearly_agg_thursday_sales\", 53) over (order by yummy.\"yearly_agg_date_week_seq\" asc ) as \"_virt_3540146175412427\",
    lead(yummy.\"yearly_agg_tuesday_sales\", 53) over (order by yummy.\"yearly_agg_date_week_seq\" asc ) as \"_virt_6639291296266475\",
    lead(yummy.\"yearly_agg_wednesday_sales\", 53) over (order by yummy.\"yearly_agg_date_week_seq\" asc ) as \"_virt_7069585042880555\",
    yummy.\"yearly_agg_date_week_seq\" as \"yearly_agg_date_week_seq\",
    yummy.\"yearly_agg_friday_sales\" as \"yearly_agg_friday_sales\",
    yummy.\"yearly_agg_monday_sales\" as \"yearly_agg_monday_sales\",
    yummy.\"yearly_agg_saturday_sales\" as \"yearly_agg_saturday_sales\",
    yummy.\"yearly_agg_sunday_sales\" as \"yearly_agg_sunday_sales\",
    yummy.\"yearly_agg_thursday_sales\" as \"yearly_agg_thursday_sales\",
    yummy.\"yearly_agg_tuesday_sales\" as \"yearly_agg_tuesday_sales\",
    yummy.\"yearly_agg_wednesday_sales\" as \"yearly_agg_wednesday_sales\"
FROM
    yummy),
vacuous as (
SELECT
    juicy.\"yearly_agg_date_week_seq\" as \"yearly_agg_date_week_seq\",
    juicy.\"yearly_agg_sunday_sales\" as \"yearly_agg_sunday_sales\",
    round(juicy.\"yearly_agg_friday_sales\" / juicy.\"_virt_6193053320794901\",2) as \"friday_increase\",
    round(juicy.\"yearly_agg_monday_sales\" / juicy.\"_virt_7130145607898357\",2) as \"monday_increase\",
    round(juicy.\"yearly_agg_saturday_sales\" / juicy.\"_virt_8034893742859652\",2) as \"saturday_increase\",
    round(juicy.\"yearly_agg_sunday_sales\" / juicy.\"_virt_8280558569351677\",2) as \"sunday_increase\",
    round(juicy.\"yearly_agg_thursday_sales\" / juicy.\"_virt_3540146175412427\",2) as \"thursday_increase\",
    round(juicy.\"yearly_agg_tuesday_sales\" / juicy.\"_virt_6639291296266475\",2) as \"tuesday_increase\",
    round(juicy.\"yearly_agg_wednesday_sales\" / juicy.\"_virt_7069585042880555\",2) as \"wednesday_increase\"
FROM
    juicy),
concerned as (
SELECT
    lead(vacuous.\"yearly_agg_sunday_sales\", 53) over (order by vacuous.\"yearly_agg_date_week_seq\" asc ) as \"filter_flag\",
    vacuous.\"friday_increase\" as \"friday_increase\",
    vacuous.\"monday_increase\" as \"monday_increase\",
    vacuous.\"saturday_increase\" as \"saturday_increase\",
    vacuous.\"sunday_increase\" as \"sunday_increase\",
    vacuous.\"thursday_increase\" as \"thursday_increase\",
    vacuous.\"tuesday_increase\" as \"tuesday_increase\",
    vacuous.\"wednesday_increase\" as \"wednesday_increase\",
    vacuous.\"yearly_agg_date_week_seq\" as \"yearly_agg_date_week_seq\"
FROM
    vacuous)
SELECT
    concerned.\"yearly_agg_date_week_seq\" as \"yearly_agg_date_week_seq\",
    concerned.\"sunday_increase\" as \"sunday_increase\",
    concerned.\"monday_increase\" as \"monday_increase\",
    concerned.\"tuesday_increase\" as \"tuesday_increase\",
    concerned.\"wednesday_increase\" as \"wednesday_increase\",
    concerned.\"thursday_increase\" as \"thursday_increase\",
    concerned.\"friday_increase\" as \"friday_increase\",
    concerned.\"saturday_increase\" as \"saturday_increase\"
FROM
    concerned
WHERE
    concerned.\"filter_flag\" is not null

ORDER BY 
    concerned.\"yearly_agg_date_week_seq\" asc nulls first"""
