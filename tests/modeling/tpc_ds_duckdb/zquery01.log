query_id = 1
gen_length = 3269
generated_sql = """

WITH 
thoughtful as (
SELECT
    \"returns_store_returns\".\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    \"returns_store_returns\".\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    \"returns_store_returns\".\"SR_STORE_SK\" as \"returns_store_id\"
FROM
    \"memory\".\"store_returns\" as \"returns_store_returns\"
GROUP BY 
    \"returns_store_returns\".\"SR_CUSTOMER_SK\",
    \"returns_store_returns\".\"SR_RETURNED_DATE_SK\",
    \"returns_store_returns\".\"SR_STORE_SK\"),
questionable as (
SELECT
    \"returns_store_returns\".\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    \"returns_store_store\".\"S_STORE_SK\" as \"returns_store_id\",
    sum(\"returns_store_returns\".\"SR_RETURN_AMT\") as \"total_returns\"
FROM
    \"memory\".\"store_returns\" as \"returns_store_returns\"
    INNER JOIN \"memory\".\"store\" as \"returns_store_store\" on \"returns_store_returns\".\"SR_STORE_SK\" = \"returns_store_store\".\"S_STORE_SK\"
    INNER JOIN \"memory\".\"date_dim\" as \"returns_return_date_date\" on \"returns_store_returns\".\"SR_RETURNED_DATE_SK\" = \"returns_return_date_date\".\"D_DATE_SK\"
WHERE
    \"returns_store_store\".\"S_STATE\" = 'TN' and cast(\"returns_return_date_date\".\"D_YEAR\" as int) = 2000

GROUP BY 
    \"returns_store_returns\".\"SR_CUSTOMER_SK\",
    \"returns_store_store\".\"S_STORE_SK\"),
cooperative as (
SELECT
    \"returns_customer_customers\".\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    \"returns_customer_customers\".\"C_CUSTOMER_SK\" as \"returns_customer_id\",
    \"returns_store_store\".\"S_STORE_SK\" as \"returns_store_id\"
FROM
    \"thoughtful\"
    INNER JOIN \"memory\".\"store\" as \"returns_store_store\" on \"thoughtful\".\"returns_store_id\" = \"returns_store_store\".\"S_STORE_SK\"
    INNER JOIN \"memory\".\"customer\" as \"returns_customer_customers\" on \"thoughtful\".\"returns_customer_id\" = \"returns_customer_customers\".\"C_CUSTOMER_SK\"
    INNER JOIN \"memory\".\"date_dim\" as \"returns_return_date_date\" on \"thoughtful\".\"returns_return_date_id\" = \"returns_return_date_date\".\"D_DATE_SK\"
WHERE
    \"returns_store_store\".\"S_STATE\" = 'TN' and cast(\"returns_return_date_date\".\"D_YEAR\" as int) = 2000

GROUP BY 
    \"returns_customer_customers\".\"C_CUSTOMER_ID\",
    \"returns_customer_customers\".\"C_CUSTOMER_SK\",
    \"returns_store_store\".\"S_STORE_SK\"),
yummy as (
SELECT
    \"questionable\".\"returns_store_id\" as \"returns_store_id\",
    avg(\"questionable\".\"total_returns\") as \"avg_store_returns\"
FROM
    \"questionable\"
GROUP BY 
    \"questionable\".\"returns_store_id\"),
uneven as (
SELECT
    \"cooperative\".\"returns_customer_text_id\" as \"returns_customer_text_id\",
    \"cooperative\".\"returns_store_id\" as \"returns_store_id\",
    \"questionable\".\"total_returns\" as \"total_returns\"
FROM
    \"cooperative\"
    INNER JOIN \"questionable\" on \"cooperative\".\"returns_customer_id\" = \"questionable\".\"returns_customer_id\" AND \"cooperative\".\"returns_store_id\" = \"questionable\".\"returns_store_id\"
GROUP BY 
    \"cooperative\".\"returns_customer_text_id\",
    \"cooperative\".\"returns_store_id\",
    \"questionable\".\"total_returns\")
SELECT
    \"uneven\".\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    \"uneven\"
    INNER JOIN \"yummy\" on \"uneven\".\"returns_store_id\" = \"yummy\".\"returns_store_id\"
WHERE
    \"uneven\".\"total_returns\" > ( 1.2 * \"yummy\".\"avg_store_returns\" )

ORDER BY 
    \"uneven\".\"returns_customer_text_id\" asc
LIMIT (100)"""
