query_id = 7
gen_length = 12903
generated_sql = """

WITH 
thoughtful as (
-- Target: Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>. Group: False Source: SourceType.MERGE.
-- Joins: inner join store_sales_store_sales on wakeful.store_sales.customer_demographic.id=store_sales.customer_demographic.id, inner join store_sales_date_date on cheerful.store_sales.date.id=store_sales.date.id, inner join store_sales_item_items on cheerful.store_sales.item.id=store_sales.item.id, inner join store_sales_promotion_promotion on cheerful.store_sales.promotion.id=store_sales.promotion.id.
-- Source Map: {'store_sales.item.name': ['store_sales_item_items'], 'store_sales.item.id': ['store_sales_item_items'], 'store_sales.date.year': ['store_sales_date_date'], 'store_sales.date.id': ['store_sales_date_date'], 'store_sales.promotion.channel_event': ['store_sales_promotion_promotion'], 'store_sales.promotion.id': ['store_sales_promotion_promotion'], 'store_sales.promotion.channel_email': ['store_sales_promotion_promotion'], 'store_sales.customer_demographic.marital_status': ['store_sales_customer_demographic_customer_demographics'], 'store_sales.customer_demographic.education_status': ['store_sales_customer_demographic_customer_demographics'], 'store_sales.customer_demographic.gender': ['store_sales_customer_demographic_customer_demographics'], 'store_sales.customer_demographic.id': ['store_sales_customer_demographic_customer_demographics'], 'store_sales.ticket_number': ['store_sales_store_sales'], 'store_sales.coupon_amt': ['store_sales_store_sales'], 'store_sales.quantity': ['store_sales_store_sales'], 'store_sales.list_price': ['store_sales_store_sales'], 'store_sales.sales_price': ['store_sales_store_sales'], 'store_sales.item.size': ['store_sales_item_items'], 'store_sales.item.brand_id': ['store_sales_item_items'], 'store_sales.item.manufacturer_id': ['store_sales_item_items'], 'store_sales.item.class': ['store_sales_item_items'], 'store_sales.item.desc': ['store_sales_item_items'], 'store_sales.item.category': ['store_sales_item_items'], 'store_sales.item.current_price': ['store_sales_item_items'], 'store_sales.item.color': ['store_sales_item_items'], 'store_sales.item.manager_id': ['store_sales_item_items'], 'store_sales.item.units': ['store_sales_item_items'], 'store_sales.item.brand_name': ['store_sales_item_items'], 'store_sales.date._year_string': ['store_sales_date_date'], 'store_sales.date.date_string': ['store_sales_date_date'], 'store_sales.date.date': ['store_sales_date_date'], 'store_sales.date.day_of_week': ['store_sales_date_date'], 'store_sales.date._date_string': ['store_sales_date_date'], 'store_sales.date.week_seq': ['store_sales_date_date'], 'store_sales.date.quarter': ['store_sales_date_date'], 'store_sales.date.month_of_year': ['store_sales_date_date'], 'store_sales.promotion.cost': ['store_sales_promotion_promotion'], 'store_sales.promotion.channel_catalog': ['store_sales_promotion_promotion'], 'store_sales.promotion.string_id': ['store_sales_promotion_promotion'], 'store_sales.customer_demographic.employed_dependent_count': ['store_sales_customer_demographic_customer_demographics'], 'store_sales.customer_demographic.college_dependent_count': ['store_sales_customer_demographic_customer_demographics'], 'store_sales.customer_demographic.purchase_estimate': ['store_sales_customer_demographic_customer_demographics'], 'store_sales.customer_demographic.dependent_count': ['store_sales_customer_demographic_customer_demographics'], 'store_sales.customer_demographic.credit_rating': ['store_sales_customer_demographic_customer_demographics'], 'store_sales.ext_discount_amount': ['store_sales_store_sales'], 'store_sales.net_profit': ['store_sales_store_sales'], 'store_sales.ext_list_price': ['store_sales_store_sales'], 'store_sales.time.id': ['store_sales_store_sales'], 'store_sales.ext_wholesale_cost': ['store_sales_store_sales'], 'store_sales.store.id': ['store_sales_store_sales'], 'store_sales.net_paid': ['store_sales_store_sales'], 'store_sales.customer.id': ['store_sales_store_sales'], 'store_sales.ext_sales_price': ['store_sales_store_sales']}.
-- Output: store_sales.coupon_amt@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.customer_demographic.education_status@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.customer_demographic.gender@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.customer_demographic.id@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.customer_demographic.marital_status@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.date.id@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.date.year@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.item.id@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.item.name@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.list_price@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.promotion.channel_email@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.promotion.channel_event@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.promotion.id@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.quantity@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.sales_price@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>, store_sales.ticket_number@Grain<store_sales.customer_demographic.id,store_sales.date.id,store_sales.item.id,store_sales.promotion.id,store_sales.ticket_number>.
-- Inputs: store_sales.coupon_amt@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.customer_demographic.education_status@Grain<store_sales.customer_demographic.id>, store_sales.customer_demographic.gender@Grain<store_sales.customer_demographic.id>, store_sales.customer_demographic.id@Grain<store_sales.customer_demographic.id>, store_sales.customer_demographic.marital_status@Grain<store_sales.customer_demographic.id>, store_sales.date.id@Grain<store_sales.date.id>, store_sales.date.year@Grain<store_sales.date.id>, store_sales.item.id@Grain<store_sales.item.id>, store_sales.item.name@Grain<store_sales.item.id>, store_sales.list_price@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.promotion.channel_email@Grain<store_sales.promotion.id>, store_sales.promotion.channel_event@Grain<store_sales.promotion.id>, store_sales.promotion.id@Grain<store_sales.promotion.id>, store_sales.quantity@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.sales_price@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.ticket_number@Grain<store_sales.ticket_number>.
SELECT
    cast(store_sales_date_date.\"D_YEAR\" as int) as \"store_sales_date_year\",
    store_sales_customer_demographic_customer_demographics.\"CD_DEMO_SK\" as \"store_sales_customer_demographic_id\",
    store_sales_customer_demographic_customer_demographics.\"CD_EDUCATION_STATUS\" as \"store_sales_customer_demographic_education_status\",
    store_sales_customer_demographic_customer_demographics.\"CD_GENDER\" as \"store_sales_customer_demographic_gender\",
    store_sales_customer_demographic_customer_demographics.\"CD_MARITAL_STATUS\" as \"store_sales_customer_demographic_marital_status\",
    store_sales_date_date.\"D_DATE_SK\" as \"store_sales_date_id\",
    store_sales_item_items.\"I_ITEM_ID\" as \"store_sales_item_name\",
    store_sales_item_items.\"I_ITEM_SK\" as \"store_sales_item_id\",
    store_sales_promotion_promotion.\"P_CHANNEL_EMAIL\" as \"store_sales_promotion_channel_email\",
    store_sales_promotion_promotion.\"P_CHANNEL_EVENT\" as \"store_sales_promotion_channel_event\",
    store_sales_promotion_promotion.\"P_PROMO_SK\" as \"store_sales_promotion_id\",
    store_sales_store_sales.\"SS_COUPON_AMT\" as \"store_sales_coupon_amt\",
    store_sales_store_sales.\"SS_LIST_PRICE\" as \"store_sales_list_price\",
    store_sales_store_sales.\"SS_QUANTITY\" as \"store_sales_quantity\",
    store_sales_store_sales.\"SS_SALES_PRICE\" as \"store_sales_sales_price\",
    store_sales_store_sales.\"SS_TICKET_NUMBER\" as \"store_sales_ticket_number\"
FROM
    memory.customer_demographics as store_sales_customer_demographic_customer_demographics
    INNER JOIN memory.store_sales as store_sales_store_sales on store_sales_customer_demographic_customer_demographics.\"CD_DEMO_SK\" = store_sales_store_sales.\"SS_CDEMO_SK\"
    INNER JOIN memory.date_dim as store_sales_date_date on store_sales_store_sales.\"SS_SOLD_DATE_SK\" = store_sales_date_date.\"D_DATE_SK\"
    INNER JOIN memory.item as store_sales_item_items on store_sales_store_sales.\"SS_ITEM_SK\" = store_sales_item_items.\"I_ITEM_SK\"
    INNER JOIN memory.promotion as store_sales_promotion_promotion on store_sales_store_sales.\"SS_PROMO_SK\" = store_sales_promotion_promotion.\"P_PROMO_SK\"
WHERE
    store_sales_customer_demographic_customer_demographics.\"CD_GENDER\" = 'M' and store_sales_customer_demographic_customer_demographics.\"CD_MARITAL_STATUS\" = 'S' and store_sales_customer_demographic_customer_demographics.\"CD_EDUCATION_STATUS\" = 'College' and ( store_sales_promotion_promotion.\"P_CHANNEL_EMAIL\" = 'N' or store_sales_promotion_promotion.\"P_CHANNEL_EVENT\" = 'N' ) and cast(store_sales_date_date.\"D_YEAR\" as int) = 2000
)
-- Target: Grain<store_sales.item.name>. Group: True Source: SourceType.GROUP. References: thoughtful.
-- Source Map: {'store_sales.coupon_amt': ['thoughtful'], 'store_sales.customer_demographic.education_status': ['thoughtful'], 'store_sales.customer_demographic.gender': ['thoughtful'], 'store_sales.customer_demographic.id': ['thoughtful'], 'store_sales.customer_demographic.marital_status': ['thoughtful'], 'store_sales.date.id': ['thoughtful'], 'store_sales.date.year': ['thoughtful'], 'store_sales.item.id': ['thoughtful'], 'store_sales.item.name': ['thoughtful'], 'store_sales.list_price': ['thoughtful'], 'store_sales.promotion.channel_email': ['thoughtful'], 'store_sales.promotion.channel_event': ['thoughtful'], 'store_sales.promotion.id': ['thoughtful'], 'store_sales.quantity': ['thoughtful'], 'store_sales.sales_price': ['thoughtful'], 'store_sales.ticket_number': ['thoughtful'], 'local.avg_quantity': [], 'local.avg_list_price': [], 'local.avg_coupon_amt': [], 'local.avg_sales_price': []}.
-- Output: store_sales.item.name@Grain<store_sales.item.name>, local.avg_quantity@Grain<store_sales.item.name>, local.avg_list_price@Grain<store_sales.item.name>, local.avg_coupon_amt@Grain<store_sales.item.name>, local.avg_sales_price@Grain<store_sales.item.name>.
-- Inputs: store_sales.quantity@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.item.name@Grain<store_sales.item.id>, store_sales.ticket_number@Grain<store_sales.ticket_number>, store_sales.item.id@Grain<store_sales.item.id>, store_sales.list_price@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.coupon_amt@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.sales_price@Grain<store_sales.item.id,store_sales.ticket_number>.
-- Nullable: local.avg_quantity@Grain<store_sales.item.name>, local.avg_list_price@Grain<store_sales.item.name>, local.avg_coupon_amt@Grain<store_sales.item.name>, local.avg_sales_price@Grain<store_sales.item.name>.
SELECT
    thoughtful.\"store_sales_item_name\" as \"store_sales_item_name\",
    avg(thoughtful.\"store_sales_quantity\") as \"avg_quantity\",
    avg(thoughtful.\"store_sales_list_price\") as \"avg_list_price\",
    avg(thoughtful.\"store_sales_coupon_amt\") as \"avg_coupon_amt\",
    avg(thoughtful.\"store_sales_sales_price\") as \"avg_sales_price\"
FROM
    thoughtful
GROUP BY 
    thoughtful.\"store_sales_item_name\"
ORDER BY 
    thoughtful.\"store_sales_item_name\" asc
LIMIT (100)"""
