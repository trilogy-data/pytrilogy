query_id = 16
gen_length = 5072
generated_sql = """

WITH 
cooperative as (
SELECT
    cs_catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    cs_catalog_sales.\"CS_WAREHOUSE_SK\" as \"cs_warehouse_id\"
FROM
    memory.catalog_sales as cs_catalog_sales
GROUP BY 
    cs_catalog_sales.\"CS_ORDER_NUMBER\",
    cs_catalog_sales.\"CS_WAREHOUSE_SK\"),
thoughtful as (
SELECT
    cr_catalog_returns.\"CR_ORDER_NUMBER\" as \"cr_order_number\"
FROM
    memory.catalog_returns as cr_catalog_returns
GROUP BY 
    cr_catalog_returns.\"CR_ORDER_NUMBER\"),
questionable as (
SELECT
    cooperative.\"cs_order_number\" as \"cs_order_number\",
    count(cooperative.\"cs_warehouse_id\") as \"_virt_agg_count_3434120856223416\"
FROM
    cooperative
GROUP BY 
    cooperative.\"cs_order_number\"),
abundant as (
SELECT
    CASE WHEN questionable.\"_virt_agg_count_3434120856223416\" > 1 THEN questionable.\"cs_order_number\" ELSE NULL END as \"multi_warehouse_sales\"
FROM
    questionable),
uneven as (
SELECT
    abundant.\"multi_warehouse_sales\" as \"multi_warehouse_sales\"
FROM
    abundant
GROUP BY 
    abundant.\"multi_warehouse_sales\"),
vacuous as (
SELECT
    cs_catalog_sales.\"CS_CALL_CENTER_SK\" as \"cs_call_center_id\",
    cs_catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    cs_catalog_sales.\"CS_SHIP_ADDR_SK\" as \"cs_customer_address_id\",
    cs_catalog_sales.\"CS_SHIP_DATE_SK\" as \"cs_ship_date_id\"
FROM
    memory.catalog_sales as cs_catalog_sales
WHERE
    cs_catalog_sales.\"CS_ORDER_NUMBER\" not in (select thoughtful.\"cr_order_number\" from thoughtful where thoughtful.\"cr_order_number\" is not null) and cs_catalog_sales.\"CS_ORDER_NUMBER\" in (select uneven.\"multi_warehouse_sales\" from uneven where uneven.\"multi_warehouse_sales\" is not null)

GROUP BY 
    cs_catalog_sales.\"CS_CALL_CENTER_SK\",
    cs_catalog_sales.\"CS_ORDER_NUMBER\",
    cs_catalog_sales.\"CS_SHIP_ADDR_SK\",
    cs_catalog_sales.\"CS_SHIP_DATE_SK\"),
yummy as (
SELECT
    cast(cs_ship_date_date.\"D_DATE\" as date) as \"cs_ship_date_date\",
    cs_call_center_call_center.\"CC_COUNTY\" as \"cs_call_center_county\",
    cs_catalog_sales.\"CS_EXT_SHIP_COST\" as \"cs_extra_ship_cost\",
    cs_catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    cs_catalog_sales.\"CS_NET_PROFIT\" as \"cs_net_profit\",
    cs_catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    cs_customer_customer_address.\"CA_STATE\" as \"cs_customer_state\"
FROM
    memory.customer_address as cs_customer_customer_address
    INNER JOIN memory.catalog_sales as cs_catalog_sales on cs_customer_customer_address.\"CA_ADDRESS_SK\" = cs_catalog_sales.\"CS_SHIP_ADDR_SK\"
    INNER JOIN memory.date_dim as cs_ship_date_date on cs_catalog_sales.\"CS_SHIP_DATE_SK\" = cs_ship_date_date.\"D_DATE_SK\"
    INNER JOIN memory.call_center as cs_call_center_call_center on cs_catalog_sales.\"CS_CALL_CENTER_SK\" = cs_call_center_call_center.\"CC_CALL_CENTER_SK\"
WHERE
    cast(cs_ship_date_date.\"D_DATE\" as date) >= date '2002-02-01' and cast(cs_ship_date_date.\"D_DATE\" as date) <= date '2002-04-02' and cs_customer_customer_address.\"CA_STATE\" = 'GA' and cs_call_center_call_center.\"CC_COUNTY\" = 'Williamson County' and cs_catalog_sales.\"CS_ORDER_NUMBER\" not in (select thoughtful.\"cr_order_number\" from thoughtful where thoughtful.\"cr_order_number\" is not null) and cs_catalog_sales.\"CS_ORDER_NUMBER\" in (select uneven.\"multi_warehouse_sales\" from uneven where uneven.\"multi_warehouse_sales\" is not null)
),
concerned as (
SELECT
    cast(cs_ship_date_date.\"D_DATE\" as date) as \"cs_ship_date_date\",
    cs_call_center_call_center.\"CC_COUNTY\" as \"cs_call_center_county\",
    cs_customer_customer_address.\"CA_STATE\" as \"cs_customer_state\",
    vacuous.\"cs_order_number\" as \"cs_order_number\"
FROM
    vacuous
    INNER JOIN memory.customer_address as cs_customer_customer_address on vacuous.\"cs_customer_address_id\" = cs_customer_customer_address.\"CA_ADDRESS_SK\"
    INNER JOIN memory.date_dim as cs_ship_date_date on vacuous.\"cs_ship_date_id\" = cs_ship_date_date.\"D_DATE_SK\"
    INNER JOIN memory.call_center as cs_call_center_call_center on vacuous.\"cs_call_center_id\" = cs_call_center_call_center.\"CC_CALL_CENTER_SK\"
WHERE
    cast(cs_ship_date_date.\"D_DATE\" as date) >= date '2002-02-01' and cast(cs_ship_date_date.\"D_DATE\" as date) <= date '2002-04-02' and cs_customer_customer_address.\"CA_STATE\" = 'GA' and cs_call_center_call_center.\"CC_COUNTY\" = 'Williamson County' and vacuous.\"cs_order_number\" not in (select thoughtful.\"cr_order_number\" from thoughtful where thoughtful.\"cr_order_number\" is not null) and vacuous.\"cs_order_number\" in (select uneven.\"multi_warehouse_sales\" from uneven where uneven.\"multi_warehouse_sales\" is not null)
),
juicy as (
SELECT
    sum(yummy.\"cs_extra_ship_cost\") as \"total_shipping_cost\",
    sum(yummy.\"cs_net_profit\") as \"total_net_profit\"
FROM
    yummy),
young as (
SELECT
    count(distinct concerned.\"cs_order_number\") as \"order_count\"
FROM
    concerned)
SELECT
    young.\"order_count\" as \"order_count\",
    juicy.\"total_shipping_cost\" as \"total_shipping_cost\",
    juicy.\"total_net_profit\" as \"total_net_profit\"
FROM
    juicy
    FULL JOIN young on 1=1
ORDER BY 
    young.\"order_count\" desc
LIMIT (100)"""
