query_id = 16
parse_time = 65.348238
exec_time = 0.732146
comp_time = 0.039754
gen_length = 4900
generated_sql = """

WITH 
dove as (
SELECT
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_WAREHOUSE_SK\" as \"cs_warehouse_id\"
FROM
    memory.catalog_sales as catalog_sales
GROUP BY 
    catalog_sales.\"CS_WAREHOUSE_SK\",
    catalog_sales.\"CS_ORDER_NUMBER\"),
serval as (
SELECT
    catalog_returns.\"CR_ORDER_NUMBER\" as \"cr_order_number\"
FROM
    memory.catalog_returns as catalog_returns
GROUP BY 
    catalog_returns.\"CR_ORDER_NUMBER\"),
goose as (
SELECT
    count(dove.\"cs_warehouse_id\") as \"_agg_count_7925813863281141\",
    dove.\"cs_order_number\" as \"cs_order_number\"
FROM
    dove
GROUP BY 
    dove.\"cs_order_number\"),
premium as (
SELECT
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    goose.\"_agg_count_7925813863281141\" as \"_agg_count_7925813863281141\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN goose on catalog_sales.\"CS_ORDER_NUMBER\" = goose.\"cs_order_number\"),
salamander as (
SELECT
    CASE WHEN premium.\"_agg_count_7925813863281141\" > 1 THEN premium.\"cs_order_number\" ELSE NULL END as \"multi_warehouse_sales\"
FROM
    premium),
falcon as (
SELECT
    salamander.\"multi_warehouse_sales\" as \"multi_warehouse_sales\"
FROM
    salamander
GROUP BY 
    salamander.\"multi_warehouse_sales\"),
thoughtful as (
SELECT
    catalog_sales.\"CS_CALL_CENTER_SK\" as \"cs_call_center_id\",
    catalog_sales.\"CS_SHIP_ADDR_SK\" as \"cs_customer_address_id\",
    catalog_sales.\"CS_SHIP_DATE_SK\" as \"cs_ship_date_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\"
FROM
    memory.catalog_sales as catalog_sales
WHERE
    catalog_sales.\"CS_ORDER_NUMBER\" not in (select serval.\"cr_order_number\" from serval where serval.\"cr_order_number\" is not null) and catalog_sales.\"CS_ORDER_NUMBER\" in (select falcon.\"multi_warehouse_sales\" from falcon where falcon.\"multi_warehouse_sales\" is not null)

GROUP BY 
    catalog_sales.\"CS_ORDER_NUMBER\",
    catalog_sales.\"CS_SHIP_ADDR_SK\",
    catalog_sales.\"CS_CALL_CENTER_SK\",
    catalog_sales.\"CS_SHIP_DATE_SK\"),
petrel as (
SELECT
    catalog_sales.\"CS_EXT_SHIP_COST\" as \"cs_extra_ship_cost\",
    cast(\"D_DATE\" as date) as \"cs_ship_date_date\",
    customer_address.\"CA_STATE\" as \"cs_customer_state\",
    call_center.\"CC_COUNTY\" as \"cs_call_center_county\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",
    catalog_sales.\"CS_NET_PROFIT\" as \"cs_net_profit\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN memory.call_center as call_center on catalog_sales.\"CS_CALL_CENTER_SK\" = call_center.\"CC_CALL_CENTER_SK\"
    INNER JOIN memory.customer_address as customer_address on catalog_sales.\"CS_SHIP_ADDR_SK\" = customer_address.\"CA_ADDRESS_SK\"
    INNER JOIN memory.date_dim as date on catalog_sales.\"CS_SHIP_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    cast(\"D_DATE\" as date) >= cast('2002-02-01' as date) and cast(\"D_DATE\" as date) <= cast('2002-04-02' as date) and customer_address.\"CA_STATE\" = 'GA' and call_center.\"CC_COUNTY\" = 'Williamson County' and catalog_sales.\"CS_ORDER_NUMBER\" not in (select serval.\"cr_order_number\" from serval where serval.\"cr_order_number\" is not null) and catalog_sales.\"CS_ORDER_NUMBER\" in (select falcon.\"multi_warehouse_sales\" from falcon where falcon.\"multi_warehouse_sales\" is not null)
),
covey as (
SELECT
    thoughtful.\"cs_order_number\" as \"cs_order_number\",
    cast(\"D_DATE\" as date) as \"cs_ship_date_date\",
    customer_address.\"CA_STATE\" as \"cs_customer_state\",
    call_center.\"CC_COUNTY\" as \"cs_call_center_county\"
FROM
    thoughtful
    INNER JOIN memory.call_center as call_center on thoughtful.\"cs_call_center_id\" = call_center.\"CC_CALL_CENTER_SK\"
    INNER JOIN memory.customer_address as customer_address on thoughtful.\"cs_customer_address_id\" = customer_address.\"CA_ADDRESS_SK\"
    INNER JOIN memory.date_dim as date on thoughtful.\"cs_ship_date_id\" = date.\"D_DATE_SK\"
WHERE
    cast(\"D_DATE\" as date) >= cast('2002-02-01' as date) and cast(\"D_DATE\" as date) <= cast('2002-04-02' as date) and customer_address.\"CA_STATE\" = 'GA' and call_center.\"CC_COUNTY\" = 'Williamson County' and thoughtful.\"cs_order_number\" not in (select serval.\"cr_order_number\" from serval where serval.\"cr_order_number\" is not null) and thoughtful.\"cs_order_number\" in (select falcon.\"multi_warehouse_sales\" from falcon where falcon.\"multi_warehouse_sales\" is not null)
),
sordid as (
SELECT
    sum(petrel.\"cs_extra_ship_cost\") as \"total_shipping_cost\",
    sum(petrel.\"cs_net_profit\") as \"total_net_profit\"
FROM
    petrel),
flashy as (
SELECT
    count(distinct covey.\"cs_order_number\") as \"order_count\"
FROM
    covey)
SELECT
    flashy.\"order_count\" as \"order_count\",
    sordid.\"total_shipping_cost\" as \"total_shipping_cost\",
    sordid.\"total_net_profit\" as \"total_net_profit\"
FROM
    flashy
    FULL JOIN sordid on 1=1
ORDER BY 
    flashy.\"order_count\" desc
LIMIT (100)"""
