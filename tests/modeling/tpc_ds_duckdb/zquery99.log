query_id = 99
gen_length = 9202
generated_sql = """

WITH 
wakeful as (
SELECT
    (cast(catalog_sales_catalog_sales.\"CS_ORDER_NUMBER\" as string) || cast(catalog_sales_catalog_sales.\"CS_ITEM_SK\" as string)) as \"catalog_pk\",
    catalog_sales_catalog_sales.\"CS_ITEM_SK\" as \"catalog_sales_item_id\",
    catalog_sales_catalog_sales.\"CS_ORDER_NUMBER\" as \"catalog_sales_order_number\",
    date_diff('day', cast(catalog_sales_sold_date_date.\"D_DATE\" as date), cast(catalog_sales_ship_date_date.\"D_DATE\" as date)) as \"catalog_sales_days_to_ship\"
FROM
    memory.catalog_sales as catalog_sales_catalog_sales
    INNER JOIN memory.date_dim as catalog_sales_sold_date_date on catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" = catalog_sales_sold_date_date.\"D_DATE_SK\"
    INNER JOIN memory.date_dim as catalog_sales_ship_date_date on catalog_sales_catalog_sales.\"CS_SHIP_DATE_SK\" = catalog_sales_ship_date_date.\"D_DATE_SK\"
WHERE
    catalog_sales_ship_date_date.\"D_MONTH_SEQ\" >= 1200 and catalog_sales_ship_date_date.\"D_MONTH_SEQ\" <= 1211
),
abundant as (
SELECT
    (cast(catalog_sales_catalog_sales.\"CS_ORDER_NUMBER\" as string) || cast(catalog_sales_catalog_sales.\"CS_ITEM_SK\" as string)) as \"catalog_pk\",
    LOWER(catalog_sales_call_center_call_center.\"CC_NAME\")  as \"cc_name_lower\",
    SUBSTRING(catalog_sales_warehouse_warehouse.\"w_warehouse_name\",1,20) as \"warehouse_short_name\",
    catalog_sales_catalog_sales.\"CS_ITEM_SK\" as \"catalog_sales_item_id\",
    catalog_sales_catalog_sales.\"CS_ORDER_NUMBER\" as \"catalog_sales_order_number\",
    catalog_sales_ship_mode_ship_mode.\"SM_TYPE\" as \"catalog_sales_ship_mode_type\",
    date_diff('day', cast(catalog_sales_sold_date_date.\"D_DATE\" as date), cast(catalog_sales_ship_date_date.\"D_DATE\" as date)) as \"catalog_sales_days_to_ship\"
FROM
    memory.catalog_sales as catalog_sales_catalog_sales
    INNER JOIN memory.call_center as catalog_sales_call_center_call_center on catalog_sales_catalog_sales.\"CS_CALL_CENTER_SK\" = catalog_sales_call_center_call_center.\"CC_CALL_CENTER_SK\"
    INNER JOIN memory.date_dim as catalog_sales_ship_date_date on catalog_sales_catalog_sales.\"CS_SHIP_DATE_SK\" = catalog_sales_ship_date_date.\"D_DATE_SK\"
    INNER JOIN memory.ship_mode as catalog_sales_ship_mode_ship_mode on catalog_sales_catalog_sales.\"CS_SHIP_MODE_SK\" = catalog_sales_ship_mode_ship_mode.\"SM_SHIP_MODE_SK\"
    INNER JOIN memory.date_dim as catalog_sales_sold_date_date on catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" = catalog_sales_sold_date_date.\"D_DATE_SK\"
    INNER JOIN memory.warehouse as catalog_sales_warehouse_warehouse on catalog_sales_catalog_sales.\"CS_WAREHOUSE_SK\" = catalog_sales_warehouse_warehouse.\"w_warehouse_sk\"
WHERE
    catalog_sales_ship_date_date.\"D_MONTH_SEQ\" >= 1200 and catalog_sales_ship_date_date.\"D_MONTH_SEQ\" <= 1211
),
cheerful as (
SELECT
    CASE WHEN wakeful.\"catalog_sales_days_to_ship\" <= 30 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_4225686782171358\",
    CASE WHEN wakeful.\"catalog_sales_days_to_ship\" > 120 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_6531911548451157\",
    CASE WHEN wakeful.\"catalog_sales_days_to_ship\" > 30 and wakeful.\"catalog_sales_days_to_ship\" <= 60 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_6226865903052054\",
    CASE WHEN wakeful.\"catalog_sales_days_to_ship\" > 60 and wakeful.\"catalog_sales_days_to_ship\" <= 90 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_9751976656549562\",
    CASE WHEN wakeful.\"catalog_sales_days_to_ship\" > 90 and wakeful.\"catalog_sales_days_to_ship\" <= 120 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_974692753986118\",
    wakeful.\"catalog_pk\" as \"catalog_pk\",
    wakeful.\"catalog_sales_days_to_ship\" as \"catalog_sales_days_to_ship\",
    wakeful.\"catalog_sales_item_id\" as \"catalog_sales_item_id\",
    wakeful.\"catalog_sales_order_number\" as \"catalog_sales_order_number\"
FROM
    wakeful),
uneven as (
SELECT
    abundant.\"catalog_sales_ship_mode_type\" as \"catalog_sales_ship_mode_type\",
    abundant.\"cc_name_lower\" as \"cc_name_lower\",
    abundant.\"warehouse_short_name\" as \"warehouse_short_name\",
    cheerful.\"_virt_6531911548451157\" as \"_virt_6531911548451157\",
    cheerful.\"catalog_pk\" as \"catalog_pk\",
    cheerful.\"catalog_sales_days_to_ship\" as \"catalog_sales_days_to_ship\",
    cheerful.\"catalog_sales_item_id\" as \"catalog_sales_item_id\",
    cheerful.\"catalog_sales_order_number\" as \"catalog_sales_order_number\"
FROM
    abundant
    INNER JOIN cheerful on abundant.\"catalog_sales_days_to_ship\" = cheerful.\"catalog_sales_days_to_ship\" AND abundant.\"catalog_sales_item_id\" = cheerful.\"catalog_sales_item_id\" AND abundant.\"catalog_sales_order_number\" = cheerful.\"catalog_sales_order_number\"),
yummy as (
SELECT
    cheerful.\"_virt_974692753986118\" as \"_virt_974692753986118\",
    cheerful.\"catalog_pk\" as \"catalog_pk\",
    cheerful.\"catalog_sales_days_to_ship\" as \"catalog_sales_days_to_ship\",
    cheerful.\"catalog_sales_item_id\" as \"catalog_sales_item_id\",
    cheerful.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",
    uneven.\"_virt_6531911548451157\" as \"_virt_6531911548451157\",
    uneven.\"catalog_sales_ship_mode_type\" as \"catalog_sales_ship_mode_type\",
    uneven.\"cc_name_lower\" as \"cc_name_lower\",
    uneven.\"warehouse_short_name\" as \"warehouse_short_name\"
FROM
    uneven
    INNER JOIN cheerful on uneven.\"catalog_sales_days_to_ship\" = cheerful.\"catalog_sales_days_to_ship\" AND uneven.\"catalog_sales_item_id\" = cheerful.\"catalog_sales_item_id\" AND uneven.\"catalog_sales_order_number\" = cheerful.\"catalog_sales_order_number\"),
juicy as (
SELECT
    cheerful.\"_virt_9751976656549562\" as \"_virt_9751976656549562\",
    cheerful.\"catalog_pk\" as \"catalog_pk\",
    cheerful.\"catalog_sales_days_to_ship\" as \"catalog_sales_days_to_ship\",
    cheerful.\"catalog_sales_item_id\" as \"catalog_sales_item_id\",
    cheerful.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",
    yummy.\"_virt_6531911548451157\" as \"_virt_6531911548451157\",
    yummy.\"_virt_974692753986118\" as \"_virt_974692753986118\",
    yummy.\"catalog_sales_ship_mode_type\" as \"catalog_sales_ship_mode_type\",
    yummy.\"cc_name_lower\" as \"cc_name_lower\",
    yummy.\"warehouse_short_name\" as \"warehouse_short_name\"
FROM
    yummy
    INNER JOIN cheerful on yummy.\"catalog_sales_days_to_ship\" = cheerful.\"catalog_sales_days_to_ship\" AND yummy.\"catalog_sales_item_id\" = cheerful.\"catalog_sales_item_id\" AND yummy.\"catalog_sales_order_number\" = cheerful.\"catalog_sales_order_number\"),
vacuous as (
SELECT
    cheerful.\"_virt_6226865903052054\" as \"_virt_6226865903052054\",
    cheerful.\"catalog_pk\" as \"catalog_pk\",
    cheerful.\"catalog_sales_days_to_ship\" as \"catalog_sales_days_to_ship\",
    cheerful.\"catalog_sales_item_id\" as \"catalog_sales_item_id\",
    cheerful.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",
    juicy.\"_virt_6531911548451157\" as \"_virt_6531911548451157\",
    juicy.\"_virt_974692753986118\" as \"_virt_974692753986118\",
    juicy.\"_virt_9751976656549562\" as \"_virt_9751976656549562\",
    juicy.\"catalog_sales_ship_mode_type\" as \"catalog_sales_ship_mode_type\",
    juicy.\"cc_name_lower\" as \"cc_name_lower\",
    juicy.\"warehouse_short_name\" as \"warehouse_short_name\"
FROM
    juicy
    INNER JOIN cheerful on juicy.\"catalog_sales_days_to_ship\" = cheerful.\"catalog_sales_days_to_ship\" AND juicy.\"catalog_sales_item_id\" = cheerful.\"catalog_sales_item_id\" AND juicy.\"catalog_sales_order_number\" = cheerful.\"catalog_sales_order_number\"),
concerned as (
SELECT
    cheerful.\"_virt_4225686782171358\" as \"_virt_4225686782171358\",
    cheerful.\"catalog_sales_item_id\" as \"catalog_sales_item_id\",
    cheerful.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",
    vacuous.\"_virt_6226865903052054\" as \"_virt_6226865903052054\",
    vacuous.\"_virt_6531911548451157\" as \"_virt_6531911548451157\",
    vacuous.\"_virt_974692753986118\" as \"_virt_974692753986118\",
    vacuous.\"_virt_9751976656549562\" as \"_virt_9751976656549562\",
    vacuous.\"catalog_sales_ship_mode_type\" as \"catalog_sales_ship_mode_type\",
    vacuous.\"cc_name_lower\" as \"cc_name_lower\",
    vacuous.\"warehouse_short_name\" as \"warehouse_short_name\"
FROM
    vacuous
    INNER JOIN cheerful on vacuous.\"catalog_sales_days_to_ship\" = cheerful.\"catalog_sales_days_to_ship\" AND vacuous.\"catalog_sales_item_id\" = cheerful.\"catalog_sales_item_id\" AND vacuous.\"catalog_sales_order_number\" = cheerful.\"catalog_sales_order_number\")
SELECT
    concerned.\"warehouse_short_name\" as \"warehouse_short_name\",
    concerned.\"catalog_sales_ship_mode_type\" as \"catalog_sales_ship_mode_type\",
    concerned.\"cc_name_lower\" as \"cc_name_lower\",
    count(concerned.\"_virt_4225686782171358\") as \"less_than_30_days\",
    count(concerned.\"_virt_6226865903052054\") as \"between_31_and_60_days\",
    count(concerned.\"_virt_9751976656549562\") as \"between_61_and_90_days\",
    count(concerned.\"_virt_974692753986118\") as \"between_91_and_120_days\",
    count(concerned.\"_virt_6531911548451157\") as \"over_120_days\"
FROM
    concerned
GROUP BY 
    concerned.\"catalog_sales_ship_mode_type\",
    concerned.\"cc_name_lower\",
    concerned.\"warehouse_short_name\"
ORDER BY 
    concerned.\"warehouse_short_name\" asc nulls first,
    concerned.\"catalog_sales_ship_mode_type\" asc nulls first,
    concerned.\"cc_name_lower\" asc nulls first"""
