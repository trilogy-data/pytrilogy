query_id = 99
gen_length = 3266
generated_sql = """
SELECT
    SUBSTRING(\"warehouse_warehouse\".\"w_warehouse_name\",1,20) as \"warehouse_short_name\",
    \"ship_mode_ship_mode\".\"SM_TYPE\" as \"ship_mode_type\",
    LOWER(\"call_center_call_center\".\"CC_NAME\")  as \"cc_name_lower\",
    count(CASE WHEN date_diff('day', cast(\"sold_date_date\".\"D_DATE\" as date), cast(\"ship_date_date\".\"D_DATE\" as date)) <= 30 THEN (cast(\"catalog_sales\".\"CS_ORDER_NUMBER\" as string) || cast(\"catalog_sales\".\"CS_ITEM_SK\" as string)) ELSE NULL END) as \"less_than_30_days\",
    count(CASE WHEN date_diff('day', cast(\"sold_date_date\".\"D_DATE\" as date), cast(\"ship_date_date\".\"D_DATE\" as date)) > 30 and date_diff('day', cast(\"sold_date_date\".\"D_DATE\" as date), cast(\"ship_date_date\".\"D_DATE\" as date)) <= 60 THEN (cast(\"catalog_sales\".\"CS_ORDER_NUMBER\" as string) || cast(\"catalog_sales\".\"CS_ITEM_SK\" as string)) ELSE NULL END) as \"between_31_and_60_days\",
    count(CASE WHEN date_diff('day', cast(\"sold_date_date\".\"D_DATE\" as date), cast(\"ship_date_date\".\"D_DATE\" as date)) > 60 and date_diff('day', cast(\"sold_date_date\".\"D_DATE\" as date), cast(\"ship_date_date\".\"D_DATE\" as date)) <= 90 THEN (cast(\"catalog_sales\".\"CS_ORDER_NUMBER\" as string) || cast(\"catalog_sales\".\"CS_ITEM_SK\" as string)) ELSE NULL END) as \"between_61_and_90_days\",
    count(CASE WHEN date_diff('day', cast(\"sold_date_date\".\"D_DATE\" as date), cast(\"ship_date_date\".\"D_DATE\" as date)) > 90 and date_diff('day', cast(\"sold_date_date\".\"D_DATE\" as date), cast(\"ship_date_date\".\"D_DATE\" as date)) <= 120 THEN (cast(\"catalog_sales\".\"CS_ORDER_NUMBER\" as string) || cast(\"catalog_sales\".\"CS_ITEM_SK\" as string)) ELSE NULL END) as \"between_91_and_120_days\",
    count(CASE WHEN date_diff('day', cast(\"sold_date_date\".\"D_DATE\" as date), cast(\"ship_date_date\".\"D_DATE\" as date)) > 120 THEN (cast(\"catalog_sales\".\"CS_ORDER_NUMBER\" as string) || cast(\"catalog_sales\".\"CS_ITEM_SK\" as string)) ELSE NULL END) as \"over_120_days\"
FROM
    \"memory\".\"catalog_sales\" as \"catalog_sales\"
    INNER JOIN \"memory\".\"date_dim\" as \"ship_date_date\" on \"catalog_sales\".\"CS_SHIP_DATE_SK\" = \"ship_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"ship_mode\" as \"ship_mode_ship_mode\" on \"catalog_sales\".\"CS_SHIP_MODE_SK\" = \"ship_mode_ship_mode\".\"SM_SHIP_MODE_SK\"
    INNER JOIN \"memory\".\"date_dim\" as \"sold_date_date\" on \"catalog_sales\".\"CS_SOLD_DATE_SK\" = \"sold_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"warehouse\" as \"warehouse_warehouse\" on \"catalog_sales\".\"CS_WAREHOUSE_SK\" = \"warehouse_warehouse\".\"w_warehouse_sk\"
    RIGHT OUTER JOIN \"memory\".\"call_center\" as \"call_center_call_center\" on \"catalog_sales\".\"CS_CALL_CENTER_SK\" = \"call_center_call_center\".\"CC_CALL_CENTER_SK\"
WHERE
    \"ship_date_date\".\"D_MONTH_SEQ\" >= 1200 and \"ship_date_date\".\"D_MONTH_SEQ\" <= 1211 and \"catalog_sales\".\"CS_ORDER_NUMBER\" is not null and \"call_center_call_center\".\"CC_CALL_CENTER_SK\" is not null and \"warehouse_warehouse\".\"w_warehouse_sk\" is not null and \"ship_mode_ship_mode\".\"SM_SHIP_MODE_SK\" is not null

GROUP BY 
    \"ship_mode_ship_mode\".\"SM_TYPE\",
    LOWER(\"call_center_call_center\".\"CC_NAME\") ,
    SUBSTRING(\"warehouse_warehouse\".\"w_warehouse_name\",1,20)
ORDER BY 
    \"warehouse_short_name\" asc nulls first,
    \"ship_mode_ship_mode\".\"SM_TYPE\" asc nulls first,
    \"cc_name_lower\" asc nulls first
LIMIT (100)"""
