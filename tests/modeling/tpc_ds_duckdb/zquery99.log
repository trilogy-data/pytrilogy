query_id = 99
gen_length = 6891
generated_sql = """

WITH 
wakeful as (
SELECT
    (cast(catalog_sales.\"CS_ORDER_NUMBER\" as string) || cast(catalog_sales.\"CS_ITEM_SK\" as string)) as \"catalog_pk\",
    date_diff('day', cast(sold_date_date.\"D_DATE\" as date), cast(ship_date_date.\"D_DATE\" as date)) as \"days_to_ship\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN memory.date_dim as sold_date_date on catalog_sales.\"CS_SOLD_DATE_SK\" = sold_date_date.\"D_DATE_SK\"
    INNER JOIN memory.date_dim as ship_date_date on catalog_sales.\"CS_SHIP_DATE_SK\" = ship_date_date.\"D_DATE_SK\"
WHERE
    ship_date_date.\"D_MONTH_SEQ\" >= 1200 and ship_date_date.\"D_MONTH_SEQ\" <= 1211
),
abundant as (
SELECT
    (cast(catalog_sales.\"CS_ORDER_NUMBER\" as string) || cast(catalog_sales.\"CS_ITEM_SK\" as string)) as \"catalog_pk\",
    LOWER(call_center_call_center.\"CC_NAME\")  as \"cc_name_lower\",
    SUBSTRING(warehouse_warehouse.\"w_warehouse_name\",1,20) as \"warehouse_short_name\",
    catalog_sales.\"CS_ITEM_SK\" as \"item_id\",
    catalog_sales.\"CS_ORDER_NUMBER\" as \"order_number\",
    date_diff('day', cast(sold_date_date.\"D_DATE\" as date), cast(ship_date_date.\"D_DATE\" as date)) as \"days_to_ship\",
    ship_mode_ship_mode.\"SM_TYPE\" as \"ship_mode_type\"
FROM
    memory.catalog_sales as catalog_sales
    INNER JOIN memory.call_center as call_center_call_center on catalog_sales.\"CS_CALL_CENTER_SK\" = call_center_call_center.\"CC_CALL_CENTER_SK\"
    INNER JOIN memory.date_dim as ship_date_date on catalog_sales.\"CS_SHIP_DATE_SK\" = ship_date_date.\"D_DATE_SK\"
    INNER JOIN memory.ship_mode as ship_mode_ship_mode on catalog_sales.\"CS_SHIP_MODE_SK\" = ship_mode_ship_mode.\"SM_SHIP_MODE_SK\"
    INNER JOIN memory.date_dim as sold_date_date on catalog_sales.\"CS_SOLD_DATE_SK\" = sold_date_date.\"D_DATE_SK\"
    INNER JOIN memory.warehouse as warehouse_warehouse on catalog_sales.\"CS_WAREHOUSE_SK\" = warehouse_warehouse.\"w_warehouse_sk\"
WHERE
    ship_date_date.\"D_MONTH_SEQ\" >= 1200 and ship_date_date.\"D_MONTH_SEQ\" <= 1211
),
cheerful as (
SELECT
    CASE WHEN wakeful.\"days_to_ship\" <= 30 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_9086119107096417\",
    CASE WHEN wakeful.\"days_to_ship\" > 120 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_2082668942689685\",
    CASE WHEN wakeful.\"days_to_ship\" > 30 and wakeful.\"days_to_ship\" <= 60 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_5426820531205209\",
    CASE WHEN wakeful.\"days_to_ship\" > 60 and wakeful.\"days_to_ship\" <= 90 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_7152462648890284\",
    CASE WHEN wakeful.\"days_to_ship\" > 90 and wakeful.\"days_to_ship\" <= 120 THEN wakeful.\"catalog_pk\" ELSE NULL END as \"_virt_4450778295352864\",
    wakeful.\"catalog_pk\" as \"catalog_pk\",
    wakeful.\"days_to_ship\" as \"days_to_ship\"
FROM
    wakeful),
uneven as (
SELECT
    abundant.\"cc_name_lower\" as \"cc_name_lower\",
    abundant.\"item_id\" as \"item_id\",
    abundant.\"order_number\" as \"order_number\",
    abundant.\"ship_mode_type\" as \"ship_mode_type\",
    abundant.\"warehouse_short_name\" as \"warehouse_short_name\",
    cheerful.\"_virt_2082668942689685\" as \"_virt_2082668942689685\",
    cheerful.\"catalog_pk\" as \"catalog_pk\",
    cheerful.\"days_to_ship\" as \"days_to_ship\"
FROM
    abundant
    INNER JOIN cheerful on abundant.\"catalog_pk\" = cheerful.\"catalog_pk\" AND abundant.\"days_to_ship\" = cheerful.\"days_to_ship\"),
yummy as (
SELECT
    cheerful.\"_virt_4450778295352864\" as \"_virt_4450778295352864\",
    cheerful.\"catalog_pk\" as \"catalog_pk\",
    cheerful.\"days_to_ship\" as \"days_to_ship\",
    uneven.\"_virt_2082668942689685\" as \"_virt_2082668942689685\",
    uneven.\"cc_name_lower\" as \"cc_name_lower\",
    uneven.\"item_id\" as \"item_id\",
    uneven.\"order_number\" as \"order_number\",
    uneven.\"ship_mode_type\" as \"ship_mode_type\",
    uneven.\"warehouse_short_name\" as \"warehouse_short_name\"
FROM
    uneven
    INNER JOIN cheerful on uneven.\"catalog_pk\" = cheerful.\"catalog_pk\" AND uneven.\"days_to_ship\" = cheerful.\"days_to_ship\"),
juicy as (
SELECT
    cheerful.\"_virt_7152462648890284\" as \"_virt_7152462648890284\",
    cheerful.\"catalog_pk\" as \"catalog_pk\",
    cheerful.\"days_to_ship\" as \"days_to_ship\",
    yummy.\"_virt_2082668942689685\" as \"_virt_2082668942689685\",
    yummy.\"_virt_4450778295352864\" as \"_virt_4450778295352864\",
    yummy.\"cc_name_lower\" as \"cc_name_lower\",
    yummy.\"item_id\" as \"item_id\",
    yummy.\"order_number\" as \"order_number\",
    yummy.\"ship_mode_type\" as \"ship_mode_type\",
    yummy.\"warehouse_short_name\" as \"warehouse_short_name\"
FROM
    yummy
    INNER JOIN cheerful on yummy.\"catalog_pk\" = cheerful.\"catalog_pk\" AND yummy.\"days_to_ship\" = cheerful.\"days_to_ship\"),
vacuous as (
SELECT
    cheerful.\"_virt_5426820531205209\" as \"_virt_5426820531205209\",
    cheerful.\"catalog_pk\" as \"catalog_pk\",
    cheerful.\"days_to_ship\" as \"days_to_ship\",
    juicy.\"_virt_2082668942689685\" as \"_virt_2082668942689685\",
    juicy.\"_virt_4450778295352864\" as \"_virt_4450778295352864\",
    juicy.\"_virt_7152462648890284\" as \"_virt_7152462648890284\",
    juicy.\"cc_name_lower\" as \"cc_name_lower\",
    juicy.\"item_id\" as \"item_id\",
    juicy.\"order_number\" as \"order_number\",
    juicy.\"ship_mode_type\" as \"ship_mode_type\",
    juicy.\"warehouse_short_name\" as \"warehouse_short_name\"
FROM
    juicy
    INNER JOIN cheerful on juicy.\"catalog_pk\" = cheerful.\"catalog_pk\" AND juicy.\"days_to_ship\" = cheerful.\"days_to_ship\"),
concerned as (
SELECT
    cheerful.\"_virt_9086119107096417\" as \"_virt_9086119107096417\",
    vacuous.\"_virt_2082668942689685\" as \"_virt_2082668942689685\",
    vacuous.\"_virt_4450778295352864\" as \"_virt_4450778295352864\",
    vacuous.\"_virt_5426820531205209\" as \"_virt_5426820531205209\",
    vacuous.\"_virt_7152462648890284\" as \"_virt_7152462648890284\",
    vacuous.\"cc_name_lower\" as \"cc_name_lower\",
    vacuous.\"item_id\" as \"item_id\",
    vacuous.\"order_number\" as \"order_number\",
    vacuous.\"ship_mode_type\" as \"ship_mode_type\",
    vacuous.\"warehouse_short_name\" as \"warehouse_short_name\"
FROM
    vacuous
    INNER JOIN cheerful on vacuous.\"catalog_pk\" = cheerful.\"catalog_pk\" AND vacuous.\"days_to_ship\" = cheerful.\"days_to_ship\")
SELECT
    concerned.\"warehouse_short_name\" as \"warehouse_short_name\",
    concerned.\"ship_mode_type\" as \"ship_mode_type\",
    concerned.\"cc_name_lower\" as \"cc_name_lower\",
    count(concerned.\"_virt_9086119107096417\") as \"less_than_30_days\",
    count(concerned.\"_virt_5426820531205209\") as \"between_31_and_60_days\",
    count(concerned.\"_virt_7152462648890284\") as \"between_61_and_90_days\",
    count(concerned.\"_virt_4450778295352864\") as \"between_91_and_120_days\",
    count(concerned.\"_virt_2082668942689685\") as \"over_120_days\"
FROM
    concerned
GROUP BY 
    concerned.\"cc_name_lower\",
    concerned.\"ship_mode_type\",
    concerned.\"warehouse_short_name\"
ORDER BY 
    concerned.\"warehouse_short_name\" asc nulls first,
    concerned.\"ship_mode_type\" asc nulls first,
    concerned.\"cc_name_lower\" asc nulls first"""
