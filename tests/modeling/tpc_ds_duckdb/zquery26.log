query_id = 26
gen_length = 10072
generated_sql = """

WITH 
thoughtful as (
-- Target: Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>. Group: False Source: SourceType.MERGE.
-- Joins: inner join cs_catalog_sales on dynamic.cs.bill_customer_demographic.id=cs.bill_customer_demographic.id, inner join cs_date_date on cheerful.cs.date.id=cs.date.id, inner join cs_item_items on cheerful.cs.item.id=cs.item.id, inner join cs_promotion_promotion on cheerful.cs.promotion.id=cs.promotion.id.
-- Source Map: {'cs.item.name': ['cs_item_items'], 'cs.item.id': ['cs_item_items'], 'cs.date.year': ['cs_date_date'], 'cs.date.id': ['cs_date_date'], 'cs.bill_customer_demographic.gender': ['cs_bill_customer_demographic_customer_demographics'], 'cs.bill_customer_demographic.marital_status': ['cs_bill_customer_demographic_customer_demographics'], 'cs.bill_customer_demographic.id': ['cs_bill_customer_demographic_customer_demographics'], 'cs.bill_customer_demographic.education_status': ['cs_bill_customer_demographic_customer_demographics'], 'cs.promotion.channel_event': ['cs_promotion_promotion'], 'cs.promotion.channel_email': ['cs_promotion_promotion'], 'cs.promotion.id': ['cs_promotion_promotion'], 'cs.quantity': ['cs_catalog_sales'], 'cs.list_price': ['cs_catalog_sales'], 'cs.sales_price': ['cs_catalog_sales'], 'cs.order_number': ['cs_catalog_sales'], 'cs.coupon_amt': ['cs_catalog_sales'], 'cs.item.brand_id': ['cs_item_items'], 'cs.item.class': ['cs_item_items'], 'cs.item.current_price': ['cs_item_items'], 'cs.item.color': ['cs_item_items'], 'cs.item.desc': ['cs_item_items'], 'cs.item.category': ['cs_item_items'], 'cs.item.size': ['cs_item_items'], 'cs.item.manufacturer_id': ['cs_item_items'], 'cs.item.brand_name': ['cs_item_items'], 'cs.item.manager_id': ['cs_item_items'], 'cs.item.units': ['cs_item_items'], 'cs.date.date_string': ['cs_date_date'], 'cs.date.date': ['cs_date_date'], 'cs.date.month_of_year': ['cs_date_date'], 'cs.date.day_of_week': ['cs_date_date'], 'cs.date._date_string': ['cs_date_date'], 'cs.date.quarter': ['cs_date_date'], 'cs.date._year_string': ['cs_date_date'], 'cs.date.week_seq': ['cs_date_date'], 'cs.bill_customer_demographic.employed_dependent_count': ['cs_bill_customer_demographic_customer_demographics'], 'cs.bill_customer_demographic.college_dependent_count': ['cs_bill_customer_demographic_customer_demographics'], 'cs.bill_customer_demographic.purchase_estimate': ['cs_bill_customer_demographic_customer_demographics'], 'cs.bill_customer_demographic.dependent_count': ['cs_bill_customer_demographic_customer_demographics'], 'cs.bill_customer_demographic.credit_rating': ['cs_bill_customer_demographic_customer_demographics'], 'cs.promotion.string_id': ['cs_promotion_promotion'], 'cs.promotion.cost': ['cs_promotion_promotion'], 'cs.promotion.channel_catalog': ['cs_promotion_promotion'], 'cs.extra_sales_price': ['cs_catalog_sales'], 'cs.extra_ship_cost': ['cs_catalog_sales'], 'cs.bill_customer.id': ['cs_catalog_sales'], 'cs.customer.address_id': ['cs_catalog_sales'], 'cs.time.id': ['cs_catalog_sales'], 'cs.call_center.id': ['cs_catalog_sales'], 'cs.extra_wholesale_cost': ['cs_catalog_sales'], 'cs.net_profit': ['cs_catalog_sales'], 'cs.sold_date.id': ['cs_catalog_sales'], 'cs.warehouse.id': ['cs_catalog_sales'], 'cs.ship_date.id': ['cs_catalog_sales'], 'cs.wholesale_cost': ['cs_catalog_sales'], 'cs.customer.id': ['cs_catalog_sales']}.
-- Output: cs.bill_customer_demographic.education_status@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.bill_customer_demographic.gender@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.bill_customer_demographic.id@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.bill_customer_demographic.marital_status@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.coupon_amt@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.date.id@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.date.year@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.item.id@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.item.name@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.list_price@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.order_number@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.promotion.channel_email@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.promotion.channel_event@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.promotion.id@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.quantity@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>, cs.sales_price@Grain<cs.bill_customer_demographic.id,cs.date.id,cs.item.id,cs.order_number,cs.promotion.id>.
-- Inputs: cs.bill_customer_demographic.education_status@Grain<cs.bill_customer_demographic.id>, cs.bill_customer_demographic.gender@Grain<cs.bill_customer_demographic.id>, cs.bill_customer_demographic.id@Grain<cs.bill_customer_demographic.id>, cs.bill_customer_demographic.marital_status@Grain<cs.bill_customer_demographic.id>, cs.coupon_amt@Grain<cs.item.id,cs.order_number>, cs.date.id@Grain<cs.date.id>, cs.date.year@Grain<cs.date.id>, cs.item.id@Grain<cs.item.id>, cs.item.name@Grain<cs.item.id>, cs.list_price@Grain<cs.item.id,cs.order_number>, cs.order_number@Grain<cs.order_number>, cs.promotion.channel_email@Grain<cs.promotion.id>, cs.promotion.channel_event@Grain<cs.promotion.id>, cs.promotion.id@Grain<cs.promotion.id>, cs.quantity@Grain<cs.item.id,cs.order_number>, cs.sales_price@Grain<cs.item.id,cs.order_number>.
SELECT
    cast(cs_date_date.\"D_YEAR\" as int) as \"cs_date_year\",
    cs_bill_customer_demographic_customer_demographics.\"CD_DEMO_SK\" as \"cs_bill_customer_demographic_id\",
    cs_bill_customer_demographic_customer_demographics.\"CD_EDUCATION_STATUS\" as \"cs_bill_customer_demographic_education_status\",
    cs_bill_customer_demographic_customer_demographics.\"CD_GENDER\" as \"cs_bill_customer_demographic_gender\",
    cs_bill_customer_demographic_customer_demographics.\"CD_MARITAL_STATUS\" as \"cs_bill_customer_demographic_marital_status\",
    cs_catalog_sales.\"CS_COUPON_AMT\" as \"cs_coupon_amt\",
    cs_catalog_sales.\"CS_LIST_PRICE\" as \"cs_list_price\",
    cs_catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",
    cs_catalog_sales.\"CS_QUANTITY\" as \"cs_quantity\",
    cs_catalog_sales.\"CS_SALES_PRICE\" as \"cs_sales_price\",
    cs_date_date.\"D_DATE_SK\" as \"cs_date_id\",
    cs_item_items.\"I_ITEM_ID\" as \"cs_item_name\",
    cs_item_items.\"I_ITEM_SK\" as \"cs_item_id\",
    cs_promotion_promotion.\"P_CHANNEL_EMAIL\" as \"cs_promotion_channel_email\",
    cs_promotion_promotion.\"P_CHANNEL_EVENT\" as \"cs_promotion_channel_event\",
    cs_promotion_promotion.\"P_PROMO_SK\" as \"cs_promotion_id\"
FROM
    memory.customer_demographics as cs_bill_customer_demographic_customer_demographics
    INNER JOIN memory.catalog_sales as cs_catalog_sales on cs_bill_customer_demographic_customer_demographics.\"CD_DEMO_SK\" = cs_catalog_sales.\"CS_BILL_CDEMO_SK\"
    INNER JOIN memory.date_dim as cs_date_date on cs_catalog_sales.\"CS_SOLD_DATE_SK\" = cs_date_date.\"D_DATE_SK\"
    INNER JOIN memory.item as cs_item_items on cs_catalog_sales.\"CS_ITEM_SK\" = cs_item_items.\"I_ITEM_SK\"
    INNER JOIN memory.promotion as cs_promotion_promotion on cs_catalog_sales.\"CS_PROMO_SK\" = cs_promotion_promotion.\"P_PROMO_SK\"
WHERE
    cs_bill_customer_demographic_customer_demographics.\"CD_GENDER\" = 'M' and cs_bill_customer_demographic_customer_demographics.\"CD_MARITAL_STATUS\" = 'S' and cs_bill_customer_demographic_customer_demographics.\"CD_EDUCATION_STATUS\" = 'College' and ( cs_promotion_promotion.\"P_CHANNEL_EMAIL\" = 'N' or cs_promotion_promotion.\"P_CHANNEL_EVENT\" = 'N' ) and cast(cs_date_date.\"D_YEAR\" as int) = 2000
)
-- Target: Grain<cs.item.name>. Group: True Source: SourceType.GROUP. References: thoughtful.
-- Source Map: {'cs.bill_customer_demographic.education_status': ['thoughtful'], 'cs.bill_customer_demographic.gender': ['thoughtful'], 'cs.bill_customer_demographic.id': ['thoughtful'], 'cs.bill_customer_demographic.marital_status': ['thoughtful'], 'cs.coupon_amt': ['thoughtful'], 'cs.date.id': ['thoughtful'], 'cs.date.year': ['thoughtful'], 'cs.item.id': ['thoughtful'], 'cs.item.name': ['thoughtful'], 'cs.list_price': ['thoughtful'], 'cs.order_number': ['thoughtful'], 'cs.promotion.channel_email': ['thoughtful'], 'cs.promotion.channel_event': ['thoughtful'], 'cs.promotion.id': ['thoughtful'], 'cs.quantity': ['thoughtful'], 'cs.sales_price': ['thoughtful'], 'local.agg1': [], 'local.agg2': [], 'local.agg3': [], 'local.agg4': []}.
-- Output: cs.item.name@Grain<cs.item.name>, local.agg1@Grain<cs.item.name>, local.agg2@Grain<cs.item.name>, local.agg3@Grain<cs.item.name>, local.agg4@Grain<cs.item.name>.
-- Inputs: cs.quantity@Grain<cs.item.id,cs.order_number>, cs.item.name@Grain<cs.item.id>, cs.order_number@Grain<cs.order_number>, cs.item.id@Grain<cs.item.id>, cs.list_price@Grain<cs.item.id,cs.order_number>, cs.coupon_amt@Grain<cs.item.id,cs.order_number>, cs.sales_price@Grain<cs.item.id,cs.order_number>.
-- Nullable: local.agg1@Grain<cs.item.name>, local.agg2@Grain<cs.item.name>, local.agg3@Grain<cs.item.name>, local.agg4@Grain<cs.item.name>.
SELECT
    thoughtful.\"cs_item_name\" as \"cs_item_name\",
    avg(thoughtful.\"cs_quantity\") as \"agg1\",
    avg(thoughtful.\"cs_list_price\") as \"agg2\",
    avg(thoughtful.\"cs_coupon_amt\") as \"agg3\",
    avg(thoughtful.\"cs_sales_price\") as \"agg4\"
FROM
    thoughtful
GROUP BY 
    thoughtful.\"cs_item_name\"
ORDER BY 
    thoughtful.\"cs_item_name\" asc
LIMIT (100)"""
