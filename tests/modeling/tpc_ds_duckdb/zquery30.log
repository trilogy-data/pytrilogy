query_id = 30
gen_length = 45339
generated_sql = """

WITH 
cheerful as (
-- Target: Grain<web_returns.customer.id,web_returns.return_address.id>. Group: True Source: SourceType.GROUP.
-- Source Map: {'web_returns.customer.id': ['web_returns_web_returns'], 'web_returns.return_address.id': ['web_returns_web_returns'], 'web_returns.item.id': ['web_returns_web_returns'], 'web_returns.time.id': ['web_returns_web_returns'], 'web_returns.return_amount': ['web_returns_web_returns'], 'web_returns.store.id': ['web_returns_web_returns'], 'web_returns.return_date.id': ['web_returns_web_returns'], 'web_returns.web_sales.order_number': ['web_returns_web_returns']}.
-- Output: web_returns.customer.id@Grain<web_returns.customer.id,web_returns.return_address.id>, web_returns.return_address.id@Grain<web_returns.customer.id,web_returns.return_address.id>.
-- Inputs: web_returns.customer.id@Grain<web_returns.customer.id>, web_returns.return_address.id@Grain<web_returns.return_address.id>.
SELECT
    web_returns_web_returns.\"WR_RETURNING_ADDR_SK\" as \"web_returns_return_address_id\",
    web_returns_web_returns.\"WR_RETURNING_CUSTOMER_SK\" as \"web_returns_customer_id\"
FROM
    memory.web_returns as web_returns_web_returns
GROUP BY 
    web_returns_web_returns.\"WR_RETURNING_ADDR_SK\",
    web_returns_web_returns.\"WR_RETURNING_CUSTOMER_SK\"),
questionable as (
-- Target: Grain<web_returns.item.id,web_returns.return_date.id,web_returns.web_sales.order_number>. Group: False Source: SourceType.MERGE.
-- Joins: inner join web_returns_return_date_date on wakeful.web_returns.return_date.id=web_returns.return_date.id.
-- Source Map: {'web_returns.return_date.year': ['web_returns_return_date_date'], 'web_returns.return_date.id': ['web_returns_return_date_date'], 'web_returns.web_sales.order_number': ['web_returns_web_returns'], 'web_returns.item.id': ['web_returns_web_returns'], 'web_returns.return_amount': ['web_returns_web_returns'], 'web_returns.return_date._date_string': ['web_returns_return_date_date'], 'web_returns.return_date.week_seq': ['web_returns_return_date_date'], 'web_returns.return_date.month_of_year': ['web_returns_return_date_date'], 'web_returns.return_date.day_of_week': ['web_returns_return_date_date'], 'web_returns.return_date._year_string': ['web_returns_return_date_date'], 'web_returns.return_date.quarter': ['web_returns_return_date_date'], 'web_returns.return_date.date': ['web_returns_return_date_date'], 'web_returns.return_date.date_string': ['web_returns_return_date_date'], 'web_returns.return_address.id': ['web_returns_web_returns'], 'web_returns.time.id': ['web_returns_web_returns'], 'web_returns.store.id': ['web_returns_web_returns'], 'web_returns.customer.id': ['web_returns_web_returns']}.
-- Output: web_returns.item.id@Grain<web_returns.item.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.return_amount@Grain<web_returns.item.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.return_date.id@Grain<web_returns.item.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.return_date.year@Grain<web_returns.item.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.web_sales.order_number@Grain<web_returns.item.id,web_returns.return_date.id,web_returns.web_sales.order_number>.
-- Inputs: web_returns.item.id@Grain<web_returns.item.id>, web_returns.return_amount@Grain<web_returns.item.id,web_returns.web_sales.order_number>, web_returns.return_date.id@Grain<web_returns.return_date.id>, web_returns.return_date.year@Grain<web_returns.return_date.id>, web_returns.web_sales.order_number@Grain<web_returns.web_sales.order_number>.
SELECT
    cast(web_returns_return_date_date.\"D_YEAR\" as int) as \"web_returns_return_date_year\",
    web_returns_return_date_date.\"D_DATE_SK\" as \"web_returns_return_date_id\",
    web_returns_web_returns.\"WR_ITEM_SK\" as \"web_returns_item_id\",
    web_returns_web_returns.\"WR_ORDER_NUMBER\" as \"web_returns_web_sales_order_number\",
    web_returns_web_returns.\"WR_RETURN_AMT\" as \"web_returns_return_amount\"
FROM
    memory.web_returns as web_returns_web_returns
    INNER JOIN memory.date_dim as web_returns_return_date_date on web_returns_web_returns.\"WR_RETURNED_DATE_SK\" = web_returns_return_date_date.\"D_DATE_SK\"),
uneven as (
-- Target: Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.web_sales.order_number>. Group: False Source: SourceType.MERGE.
-- Joins: inner join web_returns_return_address_customer_address on wakeful.web_returns.return_address.id=web_returns.return_address.id, inner join web_returns_return_date_date on wakeful.web_returns.return_date.id=web_returns.return_date.id.
-- Source Map: {'web_returns.return_date.year': ['web_returns_return_date_date'], 'web_returns.return_date.id': ['web_returns_return_date_date'], 'web_returns.return_address.id': ['web_returns_return_address_customer_address'], 'web_returns.return_address.state': ['web_returns_return_address_customer_address'], 'web_returns.item.id': ['web_returns_web_returns'], 'web_returns.return_amount': ['web_returns_web_returns'], 'web_returns.customer.id': ['web_returns_web_returns'], 'web_returns.web_sales.order_number': ['web_returns_web_returns'], 'web_returns.return_date._date_string': ['web_returns_return_date_date'], 'web_returns.return_date.week_seq': ['web_returns_return_date_date'], 'web_returns.return_date.month_of_year': ['web_returns_return_date_date'], 'web_returns.return_date.day_of_week': ['web_returns_return_date_date'], 'web_returns.return_date._year_string': ['web_returns_return_date_date'], 'web_returns.return_date.quarter': ['web_returns_return_date_date'], 'web_returns.return_date.date': ['web_returns_return_date_date'], 'web_returns.return_date.date_string': ['web_returns_return_date_date'], 'web_returns.return_address.city': ['web_returns_return_address_customer_address'], 'web_returns.return_address.street': ['web_returns_return_address_customer_address'], 'web_returns.return_address.zip': ['web_returns_return_address_customer_address'], 'web_returns.return_address.county': ['web_returns_return_address_customer_address'], 'web_returns.return_address.country': ['web_returns_return_address_customer_address'], 'web_returns.time.id': ['web_returns_web_returns'], 'web_returns.store.id': ['web_returns_web_returns']}.
-- Output: web_returns.customer.id@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.item.id@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.return_address.id@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.return_address.state@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.return_amount@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.return_date.id@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.return_date.year@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.web_sales.order_number>, web_returns.web_sales.order_number@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.web_sales.order_number>.
-- Inputs: web_returns.customer.id@Grain<web_returns.customer.id>, web_returns.item.id@Grain<web_returns.item.id>, web_returns.return_address.id@Grain<web_returns.return_address.id>, web_returns.return_address.state@Grain<web_returns.return_address.id>, web_returns.return_amount@Grain<web_returns.item.id,web_returns.web_sales.order_number>, web_returns.return_date.id@Grain<web_returns.return_date.id>, web_returns.return_date.year@Grain<web_returns.return_date.id>, web_returns.web_sales.order_number@Grain<web_returns.web_sales.order_number>.
SELECT
    cast(web_returns_return_date_date.\"D_YEAR\" as int) as \"web_returns_return_date_year\",
    web_returns_return_address_customer_address.\"CA_ADDRESS_SK\" as \"web_returns_return_address_id\",
    web_returns_return_address_customer_address.\"CA_STATE\" as \"web_returns_return_address_state\",
    web_returns_return_date_date.\"D_DATE_SK\" as \"web_returns_return_date_id\",
    web_returns_web_returns.\"WR_ITEM_SK\" as \"web_returns_item_id\",
    web_returns_web_returns.\"WR_ORDER_NUMBER\" as \"web_returns_web_sales_order_number\",
    web_returns_web_returns.\"WR_RETURNING_CUSTOMER_SK\" as \"web_returns_customer_id\",
    web_returns_web_returns.\"WR_RETURN_AMT\" as \"web_returns_return_amount\"
FROM
    memory.web_returns as web_returns_web_returns
    INNER JOIN memory.customer_address as web_returns_return_address_customer_address on web_returns_web_returns.\"WR_RETURNING_ADDR_SK\" = web_returns_return_address_customer_address.\"CA_ADDRESS_SK\"
    INNER JOIN memory.date_dim as web_returns_return_date_date on web_returns_web_returns.\"WR_RETURNED_DATE_SK\" = web_returns_return_date_date.\"D_DATE_SK\"
WHERE
    web_returns_return_address_customer_address.\"CA_STATE\" is not null
),
thoughtful as (
-- Target: Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>. Group: False Source: SourceType.MERGE. References: cheerful.
-- Joins: inner join web_returns_customer_customers on highfalutin.web_returns.customer.address_id=web_returns.customer.address_id, inner join cheerful on quizzical.web_returns.customer.id=web_returns.customer.id, inner join web_returns_return_address_customer_address on cheerful.web_returns.return_address.id=web_returns.return_address.id.
-- Source Map: {'web_returns.customer.birth_year': ['web_returns_customer_customers'], 'web_returns.customer.preferred_cust_flag': ['web_returns_customer_customers'], 'web_returns.customer.first_name': ['web_returns_customer_customers'], 'web_returns.customer.birth_country': ['web_returns_customer_customers'], 'web_returns.customer.login': ['web_returns_customer_customers'], 'web_returns.customer.text_id': ['web_returns_customer_customers'], 'web_returns.customer.salutation': ['web_returns_customer_customers'], 'web_returns.customer.email_address': ['web_returns_customer_customers'], 'web_returns.customer.last_name': ['web_returns_customer_customers'], 'web_returns.customer.birth_day': ['web_returns_customer_customers'], 'web_returns.customer.last_review_date': ['web_returns_customer_customers'], 'web_returns.customer.birth_month': ['web_returns_customer_customers'], 'web_returns.customer.id': ['web_returns_customer_customers'], 'web_returns.customer.address_id': ['web_returns_customer_customers'], 'web_returns.customer.state': ['web_returns_customer_customer_address'], 'web_returns.return_address.id': ['web_returns_return_address_customer_address'], 'web_returns.return_address.state': ['web_returns_return_address_customer_address'], 'web_returns.customer.demographics.id': ['web_returns_customer_customers'], 'web_returns.customer.city': ['web_returns_customer_customer_address'], 'web_returns.customer.street': ['web_returns_customer_customer_address'], 'web_returns.customer.zip': ['web_returns_customer_customer_address'], 'web_returns.customer.country': ['web_returns_customer_customer_address'], 'web_returns.customer.county': ['web_returns_customer_customer_address'], 'web_returns.return_address.city': ['web_returns_return_address_customer_address'], 'web_returns.return_address.street': ['web_returns_return_address_customer_address'], 'web_returns.return_address.zip': ['web_returns_return_address_customer_address'], 'web_returns.return_address.county': ['web_returns_return_address_customer_address'], 'web_returns.return_address.country': ['web_returns_return_address_customer_address']}.
-- Output: web_returns.customer.address_id@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.birth_country@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.birth_day@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.birth_month@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.birth_year@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.email_address@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.first_name@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.id@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.last_name@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.last_review_date@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.login@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.preferred_cust_flag@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.salutation@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.state@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.customer.text_id@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.return_address.id@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>, web_returns.return_address.state@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id>.
-- Inputs: web_returns.customer.address_id@Grain<web_returns.customer.address_id>, web_returns.customer.birth_country@Grain<web_returns.customer.id>, web_returns.customer.birth_day@Grain<web_returns.customer.id>, web_returns.customer.birth_month@Grain<web_returns.customer.id>, web_returns.customer.birth_year@Grain<web_returns.customer.id>, web_returns.customer.email_address@Grain<web_returns.customer.id>, web_returns.customer.first_name@Grain<web_returns.customer.id>, web_returns.customer.id@Grain<web_returns.customer.id>, web_returns.customer.last_name@Grain<web_returns.customer.id>, web_returns.customer.last_review_date@Grain<web_returns.customer.id>, web_returns.customer.login@Grain<web_returns.customer.id>, web_returns.customer.preferred_cust_flag@Grain<web_returns.customer.id>, web_returns.customer.salutation@Grain<web_returns.customer.id>, web_returns.customer.state@Grain<web_returns.customer.address_id>, web_returns.customer.text_id@Grain<web_returns.customer.id>, web_returns.return_address.id@Grain<web_returns.return_address.id>, web_returns.return_address.state@Grain<web_returns.return_address.id>.
SELECT
    web_returns_customer_customer_address.\"CA_STATE\" as \"web_returns_customer_state\",
    web_returns_customer_customers.\"C_BIRTH_COUNTRY\" as \"web_returns_customer_birth_country\",
    web_returns_customer_customers.\"C_BIRTH_DAY\" as \"web_returns_customer_birth_day\",
    web_returns_customer_customers.\"C_BIRTH_MONTH\" as \"web_returns_customer_birth_month\",
    web_returns_customer_customers.\"C_BIRTH_YEAR\" as \"web_returns_customer_birth_year\",
    web_returns_customer_customers.\"C_CURRENT_ADDR_SK\" as \"web_returns_customer_address_id\",
    web_returns_customer_customers.\"C_CUSTOMER_ID\" as \"web_returns_customer_text_id\",
    web_returns_customer_customers.\"C_CUSTOMER_SK\" as \"web_returns_customer_id\",
    web_returns_customer_customers.\"C_EMAIL_ADDRESS\" as \"web_returns_customer_email_address\",
    web_returns_customer_customers.\"C_FIRST_NAME\" as \"web_returns_customer_first_name\",
    web_returns_customer_customers.\"C_LAST_NAME\" as \"web_returns_customer_last_name\",
    web_returns_customer_customers.\"C_LAST_REVIEW_DATE_SK\" as \"web_returns_customer_last_review_date\",
    web_returns_customer_customers.\"C_LOGIN\" as \"web_returns_customer_login\",
    web_returns_customer_customers.\"C_PREFERRED_CUST_FLAG\" as \"web_returns_customer_preferred_cust_flag\",
    web_returns_customer_customers.\"C_SALUTATION\" as \"web_returns_customer_salutation\",
    web_returns_return_address_customer_address.\"CA_ADDRESS_SK\" as \"web_returns_return_address_id\",
    web_returns_return_address_customer_address.\"CA_STATE\" as \"web_returns_return_address_state\"
FROM
    memory.customer_address as web_returns_customer_customer_address
    INNER JOIN memory.customer as web_returns_customer_customers on web_returns_customer_customer_address.\"CA_ADDRESS_SK\" = web_returns_customer_customers.\"C_CURRENT_ADDR_SK\"
    INNER JOIN cheerful on web_returns_customer_customers.\"C_CUSTOMER_SK\" = cheerful.\"web_returns_customer_id\"
    INNER JOIN memory.customer_address as web_returns_return_address_customer_address on cheerful.\"web_returns_return_address_id\" = web_returns_return_address_customer_address.\"CA_ADDRESS_SK\"
WHERE
    web_returns_customer_customer_address.\"CA_STATE\" = 'GA' and web_returns_return_address_customer_address.\"CA_STATE\" is not null
),
abundant as (
-- Target: Grain<web_returns.item.id,web_returns.return_date.year,web_returns.web_sales.order_number>. Group: False Source: SourceType.FILTER. References: questionable.
-- Source Map: {'web_returns.item.id': ['questionable'], 'web_returns.return_amount': ['questionable'], 'web_returns.return_date.id': ['questionable'], 'web_returns.return_date.year': ['questionable'], 'web_returns.web_sales.order_number': ['questionable'], 'local._virt_1372977232752887': []}.
-- Output: local._virt_1372977232752887@Grain<web_returns.item.id,web_returns.return_date.year,web_returns.web_sales.order_number>, web_returns.return_amount@Grain<web_returns.item.id,web_returns.return_date.year,web_returns.web_sales.order_number>, web_returns.return_date.year@Grain<web_returns.item.id,web_returns.return_date.year,web_returns.web_sales.order_number>, web_returns.item.id@Grain<web_returns.item.id,web_returns.return_date.year,web_returns.web_sales.order_number>, web_returns.web_sales.order_number@Grain<web_returns.item.id,web_returns.return_date.year,web_returns.web_sales.order_number>.
-- Inputs: web_returns.return_amount@Grain<web_returns.item.id,web_returns.web_sales.order_number>, web_returns.return_date.year@Grain<web_returns.return_date.id>, web_returns.item.id@Grain<web_returns.item.id>, web_returns.web_sales.order_number@Grain<web_returns.web_sales.order_number>.
SELECT
    CASE WHEN questionable.\"web_returns_return_date_year\" = 2002 THEN questionable.\"web_returns_return_amount\" ELSE NULL END as \"_virt_1372977232752887\",
    questionable.\"web_returns_item_id\" as \"web_returns_item_id\",
    questionable.\"web_returns_return_amount\" as \"web_returns_return_amount\",
    questionable.\"web_returns_return_date_year\" as \"web_returns_return_date_year\",
    questionable.\"web_returns_web_sales_order_number\" as \"web_returns_web_sales_order_number\"
FROM
    questionable),
yummy as (
-- Target: Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.return_date.year,web_returns.web_sales.order_number>. Group: False Source: SourceType.MERGE. References: abundant, uneven.
-- Joins: inner join abundant on uneven.web_returns.return_date.year=web_returns.return_date.year,uneven.web_returns.item.id=web_returns.item.id,uneven.web_returns.web_sales.order_number=web_returns.web_sales.order_number,uneven.web_returns.return_amount=web_returns.return_amount.
-- Source Map: {'local._virt_1372977232752887': ['abundant'], 'web_returns.return_amount': ['abundant'], 'web_returns.return_date.year': ['abundant'], 'web_returns.item.id': ['abundant'], 'web_returns.web_sales.order_number': ['abundant'], 'web_returns.customer.id': ['uneven'], 'web_returns.return_address.id': ['uneven'], 'web_returns.return_address.state': ['uneven'], 'web_returns.return_date.id': ['uneven']}.
-- Output: local._virt_1372977232752887@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.return_date.year,web_returns.web_sales.order_number>, web_returns.return_address.state@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.return_date.year,web_returns.web_sales.order_number>, web_returns.customer.id@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.return_date.year,web_returns.web_sales.order_number>, web_returns.web_sales.order_number@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.return_date.year,web_returns.web_sales.order_number>, web_returns.item.id@Grain<web_returns.item.id,web_returns.return_address.id,web_returns.return_date.id,web_returns.return_date.year,web_returns.web_sales.order_number>.
-- Inputs: local._virt_1372977232752887@Grain<web_returns.item.id,web_returns.web_sales.order_number>, web_returns.return_amount@Grain<web_returns.item.id,web_returns.web_sales.order_number>, web_returns.return_address.state@Grain<web_returns.return_address.id>, web_returns.customer.id@Grain<web_returns.customer.id>, web_returns.web_sales.order_number@Grain<web_returns.web_sales.order_number>, web_returns.item.id@Grain<web_returns.item.id>.
SELECT
    abundant.\"_virt_1372977232752887\" as \"_virt_1372977232752887\",
    abundant.\"web_returns_item_id\" as \"web_returns_item_id\",
    abundant.\"web_returns_web_sales_order_number\" as \"web_returns_web_sales_order_number\",
    uneven.\"web_returns_customer_id\" as \"web_returns_customer_id\",
    uneven.\"web_returns_return_address_state\" as \"web_returns_return_address_state\"
FROM
    uneven
    INNER JOIN abundant on uneven.\"web_returns_item_id\" = abundant.\"web_returns_item_id\" AND uneven.\"web_returns_return_amount\" = abundant.\"web_returns_return_amount\" AND uneven.\"web_returns_return_date_year\" = abundant.\"web_returns_return_date_year\" AND uneven.\"web_returns_web_sales_order_number\" = abundant.\"web_returns_web_sales_order_number\"
WHERE
    uneven.\"web_returns_return_address_state\" is not null
),
juicy as (
-- Target: Grain<web_returns.customer.id,web_returns.return_address.state>. Group: True Source: SourceType.GROUP. References: yummy.
-- Source Map: {'local._virt_1372977232752887': ['yummy'], 'web_returns.return_address.state': ['yummy'], 'web_returns.customer.id': ['yummy'], 'web_returns.web_sales.order_number': ['yummy'], 'web_returns.item.id': ['yummy'], 'local.customer_state_returns_2002': []}.
-- Output: local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>, web_returns.return_address.state@Grain<web_returns.customer.id,web_returns.return_address.state>, web_returns.customer.id@Grain<web_returns.customer.id,web_returns.return_address.state>.
-- Inputs: local._virt_1372977232752887@Grain<web_returns.item.id,web_returns.web_sales.order_number>, web_returns.return_address.state@Grain<web_returns.return_address.id>, web_returns.customer.id@Grain<web_returns.customer.id>, web_returns.web_sales.order_number@Grain<web_returns.web_sales.order_number>, web_returns.item.id@Grain<web_returns.item.id>.
-- Nullable: local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>.
SELECT
    sum(yummy.\"_virt_1372977232752887\") as \"customer_state_returns_2002\",
    yummy.\"web_returns_customer_id\" as \"web_returns_customer_id\",
    yummy.\"web_returns_return_address_state\" as \"web_returns_return_address_state\"
FROM
    yummy
GROUP BY 
    yummy.\"web_returns_customer_id\",
    yummy.\"web_returns_return_address_state\"),
concerned as (
-- Target: Grain<web_returns.return_address.state>. Group: True Source: SourceType.GROUP. References: juicy.
-- Source Map: {'local.customer_state_returns_2002': ['juicy'], 'web_returns.return_address.state': ['juicy'], 'web_returns.customer.id': ['juicy'], 'local._virt_7168202961459893': []}.
-- Output: local._virt_7168202961459893@Grain<web_returns.return_address.state>, web_returns.return_address.state@Grain<web_returns.return_address.state>.
-- Inputs: local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>, web_returns.return_address.state@Grain<web_returns.return_address.id>.
-- Nullable: local._virt_7168202961459893@Grain<web_returns.return_address.state>.
SELECT
    avg(juicy.\"customer_state_returns_2002\") as \"_virt_7168202961459893\",
    juicy.\"web_returns_return_address_state\" as \"web_returns_return_address_state\"
FROM
    juicy
GROUP BY 
    juicy.\"web_returns_return_address_state\"),
vacuous as (
-- Target: Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>. Group: False Source: SourceType.MERGE. References: thoughtful, juicy.
-- Joins: inner join thoughtful on juicy.web_returns.return_address.state=web_returns.return_address.state,juicy.web_returns.customer.id=web_returns.customer.id.
-- Source Map: {'web_returns.customer.address_id': ['thoughtful'], 'web_returns.customer.birth_country': ['thoughtful'], 'web_returns.customer.birth_day': ['thoughtful'], 'web_returns.customer.birth_month': ['thoughtful'], 'web_returns.customer.birth_year': ['thoughtful'], 'web_returns.customer.email_address': ['thoughtful'], 'web_returns.customer.first_name': ['thoughtful'], 'web_returns.customer.id': ['thoughtful'], 'web_returns.customer.last_name': ['thoughtful'], 'web_returns.customer.last_review_date': ['thoughtful'], 'web_returns.customer.login': ['thoughtful'], 'web_returns.customer.preferred_cust_flag': ['thoughtful'], 'web_returns.customer.salutation': ['thoughtful'], 'web_returns.customer.state': ['thoughtful'], 'web_returns.customer.text_id': ['thoughtful'], 'web_returns.return_address.id': ['thoughtful'], 'web_returns.return_address.state': ['thoughtful'], 'local.customer_state_returns_2002': ['juicy']}.
-- Output: web_returns.return_address.state@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.id@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.text_id@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.salutation@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.first_name@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.last_name@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.preferred_cust_flag@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.birth_day@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.birth_month@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.birth_year@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.birth_country@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.login@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.email_address@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.last_review_date@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.state@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>.
-- Inputs: web_returns.return_address.state@Grain<web_returns.return_address.id>, web_returns.customer.id@Grain<web_returns.customer.id>, web_returns.customer.text_id@Grain<web_returns.customer.id>, web_returns.customer.salutation@Grain<web_returns.customer.id>, web_returns.customer.first_name@Grain<web_returns.customer.id>, web_returns.customer.last_name@Grain<web_returns.customer.id>, web_returns.customer.preferred_cust_flag@Grain<web_returns.customer.id>, web_returns.customer.birth_day@Grain<web_returns.customer.id>, web_returns.customer.birth_month@Grain<web_returns.customer.id>, web_returns.customer.birth_year@Grain<web_returns.customer.id>, web_returns.customer.birth_country@Grain<web_returns.customer.id>, web_returns.customer.login@Grain<web_returns.customer.id>, web_returns.customer.email_address@Grain<web_returns.customer.id>, web_returns.customer.last_review_date@Grain<web_returns.customer.id>, web_returns.customer.state@Grain<web_returns.customer.address_id>, local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>.
-- Nullable: local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>.
SELECT
    juicy.\"customer_state_returns_2002\" as \"customer_state_returns_2002\",
    thoughtful.\"web_returns_customer_birth_country\" as \"web_returns_customer_birth_country\",
    thoughtful.\"web_returns_customer_birth_day\" as \"web_returns_customer_birth_day\",
    thoughtful.\"web_returns_customer_birth_month\" as \"web_returns_customer_birth_month\",
    thoughtful.\"web_returns_customer_birth_year\" as \"web_returns_customer_birth_year\",
    thoughtful.\"web_returns_customer_email_address\" as \"web_returns_customer_email_address\",
    thoughtful.\"web_returns_customer_first_name\" as \"web_returns_customer_first_name\",
    thoughtful.\"web_returns_customer_id\" as \"web_returns_customer_id\",
    thoughtful.\"web_returns_customer_last_name\" as \"web_returns_customer_last_name\",
    thoughtful.\"web_returns_customer_last_review_date\" as \"web_returns_customer_last_review_date\",
    thoughtful.\"web_returns_customer_login\" as \"web_returns_customer_login\",
    thoughtful.\"web_returns_customer_preferred_cust_flag\" as \"web_returns_customer_preferred_cust_flag\",
    thoughtful.\"web_returns_customer_salutation\" as \"web_returns_customer_salutation\",
    thoughtful.\"web_returns_customer_state\" as \"web_returns_customer_state\",
    thoughtful.\"web_returns_customer_text_id\" as \"web_returns_customer_text_id\",
    thoughtful.\"web_returns_return_address_state\" as \"web_returns_return_address_state\"
FROM
    juicy
    INNER JOIN thoughtful on (juicy.\"web_returns_return_address_state\" = thoughtful.\"web_returns_return_address_state\" or (juicy.\"web_returns_return_address_state\" is null and thoughtful.\"web_returns_return_address_state\" is null)) AND juicy.\"web_returns_customer_id\" = thoughtful.\"web_returns_customer_id\"
WHERE
    thoughtful.\"web_returns_customer_state\" = 'GA' and thoughtful.\"web_returns_return_address_state\" is not null
),
young as (
-- Target: Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>. Group: False Source: SourceType.BASIC. References: vacuous, concerned.
-- Joins: inner join concerned on vacuous.web_returns.return_address.state=web_returns.return_address.state.
-- Source Map: {'web_returns.return_address.state': ['vacuous'], 'web_returns.customer.id': ['vacuous'], 'web_returns.customer.text_id': ['vacuous'], 'web_returns.customer.salutation': ['vacuous'], 'web_returns.customer.first_name': ['vacuous'], 'web_returns.customer.last_name': ['vacuous'], 'web_returns.customer.preferred_cust_flag': ['vacuous'], 'web_returns.customer.birth_day': ['vacuous'], 'web_returns.customer.birth_month': ['vacuous'], 'web_returns.customer.birth_year': ['vacuous'], 'web_returns.customer.birth_country': ['vacuous'], 'web_returns.customer.login': ['vacuous'], 'web_returns.customer.email_address': ['vacuous'], 'web_returns.customer.last_review_date': ['vacuous'], 'web_returns.customer.state': ['vacuous'], 'local.customer_state_returns_2002': ['vacuous'], 'local._virt_7168202961459893': ['concerned'], 'local.scaled_state_returns_2002': []}.
-- Output: web_returns.return_address.state@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.id@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.text_id@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.salutation@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.first_name@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.last_name@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.preferred_cust_flag@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.birth_day@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.birth_month@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.birth_year@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.birth_country@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.login@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.email_address@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, web_returns.customer.last_review_date@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>, web_returns.customer.state@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>, local.scaled_state_returns_2002@Grain<web_returns.customer.address_id,web_returns.customer.id,web_returns.return_address.id,web_returns.return_address.state>.
-- Inputs: web_returns.return_address.state@Grain<web_returns.return_address.id>, web_returns.customer.id@Grain<web_returns.customer.id>, web_returns.customer.text_id@Grain<web_returns.customer.id>, web_returns.customer.salutation@Grain<web_returns.customer.id>, web_returns.customer.first_name@Grain<web_returns.customer.id>, web_returns.customer.last_name@Grain<web_returns.customer.id>, web_returns.customer.preferred_cust_flag@Grain<web_returns.customer.id>, web_returns.customer.birth_day@Grain<web_returns.customer.id>, web_returns.customer.birth_month@Grain<web_returns.customer.id>, web_returns.customer.birth_year@Grain<web_returns.customer.id>, web_returns.customer.birth_country@Grain<web_returns.customer.id>, web_returns.customer.login@Grain<web_returns.customer.id>, web_returns.customer.email_address@Grain<web_returns.customer.id>, web_returns.customer.last_review_date@Grain<web_returns.customer.id>, local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>, web_returns.customer.state@Grain<web_returns.customer.address_id>, local._virt_7168202961459893@Grain<web_returns.return_address.state>.
-- Hidden: local._virt_7168202961459893@Grain<web_returns.return_address.state>.
-- Nullable: local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>, local.scaled_state_returns_2002@Grain<web_returns.return_address.state>.
SELECT
    1.2 * concerned.\"_virt_7168202961459893\" as \"scaled_state_returns_2002\",
    vacuous.\"customer_state_returns_2002\" as \"customer_state_returns_2002\",
    vacuous.\"web_returns_customer_birth_country\" as \"web_returns_customer_birth_country\",
    vacuous.\"web_returns_customer_birth_day\" as \"web_returns_customer_birth_day\",
    vacuous.\"web_returns_customer_birth_month\" as \"web_returns_customer_birth_month\",
    vacuous.\"web_returns_customer_birth_year\" as \"web_returns_customer_birth_year\",
    vacuous.\"web_returns_customer_email_address\" as \"web_returns_customer_email_address\",
    vacuous.\"web_returns_customer_first_name\" as \"web_returns_customer_first_name\",
    vacuous.\"web_returns_customer_id\" as \"web_returns_customer_id\",
    vacuous.\"web_returns_customer_last_name\" as \"web_returns_customer_last_name\",
    vacuous.\"web_returns_customer_last_review_date\" as \"web_returns_customer_last_review_date\",
    vacuous.\"web_returns_customer_login\" as \"web_returns_customer_login\",
    vacuous.\"web_returns_customer_preferred_cust_flag\" as \"web_returns_customer_preferred_cust_flag\",
    vacuous.\"web_returns_customer_salutation\" as \"web_returns_customer_salutation\",
    vacuous.\"web_returns_customer_state\" as \"web_returns_customer_state\",
    vacuous.\"web_returns_customer_text_id\" as \"web_returns_customer_text_id\",
    vacuous.\"web_returns_return_address_state\" as \"web_returns_return_address_state\"
FROM
    vacuous
    INNER JOIN concerned on (vacuous.\"web_returns_return_address_state\" = concerned.\"web_returns_return_address_state\" or (vacuous.\"web_returns_return_address_state\" is null and concerned.\"web_returns_return_address_state\" is null))
WHERE
    vacuous.\"customer_state_returns_2002\" > 1.2 * concerned.\"_virt_7168202961459893\" and vacuous.\"web_returns_customer_state\" = 'GA' and vacuous.\"web_returns_return_address_state\" is not null
)
-- Target: Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>. Group: True Source: SourceType.GROUP. References: young.
-- Source Map: {'web_returns.return_address.state': ['young'], 'web_returns.customer.id': ['young'], 'web_returns.customer.text_id': ['young'], 'web_returns.customer.salutation': ['young'], 'web_returns.customer.first_name': ['young'], 'web_returns.customer.last_name': ['young'], 'web_returns.customer.preferred_cust_flag': ['young'], 'web_returns.customer.birth_day': ['young'], 'web_returns.customer.birth_month': ['young'], 'web_returns.customer.birth_year': ['young'], 'web_returns.customer.birth_country': ['young'], 'web_returns.customer.login': ['young'], 'web_returns.customer.email_address': ['young'], 'web_returns.customer.last_review_date': ['young'], 'local.customer_state_returns_2002': ['young'], 'web_returns.customer.state': ['young'], 'local.scaled_state_returns_2002': ['young']}.
-- Output: web_returns.customer.text_id@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.salutation@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.first_name@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.last_name@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.preferred_cust_flag@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.birth_day@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.birth_month@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.birth_year@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.birth_country@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.login@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.email_address@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, web_returns.customer.last_review_date@Grain<web_returns.customer.id,web_returns.customer.state,web_returns.return_address.state>, local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>.
-- Inputs: web_returns.return_address.state@Grain<web_returns.return_address.id>, web_returns.customer.id@Grain<web_returns.customer.id>, web_returns.customer.text_id@Grain<web_returns.customer.id>, web_returns.customer.salutation@Grain<web_returns.customer.id>, web_returns.customer.first_name@Grain<web_returns.customer.id>, web_returns.customer.last_name@Grain<web_returns.customer.id>, web_returns.customer.preferred_cust_flag@Grain<web_returns.customer.id>, web_returns.customer.birth_day@Grain<web_returns.customer.id>, web_returns.customer.birth_month@Grain<web_returns.customer.id>, web_returns.customer.birth_year@Grain<web_returns.customer.id>, web_returns.customer.birth_country@Grain<web_returns.customer.id>, web_returns.customer.login@Grain<web_returns.customer.id>, web_returns.customer.email_address@Grain<web_returns.customer.id>, web_returns.customer.last_review_date@Grain<web_returns.customer.id>, local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>, web_returns.customer.state@Grain<web_returns.customer.address_id>, local.scaled_state_returns_2002@Grain<web_returns.return_address.state>.
-- Hidden: web_returns.customer.id@Grain<web_returns.customer.id>.
-- Nullable: local.customer_state_returns_2002@Grain<web_returns.customer.id,web_returns.return_address.state>, local.scaled_state_returns_2002@Grain<web_returns.return_address.state>.
SELECT
    young.\"web_returns_customer_text_id\" as \"web_returns_customer_text_id\",
    young.\"web_returns_customer_salutation\" as \"web_returns_customer_salutation\",
    young.\"web_returns_customer_first_name\" as \"web_returns_customer_first_name\",
    young.\"web_returns_customer_last_name\" as \"web_returns_customer_last_name\",
    young.\"web_returns_customer_preferred_cust_flag\" as \"web_returns_customer_preferred_cust_flag\",
    young.\"web_returns_customer_birth_day\" as \"web_returns_customer_birth_day\",
    young.\"web_returns_customer_birth_month\" as \"web_returns_customer_birth_month\",
    young.\"web_returns_customer_birth_year\" as \"web_returns_customer_birth_year\",
    young.\"web_returns_customer_birth_country\" as \"web_returns_customer_birth_country\",
    young.\"web_returns_customer_login\" as \"web_returns_customer_login\",
    young.\"web_returns_customer_email_address\" as \"web_returns_customer_email_address\",
    young.\"web_returns_customer_last_review_date\" as \"web_returns_customer_last_review_date\",
    young.\"customer_state_returns_2002\" as \"customer_state_returns_2002\"
FROM
    young
GROUP BY 
    young.\"customer_state_returns_2002\",
    young.\"web_returns_customer_birth_country\",
    young.\"web_returns_customer_birth_day\",
    young.\"web_returns_customer_birth_month\",
    young.\"web_returns_customer_birth_year\",
    young.\"web_returns_customer_email_address\",
    young.\"web_returns_customer_first_name\",
    young.\"web_returns_customer_last_name\",
    young.\"web_returns_customer_last_review_date\",
    young.\"web_returns_customer_login\",
    young.\"web_returns_customer_preferred_cust_flag\",
    young.\"web_returns_customer_salutation\",
    young.\"web_returns_customer_text_id\"
ORDER BY 
    young.\"web_returns_customer_text_id\" asc nulls first,
    young.\"web_returns_customer_salutation\" asc nulls first,
    young.\"web_returns_customer_first_name\" asc nulls first,
    young.\"web_returns_customer_last_name\" asc nulls first,
    young.\"web_returns_customer_preferred_cust_flag\" asc nulls first,
    young.\"web_returns_customer_birth_day\" asc nulls first,
    young.\"web_returns_customer_birth_month\" asc nulls first,
    young.\"web_returns_customer_birth_year\" asc nulls first,
    young.\"web_returns_customer_birth_country\" asc nulls first,
    young.\"web_returns_customer_login\" asc nulls first,
    young.\"web_returns_customer_email_address\" asc nulls first,
    young.\"web_returns_customer_last_review_date\" asc nulls first,
    young.\"customer_state_returns_2002\" asc nulls first
LIMIT (100)"""
