query_id = 98
gen_length = 7767
generated_sql = """

WITH 
thoughtful as (
SELECT
    store_sales_store_sales.\"SS_ITEM_SK\" as \"store_sales_item_id\",
    store_sales_store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\"
FROM
    memory.store_sales as store_sales_store_sales
GROUP BY 
    store_sales_store_sales.\"SS_ITEM_SK\",
    store_sales_store_sales.\"SS_SOLD_DATE_SK\"),
wakeful as (
SELECT
    cast(store_sales_date_date.\"D_DATE\" as date) as \"store_sales_date_date\",
    store_sales_item_items.\"I_CATEGORY\" as \"store_sales_item_category\",
    store_sales_item_items.\"I_CLASS\" as \"store_sales_item_class\",
    store_sales_item_items.\"I_CURRENT_PRICE\" as \"store_sales_item_current_price\",
    store_sales_item_items.\"I_ITEM_DESC\" as \"store_sales_item_desc\",
    store_sales_item_items.\"I_ITEM_ID\" as \"store_sales_item_name\",
    store_sales_item_items.\"I_ITEM_SK\" as \"store_sales_item_id\",
    store_sales_store_sales.\"SS_EXT_SALES_PRICE\" as \"store_sales_ext_sales_price\",
    store_sales_store_sales.\"SS_TICKET_NUMBER\" as \"store_sales_ticket_number\"
FROM
    memory.store_sales as store_sales_store_sales
    INNER JOIN memory.item as store_sales_item_items on store_sales_store_sales.\"SS_ITEM_SK\" = store_sales_item_items.\"I_ITEM_SK\"
    INNER JOIN memory.date_dim as store_sales_date_date on store_sales_store_sales.\"SS_SOLD_DATE_SK\" = store_sales_date_date.\"D_DATE_SK\"
WHERE
    store_sales_item_items.\"I_CATEGORY\" in ('Sports','Books','Home') and cast(store_sales_date_date.\"D_DATE\" as date) >= date '1999-02-22' and cast(store_sales_date_date.\"D_DATE\" as date) <= date '1999-03-24'
),
cooperative as (
SELECT
    cast(store_sales_date_date.\"D_DATE\" as date) as \"store_sales_date_date\",
    store_sales_item_items.\"I_CATEGORY\" as \"store_sales_item_category\",
    store_sales_item_items.\"I_CLASS\" as \"store_sales_item_class\",
    store_sales_item_items.\"I_CURRENT_PRICE\" as \"store_sales_item_current_price\",
    store_sales_item_items.\"I_ITEM_DESC\" as \"store_sales_item_desc\",
    store_sales_item_items.\"I_ITEM_ID\" as \"store_sales_item_name\"
FROM
    thoughtful
    INNER JOIN memory.item as store_sales_item_items on thoughtful.\"store_sales_item_id\" = store_sales_item_items.\"I_ITEM_SK\"
    INNER JOIN memory.date_dim as store_sales_date_date on thoughtful.\"store_sales_date_id\" = store_sales_date_date.\"D_DATE_SK\"
WHERE
    store_sales_item_items.\"I_CATEGORY\" in ('Sports','Books','Home') and cast(store_sales_date_date.\"D_DATE\" as date) >= date '1999-02-22' and cast(store_sales_date_date.\"D_DATE\" as date) <= date '1999-03-24'
),
cheerful as (
SELECT
    sum(wakeful.\"store_sales_ext_sales_price\") as \"_virt_7590831606924933\",
    sum(wakeful.\"store_sales_ext_sales_price\") as \"item_revenue\",
    wakeful.\"store_sales_item_category\" as \"store_sales_item_category\",
    wakeful.\"store_sales_item_class\" as \"store_sales_item_class\",
    wakeful.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",
    wakeful.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    wakeful.\"store_sales_item_name\" as \"store_sales_item_name\"
FROM
    wakeful
GROUP BY 
    wakeful.\"store_sales_item_category\",
    wakeful.\"store_sales_item_class\",
    wakeful.\"store_sales_item_current_price\",
    wakeful.\"store_sales_item_desc\",
    wakeful.\"store_sales_item_name\"),
questionable as (
SELECT
    sum(wakeful.\"store_sales_ext_sales_price\") as \"_virt_2514983232825452\",
    wakeful.\"store_sales_item_class\" as \"store_sales_item_class\"
FROM
    wakeful
GROUP BY 
    wakeful.\"store_sales_item_class\"),
abundant as (
SELECT
    cooperative.\"store_sales_item_category\" as \"store_sales_item_category\",
    cooperative.\"store_sales_item_class\" as \"store_sales_item_class\",
    cooperative.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",
    cooperative.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    cooperative.\"store_sales_item_name\" as \"store_sales_item_name\",
    questionable.\"_virt_2514983232825452\" as \"_virt_2514983232825452\"
FROM
    questionable
    INNER JOIN cooperative on (questionable.\"store_sales_item_class\" = cooperative.\"store_sales_item_class\" or (questionable.\"store_sales_item_class\" is null and cooperative.\"store_sales_item_class\" is null))),
uneven as (
SELECT
    abundant.\"_virt_2514983232825452\" as \"_virt_2514983232825452\",
    abundant.\"store_sales_item_category\" as \"store_sales_item_category\",
    abundant.\"store_sales_item_class\" as \"store_sales_item_class\",
    abundant.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",
    abundant.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    abundant.\"store_sales_item_name\" as \"store_sales_item_name\",
    cheerful.\"_virt_7590831606924933\" as \"_virt_7590831606924933\"
FROM
    abundant
    INNER JOIN cheerful on (abundant.\"store_sales_item_category\" = cheerful.\"store_sales_item_category\" or (abundant.\"store_sales_item_category\" is null and cheerful.\"store_sales_item_category\" is null)) AND (abundant.\"store_sales_item_class\" = cheerful.\"store_sales_item_class\" or (abundant.\"store_sales_item_class\" is null and cheerful.\"store_sales_item_class\" is null)) AND (abundant.\"store_sales_item_current_price\" = cheerful.\"store_sales_item_current_price\" or (abundant.\"store_sales_item_current_price\" is null and cheerful.\"store_sales_item_current_price\" is null)) AND (abundant.\"store_sales_item_desc\" = cheerful.\"store_sales_item_desc\" or (abundant.\"store_sales_item_desc\" is null and cheerful.\"store_sales_item_desc\" is null)) AND abundant.\"store_sales_item_name\" = cheerful.\"store_sales_item_name\"),
yummy as (
SELECT
    uneven.\"_virt_7590831606924933\" * 100.0 / (uneven.\"_virt_2514983232825452\") as \"revenueratio\",
    uneven.\"store_sales_item_category\" as \"store_sales_item_category\",
    uneven.\"store_sales_item_class\" as \"store_sales_item_class\",
    uneven.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",
    uneven.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    uneven.\"store_sales_item_name\" as \"store_sales_item_name\"
FROM
    uneven
GROUP BY 
    uneven.\"_virt_7590831606924933\" * 100.0 / (uneven.\"_virt_2514983232825452\"),
    uneven.\"store_sales_item_category\",
    uneven.\"store_sales_item_class\",
    uneven.\"store_sales_item_current_price\",
    uneven.\"store_sales_item_desc\",
    uneven.\"store_sales_item_name\")
SELECT
    cheerful.\"store_sales_item_name\" as \"store_sales_item_name\",
    cheerful.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    cheerful.\"store_sales_item_category\" as \"store_sales_item_category\",
    cheerful.\"store_sales_item_class\" as \"store_sales_item_class\",
    cheerful.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",
    cheerful.\"item_revenue\" as \"item_revenue\",
    yummy.\"revenueratio\" as \"revenueratio\"
FROM
    yummy
    INNER JOIN cheerful on (yummy.\"store_sales_item_category\" = cheerful.\"store_sales_item_category\" or (yummy.\"store_sales_item_category\" is null and cheerful.\"store_sales_item_category\" is null)) AND (yummy.\"store_sales_item_class\" = cheerful.\"store_sales_item_class\" or (yummy.\"store_sales_item_class\" is null and cheerful.\"store_sales_item_class\" is null)) AND (yummy.\"store_sales_item_current_price\" = cheerful.\"store_sales_item_current_price\" or (yummy.\"store_sales_item_current_price\" is null and cheerful.\"store_sales_item_current_price\" is null)) AND (yummy.\"store_sales_item_desc\" = cheerful.\"store_sales_item_desc\" or (yummy.\"store_sales_item_desc\" is null and cheerful.\"store_sales_item_desc\" is null)) AND yummy.\"store_sales_item_name\" = cheerful.\"store_sales_item_name\"
ORDER BY 
    cheerful.\"store_sales_item_category\" asc nulls first,
    cheerful.\"store_sales_item_class\" asc nulls first,
    cheerful.\"store_sales_item_name\" asc nulls first,
    cheerful.\"store_sales_item_desc\" asc nulls first,
    yummy.\"revenueratio\" asc nulls first"""
