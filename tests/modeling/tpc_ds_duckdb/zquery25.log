query_id = 25
gen_length = 7991
generated_sql = """

WITH 
uneven as (
SELECT
    \"catalog_sales_catalog_sales\".\"CS_BILL_CUSTOMER_SK\" as \"store_sales_customer_id\",
    \"catalog_sales_catalog_sales\".\"CS_ITEM_SK\" as \"store_sales_item_id\",
    \"catalog_sales_catalog_sales\".\"CS_SOLD_DATE_SK\" as \"catalog_sales_date_id\"
FROM
    \"memory\".\"catalog_sales\" as \"catalog_sales_catalog_sales\"
GROUP BY 
    \"catalog_sales_catalog_sales\".\"CS_BILL_CUSTOMER_SK\",
    \"catalog_sales_catalog_sales\".\"CS_ITEM_SK\",
    \"catalog_sales_catalog_sales\".\"CS_SOLD_DATE_SK\"),
vacuous as (
SELECT
    \"catalog_sales_catalog_sales\".\"CS_NET_PROFIT\" as \"catalog_sales_net_profit\",
    \"store_sales_item_items\".\"I_ITEM_DESC\" as \"store_sales_item_desc\",
    \"store_sales_item_items\".\"I_ITEM_ID\" as \"store_sales_item_name\",
    \"store_sales_store_store\".\"S_STORE_ID\" as \"store_sales_store_text_id\",
    \"store_sales_store_store\".\"S_STORE_NAME\" as \"store_sales_store_name\"
FROM
    \"memory\".\"store_sales\" as \"store_sales_store_sales\"
    INNER JOIN \"memory\".\"date_dim\" as \"store_sales_date_date\" on \"store_sales_store_sales\".\"SS_SOLD_DATE_SK\" = \"store_sales_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"store\" as \"store_sales_store_store\" on \"store_sales_store_sales\".\"SS_STORE_SK\" = \"store_sales_store_store\".\"S_STORE_SK\"
    INNER JOIN \"memory\".\"catalog_sales\" as \"catalog_sales_catalog_sales\" on \"store_sales_store_sales\".\"SS_CUSTOMER_SK\" = \"catalog_sales_catalog_sales\".\"CS_BILL_CUSTOMER_SK\" AND \"store_sales_store_sales\".\"SS_ITEM_SK\" = \"catalog_sales_catalog_sales\".\"CS_ITEM_SK\"
    INNER JOIN \"memory\".\"date_dim\" as \"catalog_sales_date_date\" on \"catalog_sales_catalog_sales\".\"CS_SOLD_DATE_SK\" = \"catalog_sales_date_date\".\"D_DATE_SK\"
    LEFT OUTER JOIN \"memory\".\"store_returns\" as \"store_sales_store_returns\" on \"catalog_sales_catalog_sales\".\"CS_ITEM_SK\" = \"store_sales_store_returns\".\"SR_ITEM_SK\" AND \"store_sales_store_sales\".\"SS_TICKET_NUMBER\" = \"store_sales_store_returns\".\"SR_TICKET_NUMBER\"
    LEFT OUTER JOIN \"memory\".\"date_dim\" as \"store_sales_return_date_date\" on \"store_sales_store_returns\".\"SR_RETURNED_DATE_SK\" = \"store_sales_return_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"item\" as \"store_sales_item_items\" on \"catalog_sales_catalog_sales\".\"CS_ITEM_SK\" = \"store_sales_item_items\".\"I_ITEM_SK\"
WHERE
    cast(\"store_sales_date_date\".\"D_YEAR\" as int) = 2001 and \"store_sales_date_date\".\"D_MOY\" = 4 and cast(\"store_sales_return_date_date\".\"D_YEAR\" as int) = 2001 and \"store_sales_return_date_date\".\"D_MOY\" >= 4 and \"store_sales_return_date_date\".\"D_MOY\" <= 10 and cast(\"catalog_sales_date_date\".\"D_YEAR\" as int) = 2001 and \"catalog_sales_date_date\".\"D_MOY\" >= 4 and \"catalog_sales_date_date\".\"D_MOY\" <= 10 and \"store_sales_store_returns\".\"SR_CUSTOMER_SK\" = \"store_sales_store_sales\".\"SS_CUSTOMER_SK\" and CASE WHEN \"store_sales_store_returns\".\"SR_RETURN_TIME_SK\" THEN TRUE ELSE FALSE END

GROUP BY 
    \"catalog_sales_catalog_sales\".\"CS_NET_PROFIT\",
    \"catalog_sales_catalog_sales\".\"CS_ORDER_NUMBER\",
    \"store_sales_item_items\".\"I_ITEM_DESC\",
    \"store_sales_item_items\".\"I_ITEM_ID\",
    \"store_sales_item_items\".\"I_ITEM_SK\",
    \"store_sales_store_store\".\"S_STORE_ID\",
    \"store_sales_store_store\".\"S_STORE_NAME\"),
yummy as (
SELECT
    \"store_sales_item_items\".\"I_ITEM_DESC\" as \"store_sales_item_desc\",
    \"store_sales_item_items\".\"I_ITEM_ID\" as \"store_sales_item_name\",
    \"store_sales_store_returns\".\"SR_NET_LOSS\" as \"store_sales_return_net_loss\",
    \"store_sales_store_sales\".\"SS_NET_PROFIT\" as \"store_sales_net_profit\",
    \"store_sales_store_store\".\"S_STORE_ID\" as \"store_sales_store_text_id\",
    \"store_sales_store_store\".\"S_STORE_NAME\" as \"store_sales_store_name\"
FROM
    \"memory\".\"store_sales\" as \"store_sales_store_sales\"
    INNER JOIN \"memory\".\"date_dim\" as \"store_sales_date_date\" on \"store_sales_store_sales\".\"SS_SOLD_DATE_SK\" = \"store_sales_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"store\" as \"store_sales_store_store\" on \"store_sales_store_sales\".\"SS_STORE_SK\" = \"store_sales_store_store\".\"S_STORE_SK\"
    INNER JOIN \"uneven\" on \"store_sales_store_sales\".\"SS_CUSTOMER_SK\" = \"uneven\".\"store_sales_customer_id\" AND \"store_sales_store_sales\".\"SS_ITEM_SK\" = \"uneven\".\"store_sales_item_id\"
    INNER JOIN \"memory\".\"date_dim\" as \"catalog_sales_date_date\" on \"uneven\".\"catalog_sales_date_id\" = \"catalog_sales_date_date\".\"D_DATE_SK\"
    LEFT OUTER JOIN \"memory\".\"store_returns\" as \"store_sales_store_returns\" on \"store_sales_store_sales\".\"SS_TICKET_NUMBER\" = \"store_sales_store_returns\".\"SR_TICKET_NUMBER\" AND \"uneven\".\"store_sales_item_id\" = \"store_sales_store_returns\".\"SR_ITEM_SK\"
    LEFT OUTER JOIN \"memory\".\"date_dim\" as \"store_sales_return_date_date\" on \"store_sales_store_returns\".\"SR_RETURNED_DATE_SK\" = \"store_sales_return_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"item\" as \"store_sales_item_items\" on \"uneven\".\"store_sales_item_id\" = \"store_sales_item_items\".\"I_ITEM_SK\"
WHERE
    cast(\"store_sales_date_date\".\"D_YEAR\" as int) = 2001 and \"store_sales_date_date\".\"D_MOY\" = 4 and cast(\"store_sales_return_date_date\".\"D_YEAR\" as int) = 2001 and \"store_sales_return_date_date\".\"D_MOY\" >= 4 and \"store_sales_return_date_date\".\"D_MOY\" <= 10 and cast(\"catalog_sales_date_date\".\"D_YEAR\" as int) = 2001 and \"catalog_sales_date_date\".\"D_MOY\" >= 4 and \"catalog_sales_date_date\".\"D_MOY\" <= 10 and \"store_sales_store_returns\".\"SR_CUSTOMER_SK\" = \"store_sales_store_sales\".\"SS_CUSTOMER_SK\" and CASE WHEN \"store_sales_store_returns\".\"SR_RETURN_TIME_SK\" THEN TRUE ELSE FALSE END

GROUP BY 
    \"store_sales_item_items\".\"I_ITEM_DESC\",
    \"store_sales_item_items\".\"I_ITEM_ID\",
    \"store_sales_item_items\".\"I_ITEM_SK\",
    \"store_sales_store_returns\".\"SR_NET_LOSS\",
    \"store_sales_store_sales\".\"SS_NET_PROFIT\",
    \"store_sales_store_sales\".\"SS_TICKET_NUMBER\",
    \"store_sales_store_store\".\"S_STORE_ID\",
    \"store_sales_store_store\".\"S_STORE_NAME\"),
concerned as (
SELECT
    \"vacuous\".\"store_sales_item_desc\" as \"store_sales_item_desc\",
    \"vacuous\".\"store_sales_item_name\" as \"store_sales_item_name\",
    \"vacuous\".\"store_sales_store_name\" as \"store_sales_store_name\",
    \"vacuous\".\"store_sales_store_text_id\" as \"store_sales_store_text_id\",
    sum(\"vacuous\".\"catalog_sales_net_profit\") as \"catalog_sales_profit\"
FROM
    \"vacuous\"
GROUP BY 
    \"vacuous\".\"store_sales_item_desc\",
    \"vacuous\".\"store_sales_item_name\",
    \"vacuous\".\"store_sales_store_name\",
    \"vacuous\".\"store_sales_store_text_id\"),
juicy as (
SELECT
    \"yummy\".\"store_sales_item_desc\" as \"store_sales_item_desc\",
    \"yummy\".\"store_sales_item_name\" as \"store_sales_item_name\",
    \"yummy\".\"store_sales_store_name\" as \"store_sales_store_name\",
    \"yummy\".\"store_sales_store_text_id\" as \"store_sales_store_text_id\",
    sum(\"yummy\".\"store_sales_net_profit\") as \"store_sales_profit\",
    sum(\"yummy\".\"store_sales_return_net_loss\") as \"store_returns_loss\"
FROM
    \"yummy\"
GROUP BY 
    \"yummy\".\"store_sales_item_desc\",
    \"yummy\".\"store_sales_item_name\",
    \"yummy\".\"store_sales_store_name\",
    \"yummy\".\"store_sales_store_text_id\")
SELECT
    \"juicy\".\"store_sales_item_name\" as \"store_sales_item_name\",
    \"juicy\".\"store_sales_item_desc\" as \"store_sales_item_desc\",
    \"juicy\".\"store_sales_store_text_id\" as \"store_sales_store_text_id\",
    \"juicy\".\"store_sales_store_name\" as \"store_sales_store_name\",
    \"juicy\".\"store_sales_profit\" as \"store_sales_profit\",
    \"juicy\".\"store_returns_loss\" as \"store_returns_loss\",
    \"concerned\".\"catalog_sales_profit\" as \"catalog_sales_profit\"
FROM
    \"juicy\"
    INNER JOIN \"concerned\" on \"juicy\".\"store_sales_item_desc\" is not distinct from \"concerned\".\"store_sales_item_desc\" AND \"juicy\".\"store_sales_item_name\" = \"concerned\".\"store_sales_item_name\" AND \"juicy\".\"store_sales_store_name\" = \"concerned\".\"store_sales_store_name\" AND \"juicy\".\"store_sales_store_text_id\" = \"concerned\".\"store_sales_store_text_id\"
ORDER BY 
    \"juicy\".\"store_sales_item_name\" asc,
    \"juicy\".\"store_sales_item_desc\" asc,
    \"juicy\".\"store_sales_store_text_id\" asc,
    \"juicy\".\"store_sales_store_name\" asc
LIMIT (100)"""
