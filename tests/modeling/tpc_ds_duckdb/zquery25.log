query_id = 25
gen_length = 54254
generated_sql = """

WITH 
vacuous as (
-- Target: Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.item.id>. Group: True Source: SourceType.GROUP.
-- Source Map: {'store_sales.customer.id': ['catalog_sales_catalog_sales'], 'catalog_sales.date.id': ['catalog_sales_catalog_sales'], 'store_sales.item.id': ['catalog_sales_catalog_sales'], 'catalog_sales.promotion.id': ['catalog_sales_catalog_sales'], 'catalog_sales.extra_ship_cost': ['catalog_sales_catalog_sales'], 'catalog_sales.sales_price': ['catalog_sales_catalog_sales'], 'catalog_sales.call_center.id': ['catalog_sales_catalog_sales'], 'catalog_sales.ship_date.id': ['catalog_sales_catalog_sales'], 'catalog_sales.bill_customer.id': ['catalog_sales_catalog_sales'], 'catalog_sales.warehouse.id': ['catalog_sales_catalog_sales'], 'catalog_sales.time.id': ['catalog_sales_catalog_sales'], 'catalog_sales.order_number': ['catalog_sales_catalog_sales'], 'catalog_sales.extra_wholesale_cost': ['catalog_sales_catalog_sales'], 'catalog_sales.customer.address_id': ['catalog_sales_catalog_sales'], 'catalog_sales.item.id': ['catalog_sales_catalog_sales'], 'catalog_sales.customer.id': ['catalog_sales_catalog_sales'], 'catalog_sales.list_price': ['catalog_sales_catalog_sales'], 'catalog_sales.net_profit': ['catalog_sales_catalog_sales'], 'catalog_sales.coupon_amt': ['catalog_sales_catalog_sales'], 'catalog_sales.sold_date.id': ['catalog_sales_catalog_sales'], 'catalog_sales.bill_customer_demographic.id': ['catalog_sales_catalog_sales'], 'catalog_sales.extra_sales_price': ['catalog_sales_catalog_sales'], 'catalog_sales.wholesale_cost': ['catalog_sales_catalog_sales'], 'catalog_sales.quantity': ['catalog_sales_catalog_sales']}.
-- Output: store_sales.customer.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.item.id>, catalog_sales.date.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.item.id>, store_sales.item.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.item.id>.
-- Inputs: store_sales.customer.id@Grain<store_sales.customer.id>, catalog_sales.date.id@Grain<catalog_sales.date.id>, store_sales.item.id@Grain<store_sales.item.id>.
SELECT
    catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\" as \"store_sales_customer_id\",
    catalog_sales_catalog_sales.\"CS_ITEM_SK\" as \"store_sales_item_id\",
    catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" as \"catalog_sales_date_id\"
FROM
    memory.catalog_sales as catalog_sales_catalog_sales
GROUP BY 
    catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\",
    catalog_sales_catalog_sales.\"CS_ITEM_SK\",
    catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\"),
uneven as (
-- Target: Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>. Group: False Source: SourceType.MERGE.
-- Joins: inner join store_sales_store_sales on abundant.store_sales.item.id=store_sales.item.id,abundant.store_sales.customer.id=store_sales.customer.id, inner join store_sales_item_items on abundant.store_sales.item.id=store_sales.item.id, left outer join store_sales_store_returns on abundant.store_sales.item.id=store_sales.item.id,cheerful.store_sales.item.id=store_sales.item.id,cheerful.store_sales.ticket_number=store_sales.ticket_number, inner join store_sales_date_date on cheerful.store_sales.date.id=store_sales.date.id, inner join store_sales_store_store on cheerful.store_sales.store.id=store_sales.store.id, inner join catalog_sales_date_date on abundant.catalog_sales.date.id=catalog_sales.date.id, left outer join store_sales_return_date_date on thoughtful.store_sales.return_date.id=store_sales.return_date.id, inner join catalog_sales_bill_customer_customers on abundant.store_sales.customer.id=store_sales.customer.id.
-- Source Map: {'store_sales.item.name': ['store_sales_item_items'], 'store_sales.item.desc': ['store_sales_item_items'], 'store_sales.item.id': ['store_sales_item_items'], 'store_sales.date.year': ['store_sales_date_date'], 'store_sales.date.month_of_year': ['store_sales_date_date'], 'store_sales.date.id': ['store_sales_date_date'], 'store_sales.return_date.year': ['store_sales_return_date_date'], 'store_sales.return_date.id': ['store_sales_return_date_date'], 'store_sales.return_date.month_of_year': ['store_sales_return_date_date'], 'store_sales.store.text_id': ['store_sales_store_store'], 'store_sales.store.name': ['store_sales_store_store'], 'store_sales.store.id': ['store_sales_store_store'], 'store_sales.customer.id': ['store_sales_store_sales'], 'store_sales.ticket_number': ['store_sales_store_sales'], 'store_sales.is_returned': ['store_sales_store_returns'], 'store_sales.return_customer.id': ['store_sales_store_returns'], 'catalog_sales.date.id': ['catalog_sales_date_date'], 'catalog_sales.date.year': ['catalog_sales_date_date'], 'catalog_sales.date.month_of_year': ['catalog_sales_date_date'], 'catalog_sales.order_number': ['catalog_sales_catalog_sales'], 'catalog_sales.net_profit': ['catalog_sales_catalog_sales'], 'store_sales.item.size': ['store_sales_item_items'], 'store_sales.item.brand_id': ['store_sales_item_items'], 'store_sales.item.manufacturer_id': ['store_sales_item_items'], 'store_sales.item.class': ['store_sales_item_items'], 'store_sales.item.category': ['store_sales_item_items'], 'store_sales.item.current_price': ['store_sales_item_items'], 'store_sales.item.color': ['store_sales_item_items'], 'store_sales.item.manager_id': ['store_sales_item_items'], 'store_sales.item.units': ['store_sales_item_items'], 'store_sales.item.brand_name': ['store_sales_item_items'], 'store_sales.date._year_string': ['store_sales_date_date'], 'store_sales.date.date_string': ['store_sales_date_date'], 'store_sales.date.date': ['store_sales_date_date'], 'store_sales.date.day_of_week': ['store_sales_date_date'], 'store_sales.date._date_string': ['store_sales_date_date'], 'store_sales.date.week_seq': ['store_sales_date_date'], 'store_sales.date.quarter': ['store_sales_date_date'], 'store_sales.return_date._year_string': ['store_sales_return_date_date'], 'store_sales.return_date.date': ['store_sales_return_date_date'], 'store_sales.return_date.week_seq': ['store_sales_return_date_date'], 'store_sales.return_date._date_string': ['store_sales_return_date_date'], 'store_sales.return_date.day_of_week': ['store_sales_return_date_date'], 'store_sales.return_date.quarter': ['store_sales_return_date_date'], 'store_sales.return_date.date_string': ['store_sales_return_date_date'], 'store_sales.store.employees': ['store_sales_store_store'], 'store_sales.store.market_id': ['store_sales_store_store'], 'store_sales.store.county': ['store_sales_store_store'], 'store_sales.store.geography_class': ['store_sales_store_store'], 'store_sales.store.hours': ['store_sales_store_store'], 'store_sales.store.store_manager': ['store_sales_store_store'], 'store_sales.store.tax_percentage': ['store_sales_store_store'], 'store_sales.store.city': ['store_sales_store_store'], 'store_sales.store.state': ['store_sales_store_store'], 'store_sales.store.zip': ['store_sales_store_store'], 'store_sales.store.date.id': ['store_sales_store_store'], 'store_sales.store.market': ['store_sales_store_store'], 'store_sales.store.floor_space': ['store_sales_store_store'], 'store_sales.store.market_manager': ['store_sales_store_store'], 'store_sales.coupon_amt': ['store_sales_store_sales'], 'store_sales.ext_discount_amount': ['store_sales_store_sales'], 'store_sales.net_profit': ['store_sales_store_sales'], 'store_sales.quantity': ['store_sales_store_sales'], 'store_sales.ext_list_price': ['store_sales_store_sales'], 'store_sales.time.id': ['store_sales_store_sales'], 'store_sales.ext_wholesale_cost': ['store_sales_store_sales'], 'store_sales.sales_price': ['store_sales_store_sales'], 'store_sales.promotion.id': ['store_sales_store_sales'], 'store_sales.list_price': ['store_sales_store_sales'], 'store_sales.net_paid': ['store_sales_store_sales'], 'store_sales.customer_demographic.id': ['store_sales_store_sales'], 'store_sales.ext_sales_price': ['store_sales_store_sales'], 'store_sales.return_store.id': ['store_sales_store_returns'], 'store_sales.return_time.id': ['store_sales_store_returns'], 'store_sales.return_net_loss': ['store_sales_store_returns'], 'store_sales.return_amount': ['store_sales_store_returns'], 'catalog_sales.date._date_string': ['catalog_sales_date_date'], 'catalog_sales.date.date_string': ['catalog_sales_date_date'], 'catalog_sales.date.week_seq': ['catalog_sales_date_date'], 'catalog_sales.date._year_string': ['catalog_sales_date_date'], 'catalog_sales.date.quarter': ['catalog_sales_date_date'], 'catalog_sales.date.date': ['catalog_sales_date_date'], 'catalog_sales.date.day_of_week': ['catalog_sales_date_date'], 'catalog_sales.bill_customer.birth_year': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.last_review_date': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.birth_country': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.demographics.id': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.email_address': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.first_name': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.address_id': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.last_name': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.salutation': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.id': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.text_id': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.preferred_cust_flag': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.birth_month': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.login': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.birth_day': ['catalog_sales_bill_customer_customers'], 'catalog_sales.promotion.id': ['catalog_sales_catalog_sales'], 'catalog_sales.extra_ship_cost': ['catalog_sales_catalog_sales'], 'catalog_sales.sales_price': ['catalog_sales_catalog_sales'], 'catalog_sales.call_center.id': ['catalog_sales_catalog_sales'], 'catalog_sales.ship_date.id': ['catalog_sales_catalog_sales'], 'catalog_sales.warehouse.id': ['catalog_sales_catalog_sales'], 'catalog_sales.time.id': ['catalog_sales_catalog_sales'], 'catalog_sales.extra_wholesale_cost': ['catalog_sales_catalog_sales'], 'catalog_sales.customer.address_id': ['catalog_sales_catalog_sales'], 'catalog_sales.item.id': ['catalog_sales_catalog_sales'], 'catalog_sales.customer.id': ['catalog_sales_catalog_sales'], 'catalog_sales.list_price': ['catalog_sales_catalog_sales'], 'catalog_sales.coupon_amt': ['catalog_sales_catalog_sales'], 'catalog_sales.sold_date.id': ['catalog_sales_catalog_sales'], 'catalog_sales.bill_customer_demographic.id': ['catalog_sales_catalog_sales'], 'catalog_sales.extra_sales_price': ['catalog_sales_catalog_sales'], 'catalog_sales.wholesale_cost': ['catalog_sales_catalog_sales'], 'catalog_sales.quantity': ['catalog_sales_catalog_sales']}.
-- Output: catalog_sales.date.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, catalog_sales.date.month_of_year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, catalog_sales.date.year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, catalog_sales.net_profit@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, catalog_sales.order_number@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.customer.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.date.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.date.month_of_year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.date.year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.is_returned@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.desc@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.name@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.return_customer.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.return_date.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.return_date.month_of_year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.return_date.year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.name@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.text_id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>.
-- Inputs: catalog_sales.date.id@Grain<catalog_sales.date.id>, catalog_sales.date.month_of_year@Grain<catalog_sales.date.id>, catalog_sales.date.year@Grain<catalog_sales.date.id>, catalog_sales.net_profit@Grain<catalog_sales.order_number,store_sales.item.id>, catalog_sales.order_number@Grain<catalog_sales.order_number>, store_sales.customer.id@Grain<store_sales.customer.id>, store_sales.date.id@Grain<store_sales.date.id>, store_sales.date.month_of_year@Grain<store_sales.date.id>, store_sales.date.year@Grain<store_sales.date.id>, store_sales.is_returned@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.item.desc@Grain<store_sales.item.id>, store_sales.item.id@Grain<store_sales.item.id>, store_sales.item.name@Grain<store_sales.item.id>, store_sales.return_customer.id@Grain<store_sales.return_customer.id>, store_sales.return_date.id@Grain<store_sales.return_date.id>, store_sales.return_date.month_of_year@Grain<store_sales.return_date.id>, store_sales.return_date.year@Grain<store_sales.return_date.id>, store_sales.store.id@Grain<store_sales.store.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.store.text_id@Grain<store_sales.store.id>.
SELECT
    CASE WHEN store_sales_store_returns.\"SR_RETURN_TIME_SK\" THEN TRUE ELSE FALSE END as \"store_sales_is_returned\",
    cast(catalog_sales_date_date.\"D_YEAR\" as int) as \"catalog_sales_date_year\",
    cast(store_sales_date_date.\"D_YEAR\" as int) as \"store_sales_date_year\",
    cast(store_sales_return_date_date.\"D_YEAR\" as int) as \"store_sales_return_date_year\",
    catalog_sales_catalog_sales.\"CS_NET_PROFIT\" as \"catalog_sales_net_profit\",
    catalog_sales_catalog_sales.\"CS_ORDER_NUMBER\" as \"catalog_sales_order_number\",
    catalog_sales_date_date.\"D_DATE_SK\" as \"catalog_sales_date_id\",
    catalog_sales_date_date.\"D_MOY\" as \"catalog_sales_date_month_of_year\",
    store_sales_date_date.\"D_DATE_SK\" as \"store_sales_date_id\",
    store_sales_date_date.\"D_MOY\" as \"store_sales_date_month_of_year\",
    store_sales_item_items.\"I_ITEM_DESC\" as \"store_sales_item_desc\",
    store_sales_item_items.\"I_ITEM_ID\" as \"store_sales_item_name\",
    store_sales_item_items.\"I_ITEM_SK\" as \"store_sales_item_id\",
    store_sales_return_date_date.\"D_DATE_SK\" as \"store_sales_return_date_id\",
    store_sales_return_date_date.\"D_MOY\" as \"store_sales_return_date_month_of_year\",
    store_sales_store_returns.\"SR_CUSTOMER_SK\" as \"store_sales_return_customer_id\",
    store_sales_store_sales.\"SS_CUSTOMER_SK\" as \"store_sales_customer_id\",
    store_sales_store_store.\"S_STORE_ID\" as \"store_sales_store_text_id\",
    store_sales_store_store.\"S_STORE_NAME\" as \"store_sales_store_name\",
    store_sales_store_store.\"S_STORE_SK\" as \"store_sales_store_id\"
FROM
    memory.catalog_sales as catalog_sales_catalog_sales
    INNER JOIN memory.store_sales as store_sales_store_sales on catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\" = store_sales_store_sales.\"SS_CUSTOMER_SK\" AND catalog_sales_catalog_sales.\"CS_ITEM_SK\" = store_sales_store_sales.\"SS_ITEM_SK\"
    INNER JOIN memory.item as store_sales_item_items on catalog_sales_catalog_sales.\"CS_ITEM_SK\" = store_sales_item_items.\"I_ITEM_SK\"
    LEFT OUTER JOIN memory.store_returns as store_sales_store_returns on catalog_sales_catalog_sales.\"CS_ITEM_SK\" = store_sales_store_returns.\"SR_ITEM_SK\" AND store_sales_store_sales.\"SS_ITEM_SK\" = store_sales_store_returns.\"SR_ITEM_SK\" AND store_sales_store_sales.\"SS_TICKET_NUMBER\" = store_sales_store_returns.\"SR_TICKET_NUMBER\"
    INNER JOIN memory.date_dim as store_sales_date_date on store_sales_store_sales.\"SS_SOLD_DATE_SK\" = store_sales_date_date.\"D_DATE_SK\"
    INNER JOIN memory.store as store_sales_store_store on store_sales_store_sales.\"SS_STORE_SK\" = store_sales_store_store.\"S_STORE_SK\"
    INNER JOIN memory.date_dim as catalog_sales_date_date on catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" = catalog_sales_date_date.\"D_DATE_SK\"
    LEFT OUTER JOIN memory.date_dim as store_sales_return_date_date on store_sales_store_returns.\"SR_RETURNED_DATE_SK\" = store_sales_return_date_date.\"D_DATE_SK\"
    INNER JOIN memory.customer as catalog_sales_bill_customer_customers on catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\" = catalog_sales_bill_customer_customers.\"C_CUSTOMER_SK\"
WHERE
    cast(store_sales_date_date.\"D_YEAR\" as int) = 2001 and store_sales_date_date.\"D_MOY\" = 4 and cast(store_sales_return_date_date.\"D_YEAR\" as int) = 2001 and store_sales_return_date_date.\"D_MOY\" >= 4 and store_sales_return_date_date.\"D_MOY\" <= 10 and cast(catalog_sales_date_date.\"D_YEAR\" as int) = 2001 and catalog_sales_date_date.\"D_MOY\" >= 4 and catalog_sales_date_date.\"D_MOY\" <= 10 and store_sales_store_returns.\"SR_CUSTOMER_SK\" = store_sales_store_sales.\"SS_CUSTOMER_SK\"
),
concerned as (
-- Target: Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>. Group: False Source: SourceType.MERGE. References: vacuous.
-- Joins: inner join store_sales_store_sales on vacuous.store_sales.item.id=store_sales.item.id,vacuous.store_sales.customer.id=store_sales.customer.id, inner join store_sales_item_items on vacuous.store_sales.item.id=store_sales.item.id, left outer join store_sales_store_returns on vacuous.store_sales.item.id=store_sales.item.id,cheerful.store_sales.item.id=store_sales.item.id,cheerful.store_sales.ticket_number=store_sales.ticket_number, inner join store_sales_date_date on cheerful.store_sales.date.id=store_sales.date.id, inner join store_sales_store_store on cheerful.store_sales.store.id=store_sales.store.id, inner join catalog_sales_date_date on vacuous.catalog_sales.date.id=catalog_sales.date.id, left outer join store_sales_return_date_date on thoughtful.store_sales.return_date.id=store_sales.return_date.id.
-- Source Map: {'store_sales.item.name': ['store_sales_item_items'], 'store_sales.item.desc': ['store_sales_item_items'], 'store_sales.item.id': ['store_sales_item_items'], 'store_sales.date.year': ['store_sales_date_date'], 'store_sales.date.month_of_year': ['store_sales_date_date'], 'store_sales.date.id': ['store_sales_date_date'], 'store_sales.return_date.year': ['store_sales_return_date_date'], 'store_sales.return_date.id': ['store_sales_return_date_date'], 'store_sales.return_date.month_of_year': ['store_sales_return_date_date'], 'store_sales.store.text_id': ['store_sales_store_store'], 'store_sales.store.name': ['store_sales_store_store'], 'store_sales.store.id': ['store_sales_store_store'], 'store_sales.customer.id': ['store_sales_store_sales'], 'store_sales.ticket_number': ['store_sales_store_sales'], 'store_sales.net_profit': ['store_sales_store_sales'], 'store_sales.return_net_loss': ['store_sales_store_returns'], 'store_sales.is_returned': ['store_sales_store_returns'], 'store_sales.return_customer.id': ['store_sales_store_returns'], 'catalog_sales.date.id': ['catalog_sales_date_date'], 'catalog_sales.date.year': ['catalog_sales_date_date'], 'catalog_sales.date.month_of_year': ['catalog_sales_date_date'], 'store_sales.item.size': ['store_sales_item_items'], 'store_sales.item.brand_id': ['store_sales_item_items'], 'store_sales.item.manufacturer_id': ['store_sales_item_items'], 'store_sales.item.class': ['store_sales_item_items'], 'store_sales.item.category': ['store_sales_item_items'], 'store_sales.item.current_price': ['store_sales_item_items'], 'store_sales.item.color': ['store_sales_item_items'], 'store_sales.item.manager_id': ['store_sales_item_items'], 'store_sales.item.units': ['store_sales_item_items'], 'store_sales.item.brand_name': ['store_sales_item_items'], 'store_sales.date._year_string': ['store_sales_date_date'], 'store_sales.date.date_string': ['store_sales_date_date'], 'store_sales.date.date': ['store_sales_date_date'], 'store_sales.date.day_of_week': ['store_sales_date_date'], 'store_sales.date._date_string': ['store_sales_date_date'], 'store_sales.date.week_seq': ['store_sales_date_date'], 'store_sales.date.quarter': ['store_sales_date_date'], 'store_sales.return_date._year_string': ['store_sales_return_date_date'], 'store_sales.return_date.date': ['store_sales_return_date_date'], 'store_sales.return_date.week_seq': ['store_sales_return_date_date'], 'store_sales.return_date._date_string': ['store_sales_return_date_date'], 'store_sales.return_date.day_of_week': ['store_sales_return_date_date'], 'store_sales.return_date.quarter': ['store_sales_return_date_date'], 'store_sales.return_date.date_string': ['store_sales_return_date_date'], 'store_sales.store.employees': ['store_sales_store_store'], 'store_sales.store.market_id': ['store_sales_store_store'], 'store_sales.store.county': ['store_sales_store_store'], 'store_sales.store.geography_class': ['store_sales_store_store'], 'store_sales.store.hours': ['store_sales_store_store'], 'store_sales.store.store_manager': ['store_sales_store_store'], 'store_sales.store.tax_percentage': ['store_sales_store_store'], 'store_sales.store.city': ['store_sales_store_store'], 'store_sales.store.state': ['store_sales_store_store'], 'store_sales.store.zip': ['store_sales_store_store'], 'store_sales.store.date.id': ['store_sales_store_store'], 'store_sales.store.market': ['store_sales_store_store'], 'store_sales.store.floor_space': ['store_sales_store_store'], 'store_sales.store.market_manager': ['store_sales_store_store'], 'store_sales.coupon_amt': ['store_sales_store_sales'], 'store_sales.ext_discount_amount': ['store_sales_store_sales'], 'store_sales.quantity': ['store_sales_store_sales'], 'store_sales.ext_list_price': ['store_sales_store_sales'], 'store_sales.time.id': ['store_sales_store_sales'], 'store_sales.ext_wholesale_cost': ['store_sales_store_sales'], 'store_sales.sales_price': ['store_sales_store_sales'], 'store_sales.promotion.id': ['store_sales_store_sales'], 'store_sales.list_price': ['store_sales_store_sales'], 'store_sales.net_paid': ['store_sales_store_sales'], 'store_sales.customer_demographic.id': ['store_sales_store_sales'], 'store_sales.ext_sales_price': ['store_sales_store_sales'], 'store_sales.return_store.id': ['store_sales_store_returns'], 'store_sales.return_time.id': ['store_sales_store_returns'], 'store_sales.return_amount': ['store_sales_store_returns'], 'catalog_sales.date._date_string': ['catalog_sales_date_date'], 'catalog_sales.date.date_string': ['catalog_sales_date_date'], 'catalog_sales.date.week_seq': ['catalog_sales_date_date'], 'catalog_sales.date._year_string': ['catalog_sales_date_date'], 'catalog_sales.date.quarter': ['catalog_sales_date_date'], 'catalog_sales.date.date': ['catalog_sales_date_date'], 'catalog_sales.date.day_of_week': ['catalog_sales_date_date']}.
-- Output: catalog_sales.date.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, catalog_sales.date.month_of_year@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, catalog_sales.date.year@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.customer.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.date.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.date.month_of_year@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.date.year@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.is_returned@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.desc@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.name@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.net_profit@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.return_customer.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.return_date.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.return_date.month_of_year@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.return_date.year@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.return_net_loss@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.name@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.text_id@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>, store_sales.ticket_number@Grain<catalog_sales.date.id,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_date.id,store_sales.store.id,store_sales.ticket_number>.
-- Inputs: catalog_sales.date.id@Grain<catalog_sales.date.id>, catalog_sales.date.month_of_year@Grain<catalog_sales.date.id>, catalog_sales.date.year@Grain<catalog_sales.date.id>, store_sales.customer.id@Grain<store_sales.customer.id>, store_sales.date.id@Grain<store_sales.date.id>, store_sales.date.month_of_year@Grain<store_sales.date.id>, store_sales.date.year@Grain<store_sales.date.id>, store_sales.is_returned@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.item.desc@Grain<store_sales.item.id>, store_sales.item.id@Grain<store_sales.item.id>, store_sales.item.name@Grain<store_sales.item.id>, store_sales.net_profit@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.return_customer.id@Grain<store_sales.return_customer.id>, store_sales.return_date.id@Grain<store_sales.return_date.id>, store_sales.return_date.month_of_year@Grain<store_sales.return_date.id>, store_sales.return_date.year@Grain<store_sales.return_date.id>, store_sales.return_net_loss@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.store.id@Grain<store_sales.store.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.store.text_id@Grain<store_sales.store.id>, store_sales.ticket_number@Grain<store_sales.ticket_number>.
SELECT
    CASE WHEN store_sales_store_returns.\"SR_RETURN_TIME_SK\" THEN TRUE ELSE FALSE END as \"store_sales_is_returned\",
    cast(catalog_sales_date_date.\"D_YEAR\" as int) as \"catalog_sales_date_year\",
    cast(store_sales_date_date.\"D_YEAR\" as int) as \"store_sales_date_year\",
    cast(store_sales_return_date_date.\"D_YEAR\" as int) as \"store_sales_return_date_year\",
    catalog_sales_date_date.\"D_DATE_SK\" as \"catalog_sales_date_id\",
    catalog_sales_date_date.\"D_MOY\" as \"catalog_sales_date_month_of_year\",
    store_sales_date_date.\"D_DATE_SK\" as \"store_sales_date_id\",
    store_sales_date_date.\"D_MOY\" as \"store_sales_date_month_of_year\",
    store_sales_item_items.\"I_ITEM_DESC\" as \"store_sales_item_desc\",
    store_sales_item_items.\"I_ITEM_ID\" as \"store_sales_item_name\",
    store_sales_item_items.\"I_ITEM_SK\" as \"store_sales_item_id\",
    store_sales_return_date_date.\"D_DATE_SK\" as \"store_sales_return_date_id\",
    store_sales_return_date_date.\"D_MOY\" as \"store_sales_return_date_month_of_year\",
    store_sales_store_returns.\"SR_CUSTOMER_SK\" as \"store_sales_return_customer_id\",
    store_sales_store_returns.\"SR_NET_LOSS\" as \"store_sales_return_net_loss\",
    store_sales_store_sales.\"SS_CUSTOMER_SK\" as \"store_sales_customer_id\",
    store_sales_store_sales.\"SS_NET_PROFIT\" as \"store_sales_net_profit\",
    store_sales_store_sales.\"SS_TICKET_NUMBER\" as \"store_sales_ticket_number\",
    store_sales_store_store.\"S_STORE_ID\" as \"store_sales_store_text_id\",
    store_sales_store_store.\"S_STORE_NAME\" as \"store_sales_store_name\",
    store_sales_store_store.\"S_STORE_SK\" as \"store_sales_store_id\"
FROM
    vacuous
    INNER JOIN memory.store_sales as store_sales_store_sales on vacuous.\"store_sales_customer_id\" = store_sales_store_sales.\"SS_CUSTOMER_SK\" AND vacuous.\"store_sales_item_id\" = store_sales_store_sales.\"SS_ITEM_SK\"
    INNER JOIN memory.item as store_sales_item_items on vacuous.\"store_sales_item_id\" = store_sales_item_items.\"I_ITEM_SK\"
    LEFT OUTER JOIN memory.store_returns as store_sales_store_returns on store_sales_store_sales.\"SS_ITEM_SK\" = store_sales_store_returns.\"SR_ITEM_SK\" AND store_sales_store_sales.\"SS_TICKET_NUMBER\" = store_sales_store_returns.\"SR_TICKET_NUMBER\" AND vacuous.\"store_sales_item_id\" = store_sales_store_returns.\"SR_ITEM_SK\"
    INNER JOIN memory.date_dim as store_sales_date_date on store_sales_store_sales.\"SS_SOLD_DATE_SK\" = store_sales_date_date.\"D_DATE_SK\"
    INNER JOIN memory.store as store_sales_store_store on store_sales_store_sales.\"SS_STORE_SK\" = store_sales_store_store.\"S_STORE_SK\"
    INNER JOIN memory.date_dim as catalog_sales_date_date on vacuous.\"catalog_sales_date_id\" = catalog_sales_date_date.\"D_DATE_SK\"
    LEFT OUTER JOIN memory.date_dim as store_sales_return_date_date on store_sales_store_returns.\"SR_RETURNED_DATE_SK\" = store_sales_return_date_date.\"D_DATE_SK\"
WHERE
    cast(store_sales_date_date.\"D_YEAR\" as int) = 2001 and store_sales_date_date.\"D_MOY\" = 4 and cast(store_sales_return_date_date.\"D_YEAR\" as int) = 2001 and store_sales_return_date_date.\"D_MOY\" >= 4 and store_sales_return_date_date.\"D_MOY\" <= 10 and cast(catalog_sales_date_date.\"D_YEAR\" as int) = 2001 and catalog_sales_date_date.\"D_MOY\" >= 4 and catalog_sales_date_date.\"D_MOY\" <= 10 and store_sales_store_returns.\"SR_CUSTOMER_SK\" = store_sales_store_sales.\"SS_CUSTOMER_SK\" and CASE WHEN store_sales_store_returns.\"SR_RETURN_TIME_SK\" THEN TRUE ELSE FALSE END
),
yummy as (
-- Target: Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>. Group: True Source: SourceType.GROUP. References: uneven.
-- Source Map: {'catalog_sales.date.id': ['uneven'], 'catalog_sales.date.month_of_year': ['uneven'], 'catalog_sales.date.year': ['uneven'], 'catalog_sales.net_profit': ['uneven'], 'catalog_sales.order_number': ['uneven'], 'store_sales.customer.id': ['uneven'], 'store_sales.date.id': ['uneven'], 'store_sales.date.month_of_year': ['uneven'], 'store_sales.date.year': ['uneven'], 'store_sales.is_returned': ['uneven'], 'store_sales.item.desc': ['uneven'], 'store_sales.item.id': ['uneven'], 'store_sales.item.name': ['uneven'], 'store_sales.return_customer.id': ['uneven'], 'store_sales.return_date.id': ['uneven'], 'store_sales.return_date.month_of_year': ['uneven'], 'store_sales.return_date.year': ['uneven'], 'store_sales.store.id': ['uneven'], 'store_sales.store.name': ['uneven'], 'store_sales.store.text_id': ['uneven']}.
-- Output: catalog_sales.date.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, catalog_sales.date.month_of_year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, catalog_sales.date.year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, catalog_sales.net_profit@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, catalog_sales.order_number@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.customer.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.date.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.date.month_of_year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.date.year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.is_returned@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.item.desc@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.item.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.item.name@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.return_customer.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.return_date.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.return_date.month_of_year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.return_date.year@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.store.id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.store.name@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>, store_sales.store.text_id@Grain<catalog_sales.date.id,catalog_sales.order_number,store_sales.customer.id,store_sales.date.id,store_sales.item.id,store_sales.return_customer.id,store_sales.return_date.id,store_sales.store.id>.
-- Inputs: catalog_sales.date.id@Grain<catalog_sales.date.id>, catalog_sales.date.month_of_year@Grain<catalog_sales.date.id>, catalog_sales.date.year@Grain<catalog_sales.date.id>, catalog_sales.net_profit@Grain<catalog_sales.order_number,store_sales.item.id>, catalog_sales.order_number@Grain<catalog_sales.order_number>, store_sales.customer.id@Grain<store_sales.customer.id>, store_sales.date.id@Grain<store_sales.date.id>, store_sales.date.month_of_year@Grain<store_sales.date.id>, store_sales.date.year@Grain<store_sales.date.id>, store_sales.is_returned@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.item.desc@Grain<store_sales.item.id>, store_sales.item.id@Grain<store_sales.item.id>, store_sales.item.name@Grain<store_sales.item.id>, store_sales.return_customer.id@Grain<store_sales.return_customer.id>, store_sales.return_date.id@Grain<store_sales.return_date.id>, store_sales.return_date.month_of_year@Grain<store_sales.return_date.id>, store_sales.return_date.year@Grain<store_sales.return_date.id>, store_sales.store.id@Grain<store_sales.store.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.store.text_id@Grain<store_sales.store.id>.
SELECT
    uneven.\"catalog_sales_date_id\" as \"catalog_sales_date_id\",
    uneven.\"catalog_sales_date_month_of_year\" as \"catalog_sales_date_month_of_year\",
    uneven.\"catalog_sales_date_year\" as \"catalog_sales_date_year\",
    uneven.\"catalog_sales_net_profit\" as \"catalog_sales_net_profit\",
    uneven.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",
    uneven.\"store_sales_customer_id\" as \"store_sales_customer_id\",
    uneven.\"store_sales_date_id\" as \"store_sales_date_id\",
    uneven.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",
    uneven.\"store_sales_date_year\" as \"store_sales_date_year\",
    uneven.\"store_sales_is_returned\" as \"store_sales_is_returned\",
    uneven.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    uneven.\"store_sales_item_id\" as \"store_sales_item_id\",
    uneven.\"store_sales_item_name\" as \"store_sales_item_name\",
    uneven.\"store_sales_return_customer_id\" as \"store_sales_return_customer_id\",
    uneven.\"store_sales_return_date_id\" as \"store_sales_return_date_id\",
    uneven.\"store_sales_return_date_month_of_year\" as \"store_sales_return_date_month_of_year\",
    uneven.\"store_sales_return_date_year\" as \"store_sales_return_date_year\",
    uneven.\"store_sales_store_id\" as \"store_sales_store_id\",
    uneven.\"store_sales_store_name\" as \"store_sales_store_name\",
    uneven.\"store_sales_store_text_id\" as \"store_sales_store_text_id\"
FROM
    uneven
WHERE
    uneven.\"store_sales_date_year\" = 2001 and uneven.\"store_sales_date_month_of_year\" = 4 and uneven.\"store_sales_return_date_year\" = 2001 and uneven.\"store_sales_return_date_month_of_year\" >= 4 and uneven.\"store_sales_return_date_month_of_year\" <= 10 and uneven.\"catalog_sales_date_year\" = 2001 and uneven.\"catalog_sales_date_month_of_year\" >= 4 and uneven.\"catalog_sales_date_month_of_year\" <= 10 and uneven.\"store_sales_return_customer_id\" = uneven.\"store_sales_customer_id\" and uneven.\"store_sales_is_returned\"

GROUP BY 
    uneven.\"catalog_sales_date_id\",
    uneven.\"catalog_sales_date_month_of_year\",
    uneven.\"catalog_sales_date_year\",
    uneven.\"catalog_sales_net_profit\",
    uneven.\"catalog_sales_order_number\",
    uneven.\"store_sales_customer_id\",
    uneven.\"store_sales_date_id\",
    uneven.\"store_sales_date_month_of_year\",
    uneven.\"store_sales_date_year\",
    uneven.\"store_sales_is_returned\",
    uneven.\"store_sales_item_desc\",
    uneven.\"store_sales_item_id\",
    uneven.\"store_sales_item_name\",
    uneven.\"store_sales_return_customer_id\",
    uneven.\"store_sales_return_date_id\",
    uneven.\"store_sales_return_date_month_of_year\",
    uneven.\"store_sales_return_date_year\",
    uneven.\"store_sales_store_id\",
    uneven.\"store_sales_store_name\",
    uneven.\"store_sales_store_text_id\"),
young as (
-- Target: Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>. Group: True Source: SourceType.GROUP. References: concerned.
-- Source Map: {'catalog_sales.date.id': ['concerned'], 'catalog_sales.date.month_of_year': ['concerned'], 'catalog_sales.date.year': ['concerned'], 'store_sales.customer.id': ['concerned'], 'store_sales.date.id': ['concerned'], 'store_sales.date.month_of_year': ['concerned'], 'store_sales.date.year': ['concerned'], 'store_sales.is_returned': ['concerned'], 'store_sales.item.desc': ['concerned'], 'store_sales.item.id': ['concerned'], 'store_sales.item.name': ['concerned'], 'store_sales.net_profit': ['concerned'], 'store_sales.return_customer.id': ['concerned'], 'store_sales.return_date.id': ['concerned'], 'store_sales.return_date.month_of_year': ['concerned'], 'store_sales.return_date.year': ['concerned'], 'store_sales.return_net_loss': ['concerned'], 'store_sales.store.id': ['concerned'], 'store_sales.store.name': ['concerned'], 'store_sales.store.text_id': ['concerned'], 'store_sales.ticket_number': ['concerned'], 'local.store_sales_profit': [], 'local.store_returns_loss': []}.
-- Output: local.store_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.store.text_id@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.item.name@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.store.name@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.item.desc@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, local.store_returns_loss@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>.
-- Inputs: store_sales.net_profit@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.store.text_id@Grain<store_sales.store.id>, store_sales.item.name@Grain<store_sales.item.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.item.desc@Grain<store_sales.item.id>, store_sales.ticket_number@Grain<store_sales.ticket_number>, store_sales.item.id@Grain<store_sales.item.id>, store_sales.return_net_loss@Grain<store_sales.item.id,store_sales.ticket_number>.
-- Nullable: local.store_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, local.store_returns_loss@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>.
SELECT
    concerned.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    concerned.\"store_sales_item_name\" as \"store_sales_item_name\",
    concerned.\"store_sales_store_name\" as \"store_sales_store_name\",
    concerned.\"store_sales_store_text_id\" as \"store_sales_store_text_id\",
    sum(concerned.\"store_sales_net_profit\") as \"store_sales_profit\",
    sum(concerned.\"store_sales_return_net_loss\") as \"store_returns_loss\"
FROM
    concerned
GROUP BY 
    concerned.\"store_sales_item_desc\",
    concerned.\"store_sales_item_name\",
    concerned.\"store_sales_store_name\",
    concerned.\"store_sales_store_text_id\"),
juicy as (
-- Target: Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>. Group: True Source: SourceType.GROUP. References: yummy.
-- Source Map: {'catalog_sales.date.id': ['yummy'], 'catalog_sales.date.month_of_year': ['yummy'], 'catalog_sales.date.year': ['yummy'], 'catalog_sales.net_profit': ['yummy'], 'catalog_sales.order_number': ['yummy'], 'store_sales.customer.id': ['yummy'], 'store_sales.date.id': ['yummy'], 'store_sales.date.month_of_year': ['yummy'], 'store_sales.date.year': ['yummy'], 'store_sales.is_returned': ['yummy'], 'store_sales.item.desc': ['yummy'], 'store_sales.item.id': ['yummy'], 'store_sales.item.name': ['yummy'], 'store_sales.return_customer.id': ['yummy'], 'store_sales.return_date.id': ['yummy'], 'store_sales.return_date.month_of_year': ['yummy'], 'store_sales.return_date.year': ['yummy'], 'store_sales.store.id': ['yummy'], 'store_sales.store.name': ['yummy'], 'store_sales.store.text_id': ['yummy'], 'local.catalog_sales_profit': []}.
-- Output: local.catalog_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.store.text_id@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.item.name@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.store.name@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.item.desc@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>.
-- Inputs: catalog_sales.net_profit@Grain<catalog_sales.order_number,store_sales.item.id>, store_sales.store.text_id@Grain<store_sales.store.id>, store_sales.item.name@Grain<store_sales.item.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.item.desc@Grain<store_sales.item.id>, catalog_sales.order_number@Grain<catalog_sales.order_number>, store_sales.item.id@Grain<store_sales.item.id>.
-- Nullable: local.catalog_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>.
SELECT
    sum(yummy.\"catalog_sales_net_profit\") as \"catalog_sales_profit\",
    yummy.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    yummy.\"store_sales_item_name\" as \"store_sales_item_name\",
    yummy.\"store_sales_store_name\" as \"store_sales_store_name\",
    yummy.\"store_sales_store_text_id\" as \"store_sales_store_text_id\"
FROM
    yummy
GROUP BY 
    yummy.\"store_sales_item_desc\",
    yummy.\"store_sales_item_name\",
    yummy.\"store_sales_store_name\",
    yummy.\"store_sales_store_text_id\")
-- Target: Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>. Group: False Source: SourceType.MERGE. References: juicy, young.
-- Joins: inner join young on juicy.store_sales.item.desc=store_sales.item.desc,juicy.store_sales.store.name=store_sales.store.name,juicy.store_sales.item.name=store_sales.item.name,juicy.store_sales.store.text_id=store_sales.store.text_id.
-- Source Map: {'local.catalog_sales_profit': ['juicy'], 'store_sales.store.text_id': ['juicy'], 'store_sales.item.name': ['juicy'], 'store_sales.store.name': ['juicy'], 'store_sales.item.desc': ['juicy'], 'local.store_sales_profit': ['young'], 'local.store_returns_loss': ['young']}.
-- Output: store_sales.item.name@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.item.desc@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.store.text_id@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, store_sales.store.name@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, local.store_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, local.store_returns_loss@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, local.catalog_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>.
-- Inputs: store_sales.store.text_id@Grain<store_sales.store.id>, store_sales.item.name@Grain<store_sales.item.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.item.desc@Grain<store_sales.item.id>, local.catalog_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, local.store_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, local.store_returns_loss@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>.
-- Nullable: local.catalog_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, local.store_sales_profit@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>, local.store_returns_loss@Grain<store_sales.item.desc,store_sales.item.name,store_sales.store.name,store_sales.store.text_id>.
SELECT
    juicy.\"store_sales_item_name\" as \"store_sales_item_name\",
    juicy.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    juicy.\"store_sales_store_text_id\" as \"store_sales_store_text_id\",
    juicy.\"store_sales_store_name\" as \"store_sales_store_name\",
    young.\"store_sales_profit\" as \"store_sales_profit\",
    young.\"store_returns_loss\" as \"store_returns_loss\",
    juicy.\"catalog_sales_profit\" as \"catalog_sales_profit\"
FROM
    juicy
    INNER JOIN young on (juicy.\"store_sales_item_desc\" = young.\"store_sales_item_desc\" or (juicy.\"store_sales_item_desc\" is null and young.\"store_sales_item_desc\" is null)) AND juicy.\"store_sales_item_name\" = young.\"store_sales_item_name\" AND juicy.\"store_sales_store_name\" = young.\"store_sales_store_name\" AND juicy.\"store_sales_store_text_id\" = young.\"store_sales_store_text_id\"
ORDER BY 
    juicy.\"store_sales_item_name\" asc,
    juicy.\"store_sales_item_desc\" asc,
    juicy.\"store_sales_store_text_id\" asc,
    juicy.\"store_sales_store_name\" asc
LIMIT (100)"""
