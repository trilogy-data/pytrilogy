query_id = 25
gen_length = 15293
generated_sql = """

WITH 
concerned as (
SELECT
    catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\" as \"store_sales_customer_id\",
    catalog_sales_catalog_sales.\"CS_ITEM_SK\" as \"store_sales_item_id\",
    catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" as \"catalog_sales_date_id\"
FROM
    memory.catalog_sales as catalog_sales_catalog_sales
GROUP BY 
    catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\",
    catalog_sales_catalog_sales.\"CS_ITEM_SK\",
    catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\"),
uneven as (
SELECT
    CASE WHEN store_sales_store_returns.\"SR_RETURN_TIME_SK\" THEN TRUE ELSE FALSE END as \"store_sales_is_returned\",
    cast(catalog_sales_date_date.\"D_YEAR\" as int) as \"catalog_sales_date_year\",
    cast(store_sales_date_date.\"D_YEAR\" as int) as \"store_sales_date_year\",
    cast(store_sales_return_date_date.\"D_YEAR\" as int) as \"store_sales_return_date_year\",
    catalog_sales_catalog_sales.\"CS_NET_PROFIT\" as \"catalog_sales_net_profit\",
    catalog_sales_catalog_sales.\"CS_ORDER_NUMBER\" as \"catalog_sales_order_number\",
    catalog_sales_date_date.\"D_DATE_SK\" as \"catalog_sales_date_id\",
    catalog_sales_date_date.\"D_MOY\" as \"catalog_sales_date_month_of_year\",
    store_sales_date_date.\"D_DATE_SK\" as \"store_sales_date_id\",
    store_sales_date_date.\"D_MOY\" as \"store_sales_date_month_of_year\",
    store_sales_item_items.\"I_ITEM_DESC\" as \"store_sales_item_desc\",
    store_sales_item_items.\"I_ITEM_ID\" as \"store_sales_item_name\",
    store_sales_item_items.\"I_ITEM_SK\" as \"store_sales_item_id\",
    store_sales_return_date_date.\"D_DATE_SK\" as \"store_sales_return_date_id\",
    store_sales_return_date_date.\"D_MOY\" as \"store_sales_return_date_month_of_year\",
    store_sales_store_returns.\"SR_CUSTOMER_SK\" as \"store_sales_return_customer_id\",
    store_sales_store_sales.\"SS_CUSTOMER_SK\" as \"store_sales_customer_id\",
    store_sales_store_store.\"S_STORE_ID\" as \"store_sales_store_text_id\",
    store_sales_store_store.\"S_STORE_NAME\" as \"store_sales_store_name\",
    store_sales_store_store.\"S_STORE_SK\" as \"store_sales_store_id\"
FROM
    memory.catalog_sales as catalog_sales_catalog_sales
    INNER JOIN memory.store_sales as store_sales_store_sales on catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\" = store_sales_store_sales.\"SS_CUSTOMER_SK\" AND catalog_sales_catalog_sales.\"CS_ITEM_SK\" = store_sales_store_sales.\"SS_ITEM_SK\"
    INNER JOIN memory.item as store_sales_item_items on catalog_sales_catalog_sales.\"CS_ITEM_SK\" = store_sales_item_items.\"I_ITEM_SK\"
    LEFT OUTER JOIN memory.store_returns as store_sales_store_returns on catalog_sales_catalog_sales.\"CS_ITEM_SK\" = store_sales_store_returns.\"SR_ITEM_SK\" AND store_sales_store_sales.\"SS_ITEM_SK\" = store_sales_store_returns.\"SR_ITEM_SK\" AND store_sales_store_sales.\"SS_TICKET_NUMBER\" = store_sales_store_returns.\"SR_TICKET_NUMBER\"
    INNER JOIN memory.date_dim as store_sales_date_date on store_sales_store_sales.\"SS_SOLD_DATE_SK\" = store_sales_date_date.\"D_DATE_SK\"
    INNER JOIN memory.store as store_sales_store_store on store_sales_store_sales.\"SS_STORE_SK\" = store_sales_store_store.\"S_STORE_SK\"
    INNER JOIN memory.date_dim as catalog_sales_date_date on catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" = catalog_sales_date_date.\"D_DATE_SK\"
    LEFT OUTER JOIN memory.date_dim as store_sales_return_date_date on store_sales_store_returns.\"SR_RETURNED_DATE_SK\" = store_sales_return_date_date.\"D_DATE_SK\"
    INNER JOIN memory.customer as catalog_sales_bill_customer_customers on catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\" = catalog_sales_bill_customer_customers.\"C_CUSTOMER_SK\"
WHERE
    cast(store_sales_date_date.\"D_YEAR\" as int) = 2001 and store_sales_date_date.\"D_MOY\" = 4 and cast(store_sales_return_date_date.\"D_YEAR\" as int) = 2001 and store_sales_return_date_date.\"D_MOY\" >= 4 and store_sales_return_date_date.\"D_MOY\" <= 10 and cast(catalog_sales_date_date.\"D_YEAR\" as int) = 2001 and catalog_sales_date_date.\"D_MOY\" >= 4 and catalog_sales_date_date.\"D_MOY\" <= 10 and store_sales_store_returns.\"SR_CUSTOMER_SK\" = store_sales_store_sales.\"SS_CUSTOMER_SK\"
),
young as (
SELECT
    CASE WHEN store_sales_store_returns.\"SR_RETURN_TIME_SK\" THEN TRUE ELSE FALSE END as \"store_sales_is_returned\",
    cast(catalog_sales_date_date.\"D_YEAR\" as int) as \"catalog_sales_date_year\",
    cast(store_sales_date_date.\"D_YEAR\" as int) as \"store_sales_date_year\",
    cast(store_sales_return_date_date.\"D_YEAR\" as int) as \"store_sales_return_date_year\",
    catalog_sales_date_date.\"D_DATE_SK\" as \"catalog_sales_date_id\",
    catalog_sales_date_date.\"D_MOY\" as \"catalog_sales_date_month_of_year\",
    store_sales_date_date.\"D_DATE_SK\" as \"store_sales_date_id\",
    store_sales_date_date.\"D_MOY\" as \"store_sales_date_month_of_year\",
    store_sales_item_items.\"I_ITEM_DESC\" as \"store_sales_item_desc\",
    store_sales_item_items.\"I_ITEM_ID\" as \"store_sales_item_name\",
    store_sales_item_items.\"I_ITEM_SK\" as \"store_sales_item_id\",
    store_sales_return_date_date.\"D_DATE_SK\" as \"store_sales_return_date_id\",
    store_sales_return_date_date.\"D_MOY\" as \"store_sales_return_date_month_of_year\",
    store_sales_store_returns.\"SR_CUSTOMER_SK\" as \"store_sales_return_customer_id\",
    store_sales_store_returns.\"SR_NET_LOSS\" as \"store_sales_return_net_loss\",
    store_sales_store_sales.\"SS_CUSTOMER_SK\" as \"store_sales_customer_id\",
    store_sales_store_sales.\"SS_NET_PROFIT\" as \"store_sales_net_profit\",
    store_sales_store_sales.\"SS_TICKET_NUMBER\" as \"store_sales_ticket_number\",
    store_sales_store_store.\"S_STORE_ID\" as \"store_sales_store_text_id\",
    store_sales_store_store.\"S_STORE_NAME\" as \"store_sales_store_name\",
    store_sales_store_store.\"S_STORE_SK\" as \"store_sales_store_id\"
FROM
    concerned
    INNER JOIN memory.store_sales as store_sales_store_sales on concerned.\"store_sales_customer_id\" = store_sales_store_sales.\"SS_CUSTOMER_SK\" AND concerned.\"store_sales_item_id\" = store_sales_store_sales.\"SS_ITEM_SK\"
    INNER JOIN memory.item as store_sales_item_items on concerned.\"store_sales_item_id\" = store_sales_item_items.\"I_ITEM_SK\"
    LEFT OUTER JOIN memory.store_returns as store_sales_store_returns on concerned.\"store_sales_item_id\" = store_sales_store_returns.\"SR_ITEM_SK\" AND store_sales_store_sales.\"SS_ITEM_SK\" = store_sales_store_returns.\"SR_ITEM_SK\" AND store_sales_store_sales.\"SS_TICKET_NUMBER\" = store_sales_store_returns.\"SR_TICKET_NUMBER\"
    INNER JOIN memory.date_dim as store_sales_date_date on store_sales_store_sales.\"SS_SOLD_DATE_SK\" = store_sales_date_date.\"D_DATE_SK\"
    INNER JOIN memory.store as store_sales_store_store on store_sales_store_sales.\"SS_STORE_SK\" = store_sales_store_store.\"S_STORE_SK\"
    INNER JOIN memory.date_dim as catalog_sales_date_date on concerned.\"catalog_sales_date_id\" = catalog_sales_date_date.\"D_DATE_SK\"
    LEFT OUTER JOIN memory.date_dim as store_sales_return_date_date on store_sales_store_returns.\"SR_RETURNED_DATE_SK\" = store_sales_return_date_date.\"D_DATE_SK\"
WHERE
    cast(store_sales_date_date.\"D_YEAR\" as int) = 2001 and store_sales_date_date.\"D_MOY\" = 4 and cast(store_sales_return_date_date.\"D_YEAR\" as int) = 2001 and store_sales_return_date_date.\"D_MOY\" >= 4 and store_sales_return_date_date.\"D_MOY\" <= 10 and cast(catalog_sales_date_date.\"D_YEAR\" as int) = 2001 and catalog_sales_date_date.\"D_MOY\" >= 4 and catalog_sales_date_date.\"D_MOY\" <= 10 and store_sales_store_returns.\"SR_CUSTOMER_SK\" = store_sales_store_sales.\"SS_CUSTOMER_SK\"
),
yummy as (
SELECT
    uneven.\"catalog_sales_date_id\" as \"catalog_sales_date_id\",
    uneven.\"catalog_sales_date_month_of_year\" as \"catalog_sales_date_month_of_year\",
    uneven.\"catalog_sales_date_year\" as \"catalog_sales_date_year\",
    uneven.\"catalog_sales_net_profit\" as \"catalog_sales_net_profit\",
    uneven.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",
    uneven.\"store_sales_customer_id\" as \"store_sales_customer_id\",
    uneven.\"store_sales_date_id\" as \"store_sales_date_id\",
    uneven.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",
    uneven.\"store_sales_date_year\" as \"store_sales_date_year\",
    uneven.\"store_sales_is_returned\" as \"store_sales_is_returned\",
    uneven.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    uneven.\"store_sales_item_id\" as \"store_sales_item_id\",
    uneven.\"store_sales_item_name\" as \"store_sales_item_name\",
    uneven.\"store_sales_return_customer_id\" as \"store_sales_return_customer_id\",
    uneven.\"store_sales_return_date_id\" as \"store_sales_return_date_id\",
    uneven.\"store_sales_return_date_month_of_year\" as \"store_sales_return_date_month_of_year\",
    uneven.\"store_sales_return_date_year\" as \"store_sales_return_date_year\",
    uneven.\"store_sales_store_id\" as \"store_sales_store_id\",
    uneven.\"store_sales_store_name\" as \"store_sales_store_name\",
    uneven.\"store_sales_store_text_id\" as \"store_sales_store_text_id\"
FROM
    uneven
GROUP BY 
    uneven.\"catalog_sales_date_id\",
    uneven.\"catalog_sales_date_month_of_year\",
    uneven.\"catalog_sales_date_year\",
    uneven.\"catalog_sales_net_profit\",
    uneven.\"catalog_sales_order_number\",
    uneven.\"store_sales_customer_id\",
    uneven.\"store_sales_date_id\",
    uneven.\"store_sales_date_month_of_year\",
    uneven.\"store_sales_date_year\",
    uneven.\"store_sales_is_returned\",
    uneven.\"store_sales_item_desc\",
    uneven.\"store_sales_item_id\",
    uneven.\"store_sales_item_name\",
    uneven.\"store_sales_return_customer_id\",
    uneven.\"store_sales_return_date_id\",
    uneven.\"store_sales_return_date_month_of_year\",
    uneven.\"store_sales_return_date_year\",
    uneven.\"store_sales_store_id\",
    uneven.\"store_sales_store_name\",
    uneven.\"store_sales_store_text_id\"),
sparkling as (
SELECT
    young.\"catalog_sales_date_month_of_year\" as \"catalog_sales_date_month_of_year\",
    young.\"catalog_sales_date_year\" as \"catalog_sales_date_year\",
    young.\"store_sales_customer_id\" as \"store_sales_customer_id\",
    young.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",
    young.\"store_sales_date_year\" as \"store_sales_date_year\",
    young.\"store_sales_is_returned\" as \"store_sales_is_returned\",
    young.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    young.\"store_sales_item_id\" as \"store_sales_item_id\",
    young.\"store_sales_item_name\" as \"store_sales_item_name\",
    young.\"store_sales_net_profit\" as \"store_sales_net_profit\",
    young.\"store_sales_return_customer_id\" as \"store_sales_return_customer_id\",
    young.\"store_sales_return_date_month_of_year\" as \"store_sales_return_date_month_of_year\",
    young.\"store_sales_return_date_year\" as \"store_sales_return_date_year\",
    young.\"store_sales_return_net_loss\" as \"store_sales_return_net_loss\",
    young.\"store_sales_store_name\" as \"store_sales_store_name\",
    young.\"store_sales_store_text_id\" as \"store_sales_store_text_id\",
    young.\"store_sales_ticket_number\" as \"store_sales_ticket_number\"
FROM
    young
WHERE
    young.\"store_sales_date_year\" = 2001 and young.\"store_sales_date_month_of_year\" = 4 and young.\"store_sales_return_date_year\" = 2001 and young.\"store_sales_return_date_month_of_year\" >= 4 and young.\"store_sales_return_date_month_of_year\" <= 10 and young.\"catalog_sales_date_year\" = 2001 and young.\"catalog_sales_date_month_of_year\" >= 4 and young.\"catalog_sales_date_month_of_year\" <= 10 and young.\"store_sales_return_customer_id\" = young.\"store_sales_customer_id\" and young.\"store_sales_is_returned\"
),
juicy as (
SELECT
    yummy.\"catalog_sales_date_month_of_year\" as \"catalog_sales_date_month_of_year\",
    yummy.\"catalog_sales_date_year\" as \"catalog_sales_date_year\",
    yummy.\"catalog_sales_net_profit\" as \"catalog_sales_net_profit\",
    yummy.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",
    yummy.\"store_sales_customer_id\" as \"store_sales_customer_id\",
    yummy.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",
    yummy.\"store_sales_date_year\" as \"store_sales_date_year\",
    yummy.\"store_sales_is_returned\" as \"store_sales_is_returned\",
    yummy.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    yummy.\"store_sales_item_id\" as \"store_sales_item_id\",
    yummy.\"store_sales_item_name\" as \"store_sales_item_name\",
    yummy.\"store_sales_return_customer_id\" as \"store_sales_return_customer_id\",
    yummy.\"store_sales_return_date_month_of_year\" as \"store_sales_return_date_month_of_year\",
    yummy.\"store_sales_return_date_year\" as \"store_sales_return_date_year\",
    yummy.\"store_sales_store_name\" as \"store_sales_store_name\",
    yummy.\"store_sales_store_text_id\" as \"store_sales_store_text_id\"
FROM
    yummy
WHERE
    yummy.\"store_sales_date_year\" = 2001 and yummy.\"store_sales_date_month_of_year\" = 4 and yummy.\"store_sales_return_date_year\" = 2001 and yummy.\"store_sales_return_date_month_of_year\" >= 4 and yummy.\"store_sales_return_date_month_of_year\" <= 10 and yummy.\"catalog_sales_date_year\" = 2001 and yummy.\"catalog_sales_date_month_of_year\" >= 4 and yummy.\"catalog_sales_date_month_of_year\" <= 10 and yummy.\"store_sales_return_customer_id\" = yummy.\"store_sales_customer_id\" and yummy.\"store_sales_is_returned\"
),
abhorrent as (
SELECT
    sparkling.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    sparkling.\"store_sales_item_name\" as \"store_sales_item_name\",
    sparkling.\"store_sales_store_name\" as \"store_sales_store_name\",
    sparkling.\"store_sales_store_text_id\" as \"store_sales_store_text_id\",
    sum(sparkling.\"store_sales_net_profit\") as \"store_sales_profit\",
    sum(sparkling.\"store_sales_return_net_loss\") as \"store_returns_loss\"
FROM
    sparkling
GROUP BY 
    sparkling.\"store_sales_item_desc\",
    sparkling.\"store_sales_item_name\",
    sparkling.\"store_sales_store_name\",
    sparkling.\"store_sales_store_text_id\"),
vacuous as (
SELECT
    juicy.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    juicy.\"store_sales_item_name\" as \"store_sales_item_name\",
    juicy.\"store_sales_store_name\" as \"store_sales_store_name\",
    juicy.\"store_sales_store_text_id\" as \"store_sales_store_text_id\",
    sum(juicy.\"catalog_sales_net_profit\") as \"catalog_sales_profit\"
FROM
    juicy
GROUP BY 
    juicy.\"store_sales_item_desc\",
    juicy.\"store_sales_item_name\",
    juicy.\"store_sales_store_name\",
    juicy.\"store_sales_store_text_id\")
SELECT
    vacuous.\"store_sales_item_name\" as \"store_sales_item_name\",
    vacuous.\"store_sales_item_desc\" as \"store_sales_item_desc\",
    vacuous.\"store_sales_store_text_id\" as \"store_sales_store_text_id\",
    vacuous.\"store_sales_store_name\" as \"store_sales_store_name\",
    abhorrent.\"store_sales_profit\" as \"store_sales_profit\",
    abhorrent.\"store_returns_loss\" as \"store_returns_loss\",
    vacuous.\"catalog_sales_profit\" as \"catalog_sales_profit\"
FROM
    vacuous
    INNER JOIN abhorrent on (vacuous.\"store_sales_item_desc\" = abhorrent.\"store_sales_item_desc\" or (vacuous.\"store_sales_item_desc\" is null and abhorrent.\"store_sales_item_desc\" is null)) AND vacuous.\"store_sales_item_name\" = abhorrent.\"store_sales_item_name\" AND vacuous.\"store_sales_store_name\" = abhorrent.\"store_sales_store_name\" AND vacuous.\"store_sales_store_text_id\" = abhorrent.\"store_sales_store_text_id\"
ORDER BY 
    vacuous.\"store_sales_item_name\" asc,
    vacuous.\"store_sales_item_desc\" asc,
    vacuous.\"store_sales_store_text_id\" asc,
    vacuous.\"store_sales_store_name\" asc
LIMIT (100)"""
