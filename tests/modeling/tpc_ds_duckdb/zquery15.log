query_id = 15
parse_time = 0.313188
exec_time = 0.184309
comp_time = 0.161457
gen_length = 1907
generated_sql = """

WITH 
cheerful as (
SELECT
    cast(catalog_sales_date_date.\"D_YEAR\" as int) as \"catalog_sales_date_year\",
    catalog_sales_bill_customer_customer_address.\"CA_STATE\" as \"catalog_sales_bill_customer_state\",
    catalog_sales_bill_customer_customer_address.\"CA_ZIP\" as \"catalog_sales_bill_customer_zip\",
    catalog_sales_catalog_sales.\"CS_ITEM_SK\" as \"catalog_sales_item_id\",
    catalog_sales_catalog_sales.\"CS_ORDER_NUMBER\" as \"catalog_sales_order_number\",
    catalog_sales_catalog_sales.\"CS_SALES_PRICE\" as \"catalog_sales_sales_price\",
    catalog_sales_date_date.\"D_QOY\" as \"catalog_sales_date_quarter\"
FROM
    memory.customer_address as catalog_sales_bill_customer_customer_address
    INNER JOIN memory.customer as catalog_sales_bill_customer_customers on catalog_sales_bill_customer_customer_address.\"CA_ADDRESS_SK\" = catalog_sales_bill_customer_customers.\"C_CURRENT_ADDR_SK\"
    INNER JOIN memory.catalog_sales as catalog_sales_catalog_sales on catalog_sales_bill_customer_customers.\"C_CUSTOMER_SK\" = catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\"
    INNER JOIN memory.date_dim as catalog_sales_date_date on catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" = catalog_sales_date_date.\"D_DATE_SK\"
WHERE
    catalog_sales_date_date.\"D_QOY\" = 2 and cast(catalog_sales_date_date.\"D_YEAR\" as int) = 2001 and ( catalog_sales_bill_customer_customer_address.\"CA_STATE\" in ('CA','WA','GA') or catalog_sales_catalog_sales.\"CS_SALES_PRICE\" > 500 or SUBSTRING(catalog_sales_bill_customer_customer_address.\"CA_ZIP\",1,5) in ('85669','86197','88274','83405','86475','85392','85460','80348','81792') )
)
SELECT
    cheerful.\"catalog_sales_bill_customer_zip\" as \"catalog_sales_bill_customer_zip\",
    sum(cheerful.\"catalog_sales_sales_price\") as \"sales\"
FROM
    cheerful
GROUP BY 
    cheerful.\"catalog_sales_bill_customer_zip\"
ORDER BY 
    cheerful.\"catalog_sales_bill_customer_zip\" asc nulls first
LIMIT (100)"""
