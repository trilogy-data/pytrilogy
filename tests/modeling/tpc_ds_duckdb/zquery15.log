query_id = 15
gen_length = 10002
generated_sql = """

WITH 
cheerful as (
-- Target: Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>. Group: False Source: SourceType.MERGE.
-- Joins: inner join catalog_sales_bill_customer_customers on dynamic.catalog_sales.bill_customer.address_id=catalog_sales.bill_customer.address_id, inner join catalog_sales_catalog_sales on highfalutin.catalog_sales.bill_customer.id=catalog_sales.bill_customer.id, inner join catalog_sales_date_date on wakeful.catalog_sales.date.id=catalog_sales.date.id.
-- Source Map: {'catalog_sales.date.id': ['catalog_sales_date_date'], 'catalog_sales.date.year': ['catalog_sales_date_date'], 'catalog_sales.date.quarter': ['catalog_sales_date_date'], 'catalog_sales.bill_customer.address_id': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.id': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.zip': ['catalog_sales_bill_customer_customer_address'], 'catalog_sales.bill_customer.state': ['catalog_sales_bill_customer_customer_address'], 'catalog_sales.sales_price': ['catalog_sales_catalog_sales'], 'catalog_sales.item.id': ['catalog_sales_catalog_sales'], 'catalog_sales.order_number': ['catalog_sales_catalog_sales'], 'catalog_sales.date._date_string': ['catalog_sales_date_date'], 'catalog_sales.date.date_string': ['catalog_sales_date_date'], 'catalog_sales.date.week_seq': ['catalog_sales_date_date'], 'catalog_sales.date._year_string': ['catalog_sales_date_date'], 'catalog_sales.date.month_of_year': ['catalog_sales_date_date'], 'catalog_sales.date.date': ['catalog_sales_date_date'], 'catalog_sales.date.day_of_week': ['catalog_sales_date_date'], 'catalog_sales.bill_customer.birth_year': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.last_review_date': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.birth_country': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.demographics.id': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.email_address': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.first_name': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.last_name': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.salutation': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.text_id': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.preferred_cust_flag': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.birth_month': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.login': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.birth_day': ['catalog_sales_bill_customer_customers'], 'catalog_sales.bill_customer.city': ['catalog_sales_bill_customer_customer_address'], 'catalog_sales.bill_customer.street': ['catalog_sales_bill_customer_customer_address'], 'catalog_sales.bill_customer.country': ['catalog_sales_bill_customer_customer_address'], 'catalog_sales.bill_customer.county': ['catalog_sales_bill_customer_customer_address'], 'catalog_sales.promotion.id': ['catalog_sales_catalog_sales'], 'catalog_sales.extra_ship_cost': ['catalog_sales_catalog_sales'], 'catalog_sales.call_center.id': ['catalog_sales_catalog_sales'], 'catalog_sales.ship_date.id': ['catalog_sales_catalog_sales'], 'catalog_sales.warehouse.id': ['catalog_sales_catalog_sales'], 'catalog_sales.time.id': ['catalog_sales_catalog_sales'], 'catalog_sales.extra_wholesale_cost': ['catalog_sales_catalog_sales'], 'catalog_sales.customer.address_id': ['catalog_sales_catalog_sales'], 'catalog_sales.customer.id': ['catalog_sales_catalog_sales'], 'catalog_sales.list_price': ['catalog_sales_catalog_sales'], 'catalog_sales.net_profit': ['catalog_sales_catalog_sales'], 'catalog_sales.coupon_amt': ['catalog_sales_catalog_sales'], 'catalog_sales.sold_date.id': ['catalog_sales_catalog_sales'], 'catalog_sales.bill_customer_demographic.id': ['catalog_sales_catalog_sales'], 'catalog_sales.extra_sales_price': ['catalog_sales_catalog_sales'], 'catalog_sales.wholesale_cost': ['catalog_sales_catalog_sales'], 'catalog_sales.quantity': ['catalog_sales_catalog_sales']}.
-- Output: catalog_sales.bill_customer.address_id@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.bill_customer.id@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.bill_customer.state@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.bill_customer.zip@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.date.id@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.date.quarter@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.date.year@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.item.id@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.order_number@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.sales_price@Grain<catalog_sales.bill_customer.address_id,catalog_sales.bill_customer.id,catalog_sales.date.id,catalog_sales.item.id,catalog_sales.order_number>.
-- Inputs: catalog_sales.bill_customer.address_id@Grain<catalog_sales.bill_customer.address_id>, catalog_sales.bill_customer.id@Grain<catalog_sales.bill_customer.id>, catalog_sales.bill_customer.state@Grain<catalog_sales.bill_customer.address_id>, catalog_sales.bill_customer.zip@Grain<catalog_sales.bill_customer.address_id>, catalog_sales.date.id@Grain<catalog_sales.date.id>, catalog_sales.date.quarter@Grain<catalog_sales.date.id>, catalog_sales.date.year@Grain<catalog_sales.date.id>, catalog_sales.item.id@Grain<catalog_sales.item.id>, catalog_sales.order_number@Grain<catalog_sales.order_number>, catalog_sales.sales_price@Grain<catalog_sales.item.id,catalog_sales.order_number>.
SELECT
    cast(catalog_sales_date_date.\"D_YEAR\" as int) as \"catalog_sales_date_year\",
    catalog_sales_bill_customer_customer_address.\"CA_STATE\" as \"catalog_sales_bill_customer_state\",
    catalog_sales_bill_customer_customer_address.\"CA_ZIP\" as \"catalog_sales_bill_customer_zip\",
    catalog_sales_bill_customer_customers.\"C_CURRENT_ADDR_SK\" as \"catalog_sales_bill_customer_address_id\",
    catalog_sales_bill_customer_customers.\"C_CUSTOMER_SK\" as \"catalog_sales_bill_customer_id\",
    catalog_sales_catalog_sales.\"CS_ITEM_SK\" as \"catalog_sales_item_id\",
    catalog_sales_catalog_sales.\"CS_ORDER_NUMBER\" as \"catalog_sales_order_number\",
    catalog_sales_catalog_sales.\"CS_SALES_PRICE\" as \"catalog_sales_sales_price\",
    catalog_sales_date_date.\"D_DATE_SK\" as \"catalog_sales_date_id\",
    catalog_sales_date_date.\"D_QOY\" as \"catalog_sales_date_quarter\"
FROM
    memory.customer_address as catalog_sales_bill_customer_customer_address
    INNER JOIN memory.customer as catalog_sales_bill_customer_customers on catalog_sales_bill_customer_customer_address.\"CA_ADDRESS_SK\" = catalog_sales_bill_customer_customers.\"C_CURRENT_ADDR_SK\"
    INNER JOIN memory.catalog_sales as catalog_sales_catalog_sales on catalog_sales_bill_customer_customers.\"C_CUSTOMER_SK\" = catalog_sales_catalog_sales.\"CS_BILL_CUSTOMER_SK\"
    INNER JOIN memory.date_dim as catalog_sales_date_date on catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" = catalog_sales_date_date.\"D_DATE_SK\"
WHERE
    catalog_sales_date_date.\"D_QOY\" = 2 and cast(catalog_sales_date_date.\"D_YEAR\" as int) = 2001 and ( catalog_sales_bill_customer_customer_address.\"CA_STATE\" in ('CA','WA','GA') or catalog_sales_catalog_sales.\"CS_SALES_PRICE\" > 500 or SUBSTRING(catalog_sales_bill_customer_customer_address.\"CA_ZIP\",1,5) in ('85669','86197','88274','83405','86475','85392','85460','80348','81792') )
)
-- Target: Grain<catalog_sales.bill_customer.zip>. Group: True Source: SourceType.GROUP. References: cheerful.
-- Source Map: {'catalog_sales.bill_customer.address_id': ['cheerful'], 'catalog_sales.bill_customer.id': ['cheerful'], 'catalog_sales.bill_customer.state': ['cheerful'], 'catalog_sales.bill_customer.zip': ['cheerful'], 'catalog_sales.date.id': ['cheerful'], 'catalog_sales.date.quarter': ['cheerful'], 'catalog_sales.date.year': ['cheerful'], 'catalog_sales.item.id': ['cheerful'], 'catalog_sales.order_number': ['cheerful'], 'catalog_sales.sales_price': ['cheerful'], 'local.sales': []}.
-- Output: catalog_sales.bill_customer.zip@Grain<catalog_sales.bill_customer.zip>, local.sales@Grain<catalog_sales.bill_customer.zip>.
-- Inputs: catalog_sales.sales_price@Grain<catalog_sales.item.id,catalog_sales.order_number>, catalog_sales.bill_customer.zip@Grain<catalog_sales.bill_customer.address_id>, catalog_sales.order_number@Grain<catalog_sales.order_number>, catalog_sales.item.id@Grain<catalog_sales.item.id>.
-- Nullable: local.sales@Grain<catalog_sales.bill_customer.zip>.
SELECT
    cheerful.\"catalog_sales_bill_customer_zip\" as \"catalog_sales_bill_customer_zip\",
    sum(cheerful.\"catalog_sales_sales_price\") as \"sales\"
FROM
    cheerful
GROUP BY 
    cheerful.\"catalog_sales_bill_customer_zip\"
ORDER BY 
    cheerful.\"catalog_sales_bill_customer_zip\" asc nulls first
LIMIT (100)"""
