query_id = 24
gen_length = 51661
generated_sql = """

WITH 
questionable as (
-- Target: Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>. Group: False Source: SourceType.MERGE.
-- Joins: inner join store_sales_item_items on thoughtful.store_sales.item.id=store_sales.item.id, left outer join store_sales_store_returns on thoughtful.store_sales.item.id=store_sales.item.id,thoughtful.store_sales.ticket_number=store_sales.ticket_number,highfalutin.store_sales.item.id=store_sales.item.id, inner join store_sales_store_store on thoughtful.store_sales.store.id=store_sales.store.id, inner join store_sales_customer_customers on thoughtful.store_sales.customer.id=store_sales.customer.id, inner join store_sales_customer_customer_address on dynamic.store_sales.customer.address_id=store_sales.customer.address_id.
-- Source Map: {'store_sales.item.units': ['store_sales_item_items'], 'store_sales.item.size': ['store_sales_item_items'], 'store_sales.item.current_price': ['store_sales_item_items'], 'store_sales.item.manager_id': ['store_sales_item_items'], 'store_sales.item.color': ['store_sales_item_items'], 'store_sales.item.id': ['store_sales_item_items'], 'store_sales.customer.last_name': ['store_sales_customer_customers'], 'store_sales.customer.id': ['store_sales_customer_customers'], 'store_sales.customer.first_name': ['store_sales_customer_customers'], 'store_sales.customer.address_id': ['store_sales_customer_customers'], 'store_sales.customer.birth_country': ['store_sales_customer_customers'], 'store_sales.customer.zip': ['store_sales_customer_customer_address'], 'store_sales.customer.state': ['store_sales_customer_customer_address'], 'store_sales.customer.country': ['store_sales_customer_customer_address'], 'store_sales.store.market': ['store_sales_store_store'], 'store_sales.store.id': ['store_sales_store_store'], 'store_sales.store.state': ['store_sales_store_store'], 'store_sales.store.zip': ['store_sales_store_store'], 'store_sales.store.name': ['store_sales_store_store'], 'store_sales.ticket_number': ['store_sales_store_sales'], 'store_sales.net_paid': ['store_sales_store_sales'], 'store_sales.is_returned': ['store_sales_store_returns'], 'store_sales.item.brand_id': ['store_sales_item_items'], 'store_sales.item.manufacturer_id': ['store_sales_item_items'], 'store_sales.item.class': ['store_sales_item_items'], 'store_sales.item.desc': ['store_sales_item_items'], 'store_sales.item.name': ['store_sales_item_items'], 'store_sales.item.category': ['store_sales_item_items'], 'store_sales.item.brand_name': ['store_sales_item_items'], 'store_sales.customer.birth_month': ['store_sales_customer_customers'], 'store_sales.customer.login': ['store_sales_customer_customers'], 'store_sales.customer.preferred_cust_flag': ['store_sales_customer_customers'], 'store_sales.customer.birth_day': ['store_sales_customer_customers'], 'store_sales.customer.birth_year': ['store_sales_customer_customers'], 'store_sales.customer.demographics.id': ['store_sales_customer_customers'], 'store_sales.customer.text_id': ['store_sales_customer_customers'], 'store_sales.customer.salutation': ['store_sales_customer_customers'], 'store_sales.customer.last_review_date': ['store_sales_customer_customers'], 'store_sales.customer.email_address': ['store_sales_customer_customers'], 'store_sales.customer.street': ['store_sales_customer_customer_address'], 'store_sales.customer.city': ['store_sales_customer_customer_address'], 'store_sales.customer.county': ['store_sales_customer_customer_address'], 'store_sales.store.employees': ['store_sales_store_store'], 'store_sales.store.market_id': ['store_sales_store_store'], 'store_sales.store.county': ['store_sales_store_store'], 'store_sales.store.geography_class': ['store_sales_store_store'], 'store_sales.store.hours': ['store_sales_store_store'], 'store_sales.store.store_manager': ['store_sales_store_store'], 'store_sales.store.tax_percentage': ['store_sales_store_store'], 'store_sales.store.city': ['store_sales_store_store'], 'store_sales.store.date.id': ['store_sales_store_store'], 'store_sales.store.text_id': ['store_sales_store_store'], 'store_sales.store.floor_space': ['store_sales_store_store'], 'store_sales.store.market_manager': ['store_sales_store_store'], 'store_sales.coupon_amt': ['store_sales_store_sales'], 'store_sales.date.id': ['store_sales_store_sales'], 'store_sales.ext_discount_amount': ['store_sales_store_sales'], 'store_sales.net_profit': ['store_sales_store_sales'], 'store_sales.quantity': ['store_sales_store_sales'], 'store_sales.ext_list_price': ['store_sales_store_sales'], 'store_sales.time.id': ['store_sales_store_sales'], 'store_sales.ext_wholesale_cost': ['store_sales_store_sales'], 'store_sales.sales_price': ['store_sales_store_sales'], 'store_sales.promotion.id': ['store_sales_store_sales'], 'store_sales.list_price': ['store_sales_store_sales'], 'store_sales.customer_demographic.id': ['store_sales_store_sales'], 'store_sales.ext_sales_price': ['store_sales_store_sales'], 'store_sales.return_store.id': ['store_sales_store_returns'], 'store_sales.return_date.id': ['store_sales_store_returns'], 'store_sales.return_customer.id': ['store_sales_store_returns'], 'store_sales.return_time.id': ['store_sales_store_returns'], 'store_sales.return_net_loss': ['store_sales_store_returns'], 'store_sales.return_amount': ['store_sales_store_returns']}.
-- Output: store_sales.customer.address_id@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.customer.birth_country@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.customer.country@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.customer.first_name@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.customer.id@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.customer.last_name@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.customer.state@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.customer.zip@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.is_returned@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.color@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.current_price@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.id@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.manager_id@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.size@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.item.units@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.net_paid@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.id@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.market@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.name@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.state@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.store.zip@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>, store_sales.ticket_number@Grain<store_sales.customer.address_id,store_sales.customer.id,store_sales.item.id,store_sales.store.id,store_sales.ticket_number>.
-- Inputs: store_sales.customer.address_id@Grain<store_sales.customer.address_id>, store_sales.customer.birth_country@Grain<store_sales.customer.id>, store_sales.customer.country@Grain<store_sales.customer.address_id>, store_sales.customer.first_name@Grain<store_sales.customer.id>, store_sales.customer.id@Grain<store_sales.customer.id>, store_sales.customer.last_name@Grain<store_sales.customer.id>, store_sales.customer.state@Grain<store_sales.customer.address_id>, store_sales.customer.zip@Grain<store_sales.customer.address_id>, store_sales.is_returned@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.item.color@Grain<store_sales.item.id>, store_sales.item.current_price@Grain<store_sales.item.id>, store_sales.item.id@Grain<store_sales.item.id>, store_sales.item.manager_id@Grain<store_sales.item.id>, store_sales.item.size@Grain<store_sales.item.id>, store_sales.item.units@Grain<store_sales.item.id>, store_sales.net_paid@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.store.id@Grain<store_sales.store.id>, store_sales.store.market@Grain<store_sales.store.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.store.state@Grain<store_sales.store.id>, store_sales.store.zip@Grain<store_sales.store.id>, store_sales.ticket_number@Grain<store_sales.ticket_number>.
SELECT
    CASE WHEN store_sales_store_returns.\"SR_RETURN_TIME_SK\" THEN TRUE ELSE FALSE END as \"store_sales_is_returned\",
    store_sales_customer_customer_address.\"CA_COUNTRY\" as \"store_sales_customer_country\",
    store_sales_customer_customer_address.\"CA_STATE\" as \"store_sales_customer_state\",
    store_sales_customer_customer_address.\"CA_ZIP\" as \"store_sales_customer_zip\",
    store_sales_customer_customers.\"C_BIRTH_COUNTRY\" as \"store_sales_customer_birth_country\",
    store_sales_customer_customers.\"C_CURRENT_ADDR_SK\" as \"store_sales_customer_address_id\",
    store_sales_customer_customers.\"C_CUSTOMER_SK\" as \"store_sales_customer_id\",
    store_sales_customer_customers.\"C_FIRST_NAME\" as \"store_sales_customer_first_name\",
    store_sales_customer_customers.\"C_LAST_NAME\" as \"store_sales_customer_last_name\",
    store_sales_item_items.\"I_COLOR\" as \"store_sales_item_color\",
    store_sales_item_items.\"I_CURRENT_PRICE\" as \"store_sales_item_current_price\",
    store_sales_item_items.\"I_ITEM_SK\" as \"store_sales_item_id\",
    store_sales_item_items.\"I_MANAGER_ID\" as \"store_sales_item_manager_id\",
    store_sales_item_items.\"I_SIZE\" as \"store_sales_item_size\",
    store_sales_item_items.\"I_UNITS\" as \"store_sales_item_units\",
    store_sales_store_sales.\"SS_NET_PAID\" as \"store_sales_net_paid\",
    store_sales_store_sales.\"SS_TICKET_NUMBER\" as \"store_sales_ticket_number\",
    store_sales_store_store.\"S_MARKET_ID\" as \"store_sales_store_market\",
    store_sales_store_store.\"S_STATE\" as \"store_sales_store_state\",
    store_sales_store_store.\"S_STORE_NAME\" as \"store_sales_store_name\",
    store_sales_store_store.\"S_STORE_SK\" as \"store_sales_store_id\",
    store_sales_store_store.\"S_ZIP\" as \"store_sales_store_zip\"
FROM
    memory.store_sales as store_sales_store_sales
    INNER JOIN memory.item as store_sales_item_items on store_sales_store_sales.\"SS_ITEM_SK\" = store_sales_item_items.\"I_ITEM_SK\"
    LEFT OUTER JOIN memory.store_returns as store_sales_store_returns on store_sales_item_items.\"I_ITEM_SK\" = store_sales_store_returns.\"SR_ITEM_SK\" AND store_sales_store_sales.\"SS_ITEM_SK\" = store_sales_store_returns.\"SR_ITEM_SK\" AND store_sales_store_sales.\"SS_TICKET_NUMBER\" = store_sales_store_returns.\"SR_TICKET_NUMBER\"
    INNER JOIN memory.store as store_sales_store_store on store_sales_store_sales.\"SS_STORE_SK\" = store_sales_store_store.\"S_STORE_SK\"
    INNER JOIN memory.customer as store_sales_customer_customers on store_sales_store_sales.\"SS_CUSTOMER_SK\" = store_sales_customer_customers.\"C_CUSTOMER_SK\"
    INNER JOIN memory.customer_address as store_sales_customer_customer_address on store_sales_customer_customers.\"C_CURRENT_ADDR_SK\" = store_sales_customer_customer_address.\"CA_ADDRESS_SK\"
WHERE
    store_sales_store_store.\"S_MARKET_ID\" = 8 and store_sales_customer_customers.\"C_BIRTH_COUNTRY\" != UPPER(store_sales_customer_customer_address.\"CA_COUNTRY\")  and CASE WHEN store_sales_store_returns.\"SR_RETURN_TIME_SK\" THEN TRUE ELSE FALSE END is True and store_sales_store_store.\"S_ZIP\" = store_sales_customer_customer_address.\"CA_ZIP\"
),
abundant as (
-- Target: Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>. Group: True Source: SourceType.GROUP. References: questionable.
-- Source Map: {'store_sales.customer.address_id': ['questionable'], 'store_sales.customer.birth_country': ['questionable'], 'store_sales.customer.country': ['questionable'], 'store_sales.customer.first_name': ['questionable'], 'store_sales.customer.id': ['questionable'], 'store_sales.customer.last_name': ['questionable'], 'store_sales.customer.state': ['questionable'], 'store_sales.customer.zip': ['questionable'], 'store_sales.is_returned': ['questionable'], 'store_sales.item.color': ['questionable'], 'store_sales.item.current_price': ['questionable'], 'store_sales.item.id': ['questionable'], 'store_sales.item.manager_id': ['questionable'], 'store_sales.item.size': ['questionable'], 'store_sales.item.units': ['questionable'], 'store_sales.net_paid': ['questionable'], 'store_sales.store.id': ['questionable'], 'store_sales.store.market': ['questionable'], 'store_sales.store.name': ['questionable'], 'store_sales.store.state': ['questionable'], 'store_sales.store.zip': ['questionable'], 'store_sales.ticket_number': ['questionable'], 'local.net_paid': []}.
-- Output: local.net_paid@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.item.size@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.item.current_price@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.store.name@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.store.state@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.item.color@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.item.manager_id@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.customer.state@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.customer.first_name@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.item.units@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.customer.last_name@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>.
-- Inputs: store_sales.net_paid@Grain<store_sales.item.id,store_sales.ticket_number>, store_sales.item.size@Grain<store_sales.item.id>, store_sales.item.current_price@Grain<store_sales.item.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.store.state@Grain<store_sales.store.id>, store_sales.item.color@Grain<store_sales.item.id>, store_sales.item.manager_id@Grain<store_sales.item.id>, store_sales.customer.state@Grain<store_sales.customer.address_id>, store_sales.customer.first_name@Grain<store_sales.customer.id>, store_sales.item.units@Grain<store_sales.item.id>, store_sales.customer.last_name@Grain<store_sales.customer.id>, store_sales.ticket_number@Grain<store_sales.ticket_number>, store_sales.item.id@Grain<store_sales.item.id>.
-- Nullable: local.net_paid@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>.
SELECT
    questionable.\"store_sales_customer_first_name\" as \"store_sales_customer_first_name\",
    questionable.\"store_sales_customer_last_name\" as \"store_sales_customer_last_name\",
    questionable.\"store_sales_customer_state\" as \"store_sales_customer_state\",
    questionable.\"store_sales_item_color\" as \"store_sales_item_color\",
    questionable.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",
    questionable.\"store_sales_item_manager_id\" as \"store_sales_item_manager_id\",
    questionable.\"store_sales_item_size\" as \"store_sales_item_size\",
    questionable.\"store_sales_item_units\" as \"store_sales_item_units\",
    questionable.\"store_sales_store_name\" as \"store_sales_store_name\",
    questionable.\"store_sales_store_state\" as \"store_sales_store_state\",
    sum(questionable.\"store_sales_net_paid\") as \"net_paid\"
FROM
    questionable
GROUP BY 
    questionable.\"store_sales_customer_first_name\",
    questionable.\"store_sales_customer_last_name\",
    questionable.\"store_sales_customer_state\",
    questionable.\"store_sales_item_color\",
    questionable.\"store_sales_item_current_price\",
    questionable.\"store_sales_item_manager_id\",
    questionable.\"store_sales_item_size\",
    questionable.\"store_sales_item_units\",
    questionable.\"store_sales_store_name\",
    questionable.\"store_sales_store_state\"),
uneven as (
-- Target: Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>. Group: True Source: SourceType.GROUP. References: abundant.
-- Source Map: {'local.net_paid': ['abundant'], 'store_sales.item.size': ['abundant'], 'store_sales.item.current_price': ['abundant'], 'store_sales.store.name': ['abundant'], 'store_sales.store.state': ['abundant'], 'store_sales.item.color': ['abundant'], 'store_sales.item.manager_id': ['abundant'], 'store_sales.customer.state': ['abundant'], 'store_sales.customer.first_name': ['abundant'], 'store_sales.item.units': ['abundant'], 'store_sales.customer.last_name': ['abundant'], 'su.store_sales.customer.first_name': [], 'su.store_sales.customer.last_name': [], 'su.store_sales.customer.state': [], 'su.store_sales.store.state': [], 'su.store_sales.store.name': [], 'su.store_sales.item.color': [], 'su.store_sales.item.current_price': [], 'su.store_sales.item.manager_id': [], 'su.store_sales.item.units': [], 'su.store_sales.item.size': [], 'su.net_paid': []}.
-- Output: local.net_paid@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.item.size@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, store_sales.item.current_price@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, store_sales.store.name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, store_sales.store.state@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, store_sales.item.color@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, store_sales.item.manager_id@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, store_sales.customer.state@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, store_sales.customer.first_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, store_sales.item.units@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, store_sales.customer.last_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.first_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.last_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.state@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.store.state@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.store.name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.color@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.current_price@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.manager_id@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.units@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.size@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.net_paid@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>.
-- Inputs: local.net_paid@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.item.size@Grain<store_sales.item.id>, store_sales.item.current_price@Grain<store_sales.item.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.store.state@Grain<store_sales.store.id>, store_sales.item.color@Grain<store_sales.item.id>, store_sales.item.manager_id@Grain<store_sales.item.id>, store_sales.customer.state@Grain<store_sales.customer.address_id>, store_sales.customer.first_name@Grain<store_sales.customer.id>, store_sales.item.units@Grain<store_sales.item.id>, store_sales.customer.last_name@Grain<store_sales.customer.id>.
-- Hidden: local.net_paid@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, store_sales.item.size@Grain<store_sales.item.id>, store_sales.item.current_price@Grain<store_sales.item.id>, store_sales.store.name@Grain<store_sales.store.id>, store_sales.store.state@Grain<store_sales.store.id>, store_sales.item.color@Grain<store_sales.item.id>, store_sales.item.manager_id@Grain<store_sales.item.id>, store_sales.customer.state@Grain<store_sales.customer.address_id>, store_sales.customer.first_name@Grain<store_sales.customer.id>, store_sales.item.units@Grain<store_sales.item.id>, store_sales.customer.last_name@Grain<store_sales.customer.id>.
-- Nullable: local.net_paid@Grain<store_sales.customer.first_name,store_sales.customer.last_name,store_sales.customer.state,store_sales.item.color,store_sales.item.current_price,store_sales.item.manager_id,store_sales.item.size,store_sales.item.units,store_sales.store.name,store_sales.store.state>, su.store_sales.customer.first_name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.last_name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.state@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.store.state@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.store.name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.color@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.current_price@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.manager_id@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.units@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.size@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.net_paid@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>.
SELECT
    abundant.\"net_paid\" as \"su_net_paid\",
    abundant.\"store_sales_customer_first_name\" as \"su_store_sales_customer_first_name\",
    abundant.\"store_sales_customer_last_name\" as \"su_store_sales_customer_last_name\",
    abundant.\"store_sales_customer_state\" as \"su_store_sales_customer_state\",
    abundant.\"store_sales_item_color\" as \"su_store_sales_item_color\",
    abundant.\"store_sales_item_current_price\" as \"su_store_sales_item_current_price\",
    abundant.\"store_sales_item_manager_id\" as \"su_store_sales_item_manager_id\",
    abundant.\"store_sales_item_size\" as \"su_store_sales_item_size\",
    abundant.\"store_sales_item_units\" as \"su_store_sales_item_units\",
    abundant.\"store_sales_store_name\" as \"su_store_sales_store_name\",
    abundant.\"store_sales_store_state\" as \"su_store_sales_store_state\"
FROM
    abundant
GROUP BY 
    abundant.\"net_paid\",
    abundant.\"store_sales_customer_first_name\",
    abundant.\"store_sales_customer_last_name\",
    abundant.\"store_sales_customer_state\",
    abundant.\"store_sales_item_color\",
    abundant.\"store_sales_item_current_price\",
    abundant.\"store_sales_item_manager_id\",
    abundant.\"store_sales_item_size\",
    abundant.\"store_sales_item_units\",
    abundant.\"store_sales_store_name\",
    abundant.\"store_sales_store_state\"),
vacuous as (
-- Target: Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>. Group: False Source: SourceType.FILTER. References: uneven.
-- Source Map: {'su.store_sales.customer.first_name': ['uneven'], 'su.store_sales.customer.last_name': ['uneven'], 'su.store_sales.customer.state': ['uneven'], 'su.store_sales.store.state': ['uneven'], 'su.store_sales.store.name': ['uneven'], 'su.store_sales.item.color': ['uneven'], 'su.store_sales.item.current_price': ['uneven'], 'su.store_sales.item.manager_id': ['uneven'], 'su.store_sales.item.units': ['uneven'], 'su.store_sales.item.size': ['uneven'], 'su.net_paid': ['uneven'], 'local._virt_9720171099955064': []}.
-- Output: local._virt_9720171099955064@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.net_paid@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.store.name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.first_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.last_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>.
-- Inputs: su.net_paid@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.color@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.units@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.size@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.store.name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.store.state@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.first_name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.manager_id@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.item.current_price@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.last_name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.state@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>.
SELECT
    CASE WHEN uneven.\"su_store_sales_item_color\" = 'peach' THEN uneven.\"su_net_paid\" ELSE NULL END as \"_virt_9720171099955064\",
    uneven.\"su_net_paid\" as \"su_net_paid\",
    uneven.\"su_store_sales_customer_first_name\" as \"su_store_sales_customer_first_name\",
    uneven.\"su_store_sales_customer_last_name\" as \"su_store_sales_customer_last_name\",
    uneven.\"su_store_sales_store_name\" as \"su_store_sales_store_name\"
FROM
    uneven),
yummy as (
-- Target: Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>. Group: False Source: SourceType.MERGE. References: uneven.
-- Source Map: {'su.store_sales.customer.first_name': ['uneven'], 'su.store_sales.customer.last_name': ['uneven'], 'su.store_sales.customer.state': ['uneven'], 'su.store_sales.store.state': ['uneven'], 'su.store_sales.store.name': ['uneven'], 'su.store_sales.item.color': ['uneven'], 'su.store_sales.item.current_price': ['uneven'], 'su.store_sales.item.manager_id': ['uneven'], 'su.store_sales.item.units': ['uneven'], 'su.store_sales.item.size': ['uneven'], 'su.net_paid': ['uneven']}.
-- Output: su.net_paid@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, __preql_internal.all_rows@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>.
-- Inputs: su.net_paid@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, __preql_internal.all_rows@Grain<Abstract>.
-- Nullable: su.net_paid@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>.
SELECT
    :__preql_internal_all_rows as \"__preql_internal_all_rows\",
    uneven.\"su_net_paid\" as \"su_net_paid\"
FROM
    uneven),
concerned as (
-- Target: Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>. Group: True Source: SourceType.GROUP. References: vacuous.
-- Source Map: {'local._virt_9720171099955064': ['vacuous'], 'su.net_paid': ['vacuous'], 'su.store_sales.store.name': ['vacuous'], 'su.store_sales.customer.first_name': ['vacuous'], 'su.store_sales.customer.last_name': ['vacuous'], 'local.peach_sales': []}.
-- Output: local.peach_sales@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>, su.store_sales.customer.last_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>, su.store_sales.customer.first_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>, su.store_sales.store.name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>.
-- Inputs: local._virt_9720171099955064@Grain<Abstract>, su.store_sales.customer.last_name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.first_name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.store.name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.net_paid@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>.
-- Nullable: local.peach_sales@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>.
SELECT
    sum(vacuous.\"_virt_9720171099955064\") as \"peach_sales\",
    vacuous.\"su_store_sales_customer_first_name\" as \"su_store_sales_customer_first_name\",
    vacuous.\"su_store_sales_customer_last_name\" as \"su_store_sales_customer_last_name\",
    vacuous.\"su_store_sales_store_name\" as \"su_store_sales_store_name\"
FROM
    vacuous
GROUP BY 
    vacuous.\"su_store_sales_customer_first_name\",
    vacuous.\"su_store_sales_customer_last_name\",
    vacuous.\"su_store_sales_store_name\"),
juicy as (
-- Target: Grain<Abstract>. Group: True Source: SourceType.GROUP. References: yummy.
-- Source Map: {'su.net_paid': ['yummy'], 'local.avg_store_customer_sales': []}.
-- Output: local.avg_store_customer_sales@Grain<Abstract>.
-- Inputs: su.net_paid@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, __preql_internal.all_rows@Grain<Abstract>.
-- Nullable: local.avg_store_customer_sales@Grain<Abstract>.
SELECT
    avg(yummy.\"su_net_paid\") as \"avg_store_customer_sales\"
FROM
    yummy)
-- Target: Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>. Group: False Source: SourceType.MERGE. References: juicy, concerned.
-- Joins: full JOIN concerned and juicy on .
-- Source Map: {'local.avg_store_customer_sales': ['juicy'], 'local.peach_sales': ['concerned'], 'su.store_sales.customer.last_name': ['concerned'], 'su.store_sales.customer.first_name': ['concerned'], 'su.store_sales.store.name': ['concerned']}.
-- Output: su.store_sales.customer.last_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>, su.store_sales.customer.first_name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>, su.store_sales.store.name@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>, local.peach_sales@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>.
-- Inputs: su.store_sales.customer.last_name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.customer.first_name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, su.store_sales.store.name@Grain<su.net_paid,su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.customer.state,su.store_sales.item.color,su.store_sales.item.current_price,su.store_sales.item.manager_id,su.store_sales.item.size,su.store_sales.item.units,su.store_sales.store.name,su.store_sales.store.state>, local.avg_store_customer_sales@Grain<Abstract>, local.peach_sales@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>.
-- Hidden: local.avg_store_customer_sales@Grain<Abstract>.
-- Nullable: local.avg_store_customer_sales@Grain<Abstract>, local.peach_sales@Grain<su.store_sales.customer.first_name,su.store_sales.customer.last_name,su.store_sales.store.name>.
SELECT
    concerned.\"su_store_sales_customer_last_name\" as \"su_store_sales_customer_last_name\",
    concerned.\"su_store_sales_customer_first_name\" as \"su_store_sales_customer_first_name\",
    concerned.\"su_store_sales_store_name\" as \"su_store_sales_store_name\",
    concerned.\"peach_sales\" as \"peach_sales\"
FROM
    concerned
    FULL JOIN juicy on 1=1
WHERE
    concerned.\"peach_sales\" > 0.05 * juicy.\"avg_store_customer_sales\"
"""
