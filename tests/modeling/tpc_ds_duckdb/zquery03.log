query_id = 3
parse_time = 22.191138
exec_time = 0.212095
comp_time = 0.101546
gen_length = 1359
generated_sql = """

WITH 
vacuous as (
SELECT
    store_sales.\"SS_EXT_SALES_PRICE\" as \"store_sales_ext_sales_price\",
    date.\"D_MOY\" as \"store_sales_date_month_of_year\",
    items.\"I_MANUFACT_ID\" as \"store_sales_item_manufacturer_id\",
    items.\"I_BRAND_ID\" as \"store_sales_item_brand_id\",
    items.\"I_BRAND\" as \"store_sales_item_brand_name\",
    cast(\"D_YEAR\" as int) as \"store_sales_date_year\",
    store_sales.\"SS_TICKET_NUMBER\" as \"store_sales_ticket_number\",
    items.\"I_ITEM_SK\" as \"store_sales_item_id\"
FROM
    memory.item as items
    INNER JOIN memory.store_sales as store_sales on items.\"I_ITEM_SK\" = store_sales.\"SS_ITEM_SK\"
    INNER JOIN memory.date_dim as date on store_sales.\"SS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"
WHERE
    date.\"D_MOY\" = 11 and items.\"I_MANUFACT_ID\" = 128
)
SELECT
    vacuous.\"store_sales_date_year\" as \"store_sales_date_year\",
    vacuous.\"store_sales_item_brand_id\" as \"store_sales_item_brand_id\",
    vacuous.\"store_sales_item_brand_name\" as \"store_sales_item_brand_name\",
    sum(vacuous.\"store_sales_ext_sales_price\") as \"sum_agg\"
FROM
    vacuous
GROUP BY 
    vacuous.\"store_sales_item_brand_name\",
    vacuous.\"store_sales_date_year\",
    vacuous.\"store_sales_item_brand_id\"
ORDER BY 
    vacuous.\"store_sales_date_year\" asc,
    sum(vacuous.\"store_sales_ext_sales_price\") desc,
    vacuous.\"store_sales_item_brand_id\" asc
LIMIT (100)"""
