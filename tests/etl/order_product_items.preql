import raw.order_items as order_item;


datasource order_product_items (
    order_id:order_item.order.id,
    # order_item_id: order_item.id,
    order_creation_date:order_item.created_at.date,
    user_id:order_item.user.id,
    product_id:order_item.inventory_item.product.id,
    inventory_item_id:order_item.inventory_item.id,
    product_distribution_name:order_item.inventory_item.product.distribution_center.id,
    status:order_item.status,
    #sale_price:order_item.sale_price,
    total_revenue:order_item.total_revenue,
    total_quantity:order_item.total_quantity,
    ) 
grain (order_item.order.id, order_item.product.id, order_item.user.id, order_item.created_at.date)
address `preqldata.look_etl.order_product_items`
incremental by order_item.created_at.date
partition by order_item.created_at.date
;

